Using device: cuda
GPU: NVIDIA L4

============================================================
Loading datasets...
============================================================
Loaded 7424 samples from data/geolife/geolife_transformer_7_train.pk
Vocabulary size: 1187 (unique locations: 1156)
Loaded 3334 samples from data/geolife/geolife_transformer_7_validation.pk
Vocabulary size: 1176 (unique locations: 382)
Loaded 3502 samples from data/geolife/geolife_transformer_7_test.pk
Vocabulary size: 1177 (unique locations: 355)
Train samples: 7424
Val samples: 3334
Test samples: 3502

============================================================
Initializing model...
============================================================
Total parameters: 7,532,896
Trainable parameters: 7,532,384

============================================================
Starting training...
============================================================


============================================================
Epoch 1/100
============================================================
Epoch 1 | Batch 10/58 | Loss: 5.8546 | Acc@1: 0.1094 | Acc@5: 0.2500 | Acc@10: 0.3359
Epoch 1 | Batch 20/58 | Loss: 5.4734 | Acc@1: 0.1719 | Acc@5: 0.3516 | Acc@10: 0.4141
Epoch 1 | Batch 30/58 | Loss: 4.6023 | Acc@1: 0.2969 | Acc@5: 0.5078 | Acc@10: 0.5703
Epoch 1 | Batch 40/58 | Loss: 4.6636 | Acc@1: 0.3125 | Acc@5: 0.5000 | Acc@10: 0.5547
Epoch 1 | Batch 50/58 | Loss: 4.0393 | Acc@1: 0.2812 | Acc@5: 0.6406 | Acc@10: 0.6719

Validation Results:
  Loss: 4.5943
  Acc@1: 0.2581 (25.81%)
  Acc@5: 0.4807 (48.07%)
  Acc@10: 0.5720 (57.20%)


Test Results:
  Loss: 4.9569
  Acc@1: 0.2425 (24.25%)
  Acc@5: 0.4242 (42.42%)
  Acc@10: 0.4895 (48.95%)

Epoch 1 Summary:
  Train - Loss: 5.1178 | Acc@1: 0.2221
  Val   - Loss: 4.5943 | Acc@1: 0.2581
  Test  - Loss: 4.9569 | Acc@1: 0.2425
  Time: 28.95s | LR: 0.000100
  Saved checkpoint: checkpoints/location_hrm_epoch1.pt
  New best validation accuracy! Saved to checkpoints/location_hrm_best_val.pt
  New best test accuracy! Saved to checkpoints/location_hrm_best_test.pt

============================================================
Epoch 2/100
============================================================
Epoch 2 | Batch 10/58 | Loss: 3.9758 | Acc@1: 0.3203 | Acc@5: 0.6406 | Acc@10: 0.6641
Epoch 2 | Batch 20/58 | Loss: 3.6040 | Acc@1: 0.3047 | Acc@5: 0.6797 | Acc@10: 0.7422
Epoch 2 | Batch 30/58 | Loss: 4.1735 | Acc@1: 0.2812 | Acc@5: 0.5781 | Acc@10: 0.6016
Epoch 2 | Batch 40/58 | Loss: 4.3582 | Acc@1: 0.3125 | Acc@5: 0.5234 | Acc@10: 0.5781
Epoch 2 | Batch 50/58 | Loss: 3.7133 | Acc@1: 0.3359 | Acc@5: 0.6406 | Acc@10: 0.6953

Validation Results:
  Loss: 4.3031
  Acc@1: 0.3279 (32.79%)
  Acc@5: 0.5688 (56.88%)
  Acc@10: 0.6162 (61.62%)


Test Results:
  Loss: 4.6597
  Acc@1: 0.2597 (25.97%)
  Acc@5: 0.5047 (50.47%)
  Acc@10: 0.5613 (56.13%)

Epoch 2 Summary:
  Train - Loss: 3.9125 | Acc@1: 0.3237
  Val   - Loss: 4.3031 | Acc@1: 0.3279
  Test  - Loss: 4.6597 | Acc@1: 0.2597
  Time: 28.23s | LR: 0.000100
  Saved checkpoint: checkpoints/location_hrm_epoch2.pt
  New best validation accuracy! Saved to checkpoints/location_hrm_best_val.pt
  New best test accuracy! Saved to checkpoints/location_hrm_best_test.pt

============================================================
Epoch 3/100
============================================================
Epoch 3 | Batch 10/58 | Loss: 4.1694 | Acc@1: 0.2422 | Acc@5: 0.6094 | Acc@10: 0.6406
Epoch 3 | Batch 20/58 | Loss: 3.5409 | Acc@1: 0.3125 | Acc@5: 0.6797 | Acc@10: 0.7266
Epoch 3 | Batch 30/58 | Loss: 3.3493 | Acc@1: 0.3125 | Acc@5: 0.7109 | Acc@10: 0.7734
Epoch 3 | Batch 40/58 | Loss: 3.3695 | Acc@1: 0.3438 | Acc@5: 0.7344 | Acc@10: 0.7734
Epoch 3 | Batch 50/58 | Loss: 3.4870 | Acc@1: 0.3438 | Acc@5: 0.6719 | Acc@10: 0.7109

Validation Results:
  Loss: 4.3550
  Acc@1: 0.3021 (30.21%)
  Acc@5: 0.5754 (57.54%)
  Acc@10: 0.6249 (62.49%)


Test Results:
  Loss: 4.7995
  Acc@1: 0.2511 (25.11%)
  Acc@5: 0.5005 (50.05%)
  Acc@10: 0.5651 (56.51%)

Epoch 3 Summary:
  Train - Loss: 3.5578 | Acc@1: 0.3415
  Val   - Loss: 4.3550 | Acc@1: 0.3021
  Test  - Loss: 4.7995 | Acc@1: 0.2511
  Time: 28.50s | LR: 0.000100

============================================================
Epoch 4/100
============================================================
Epoch 4 | Batch 10/58 | Loss: 3.5503 | Acc@1: 0.3750 | Acc@5: 0.6562 | Acc@10: 0.6641
Epoch 4 | Batch 20/58 | Loss: 3.2024 | Acc@1: 0.3594 | Acc@5: 0.6875 | Acc@10: 0.7188
Epoch 4 | Batch 30/58 | Loss: 3.6592 | Acc@1: 0.3438 | Acc@5: 0.6250 | Acc@10: 0.6797
Epoch 4 | Batch 40/58 | Loss: 3.4555 | Acc@1: 0.3359 | Acc@5: 0.6719 | Acc@10: 0.7344
Epoch 4 | Batch 50/58 | Loss: 3.5045 | Acc@1: 0.3125 | Acc@5: 0.6562 | Acc@10: 0.6953

Validation Results:
  Loss: 4.2018
  Acc@1: 0.3220 (32.20%)
  Acc@5: 0.5925 (59.25%)
  Acc@10: 0.6382 (63.82%)


Test Results:
  Loss: 4.6575
  Acc@1: 0.2719 (27.19%)
  Acc@5: 0.5219 (52.19%)
  Acc@10: 0.5637 (56.37%)

Epoch 4 Summary:
  Train - Loss: 3.3636 | Acc@1: 0.3481
  Val   - Loss: 4.2018 | Acc@1: 0.3220
  Test  - Loss: 4.6575 | Acc@1: 0.2719
  Time: 28.34s | LR: 0.000100
  New best test accuracy! Saved to checkpoints/location_hrm_best_test.pt

============================================================
Epoch 5/100
============================================================
Epoch 5 | Batch 10/58 | Loss: 3.4679 | Acc@1: 0.3203 | Acc@5: 0.6328 | Acc@10: 0.6875
Epoch 5 | Batch 20/58 | Loss: 3.6176 | Acc@1: 0.3047 | Acc@5: 0.6406 | Acc@10: 0.6875
Epoch 5 | Batch 30/58 | Loss: 2.9672 | Acc@1: 0.3828 | Acc@5: 0.7266 | Acc@10: 0.7656
Epoch 5 | Batch 40/58 | Loss: 3.0136 | Acc@1: 0.3594 | Acc@5: 0.7188 | Acc@10: 0.7969
Epoch 5 | Batch 50/58 | Loss: 2.8276 | Acc@1: 0.3516 | Acc@5: 0.7500 | Acc@10: 0.7891

Validation Results:
  Loss: 4.2474
  Acc@1: 0.3137 (31.37%)
  Acc@5: 0.6016 (60.16%)
  Acc@10: 0.6383 (63.83%)


Test Results:
  Loss: 4.7127
  Acc@1: 0.2707 (27.07%)
  Acc@5: 0.5404 (54.04%)
  Acc@10: 0.5789 (57.89%)

Epoch 5 Summary:
  Train - Loss: 3.2213 | Acc@1: 0.3570
  Val   - Loss: 4.2474 | Acc@1: 0.3137
  Test  - Loss: 4.7127 | Acc@1: 0.2707
  Time: 28.24s | LR: 0.000099
  Saved checkpoint: checkpoints/location_hrm_epoch5.pt

============================================================
Epoch 6/100
============================================================
Epoch 6 | Batch 10/58 | Loss: 3.6191 | Acc@1: 0.3125 | Acc@5: 0.6250 | Acc@10: 0.6641
Epoch 6 | Batch 20/58 | Loss: 3.0157 | Acc@1: 0.3359 | Acc@5: 0.7188 | Acc@10: 0.7734
Epoch 6 | Batch 30/58 | Loss: 3.3197 | Acc@1: 0.3203 | Acc@5: 0.6719 | Acc@10: 0.7578
Epoch 6 | Batch 40/58 | Loss: 2.8517 | Acc@1: 0.4062 | Acc@5: 0.7344 | Acc@10: 0.7969
Epoch 6 | Batch 50/58 | Loss: 3.3259 | Acc@1: 0.3203 | Acc@5: 0.6328 | Acc@10: 0.7266

Validation Results:
  Loss: 4.3265
  Acc@1: 0.3253 (32.53%)
  Acc@5: 0.5983 (59.83%)
  Acc@10: 0.6330 (63.30%)


Test Results:
  Loss: 4.9332
  Acc@1: 0.2581 (25.81%)
  Acc@5: 0.5024 (50.24%)
  Acc@10: 0.5393 (53.93%)

Epoch 6 Summary:
  Train - Loss: 3.0947 | Acc@1: 0.3664
  Val   - Loss: 4.3265 | Acc@1: 0.3253
  Test  - Loss: 4.9332 | Acc@1: 0.2581
  Time: 28.23s | LR: 0.000099

============================================================
Epoch 7/100
============================================================
Epoch 7 | Batch 10/58 | Loss: 2.5852 | Acc@1: 0.4219 | Acc@5: 0.7656 | Acc@10: 0.8438
Epoch 7 | Batch 20/58 | Loss: 2.7573 | Acc@1: 0.4375 | Acc@5: 0.7422 | Acc@10: 0.7891
Epoch 7 | Batch 30/58 | Loss: 3.3812 | Acc@1: 0.3203 | Acc@5: 0.6172 | Acc@10: 0.7188
Epoch 7 | Batch 40/58 | Loss: 2.8183 | Acc@1: 0.3984 | Acc@5: 0.7578 | Acc@10: 0.7969
Epoch 7 | Batch 50/58 | Loss: 3.1135 | Acc@1: 0.2734 | Acc@5: 0.7031 | Acc@10: 0.7578

Validation Results:
  Loss: 4.3297
  Acc@1: 0.3223 (32.23%)
  Acc@5: 0.5944 (59.44%)
  Acc@10: 0.6502 (65.02%)


Test Results:
  Loss: 4.8151
  Acc@1: 0.2876 (28.76%)
  Acc@5: 0.5262 (52.62%)
  Acc@10: 0.5680 (56.80%)

Epoch 7 Summary:
  Train - Loss: 2.9991 | Acc@1: 0.3707
  Val   - Loss: 4.3297 | Acc@1: 0.3223
  Test  - Loss: 4.8151 | Acc@1: 0.2876
  Time: 28.27s | LR: 0.000099
  New best test accuracy! Saved to checkpoints/location_hrm_best_test.pt
