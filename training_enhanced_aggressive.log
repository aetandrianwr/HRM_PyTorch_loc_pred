/content/HRM_PyTorch_loc_pred/src/hrm/modeling/hrm_enhanced.py:425: UserWarning: __floordiv__ is deprecated, and its behavior will change in a future version of pytorch. It currently rounds toward 0 (like the 'trunc' function NOT 'floor'). This results in incorrect rounding for negative values. To keep the current behavior, use torch.div(a, b, rounding_mode='trunc'), or for actual floor division, use torch.div(a, b, rounding_mode='floor').
  hour = (start_min // 60) % 24
No module named 'torch_sparse'
`torch-sparse` is not installed, which is ok, as long as no sparse modules are used.
Using device: cuda
GPU: NVIDIA L4

============================================================
Loading datasets...
============================================================
Loaded 7424 samples from data/geolife/geolife_transformer_7_train.pk
Vocabulary size: 1187 (unique locations: 1156)
Loaded 3334 samples from data/geolife/geolife_transformer_7_validation.pk
Vocabulary size: 1176 (unique locations: 382)
Loaded 3502 samples from data/geolife/geolife_transformer_7_test.pk
Vocabulary size: 1177 (unique locations: 355)
Train samples: 7424
Val samples: 3334
Test samples: 3502

============================================================
Initializing Enhanced HRM...
============================================================
Total parameters: 440,669
Trainable parameters: 440,669
Target: <500K parameters
✓ Within budget!
EMA decay: 0.999
Temporal jittering: enabled
Adaptive gradient accumulation: enabled
Loss: Adaptive TopKCrossEntropyLoss

============================================================
Starting training with advanced techniques...
============================================================


============================================================
Epoch 1/600
============================================================
Epoch 1 | Batch 10/78 | Loss: 3.3802 (TopK: 3.3765, CE: 7.0820) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0000 | AccumSteps: 1
Epoch 1 | Batch 20/78 | Loss: 3.3710 (TopK: 3.3673, CE: 7.0818) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0000 | AccumSteps: 1
Epoch 1 | Batch 30/78 | Loss: 3.3584 (TopK: 3.3546, CE: 7.0775) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0104 | AccumSteps: 1
Epoch 1 | Batch 40/78 | Loss: 3.3523 (TopK: 3.3486, CE: 7.0752) | Acc@1: 0.1146 | Acc@5: 0.1979 | Acc@10: 0.2292 | AccumSteps: 1
Epoch 1 | Batch 50/78 | Loss: 3.3525 (TopK: 3.3487, CE: 7.0762) | Acc@1: 0.0625 | Acc@5: 0.1250 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 1 | Batch 60/78 | Loss: 3.3512 (TopK: 3.3475, CE: 7.0752) | Acc@1: 0.0417 | Acc@5: 0.1458 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 1 | Batch 70/78 | Loss: 3.3503 (TopK: 3.3466, CE: 7.0743) | Acc@1: 0.1042 | Acc@5: 0.1875 | Acc@10: 0.2083 | AccumSteps: 1

Validation Results:
  Loss: 7.0847
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0003 (0.03%)
  Acc@10: 0.0006 (0.06%)


Test Results:
  Loss: 7.0831
  Acc@1: 0.0003 (0.03%)
  Acc@5: 0.0003 (0.03%)
  Acc@10: 0.0011 (0.11%)

Epoch 1 Summary:
  Train - Loss: 3.3603 (TopK: 3.3566[1.00], CE: 7.0775) | Acc@1: 0.0467
  Val   - Loss: 7.0847 | Acc@1: 0.0000
  Test  - Loss: 7.0831 | Acc@1: 0.0003
  Time: 13.93s | LR: 0.000133
  Params: 440,669
  ✅ New best test accuracy! (0.03%)

============================================================
Epoch 2/600
============================================================
Epoch 2 | Batch 10/78 | Loss: 3.3526 (TopK: 3.3451, CE: 7.0731) | Acc@1: 0.0833 | Acc@5: 0.2188 | Acc@10: 0.2604 | AccumSteps: 1
Epoch 2 | Batch 20/78 | Loss: 3.3504 (TopK: 3.3429, CE: 7.0703) | Acc@1: 0.0938 | Acc@5: 0.2812 | Acc@10: 0.3854 | AccumSteps: 1
Epoch 2 | Batch 30/78 | Loss: 3.3490 (TopK: 3.3415, CE: 7.0672) | Acc@1: 0.1562 | Acc@5: 0.2812 | Acc@10: 0.3229 | AccumSteps: 1
Epoch 2 | Batch 40/78 | Loss: 3.3440 (TopK: 3.3365, CE: 7.0543) | Acc@1: 0.1667 | Acc@5: 0.3021 | Acc@10: 0.3438 | AccumSteps: 1
Epoch 2 | Batch 50/78 | Loss: 3.3074 (TopK: 3.3000, CE: 7.0005) | Acc@1: 0.2500 | Acc@5: 0.4167 | Acc@10: 0.4479 | AccumSteps: 1
Epoch 2 | Batch 60/78 | Loss: 3.2027 (TopK: 3.1954, CE: 6.8407) | Acc@1: 0.2083 | Acc@5: 0.3438 | Acc@10: 0.3646 | AccumSteps: 1
Epoch 2 | Batch 70/78 | Loss: 2.9672 (TopK: 2.9601, CE: 6.5202) | Acc@1: 0.2396 | Acc@5: 0.4271 | Acc@10: 0.5000 | AccumSteps: 1

Validation Results:
  Loss: 7.0826
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0003 (0.03%)
  Acc@10: 0.0009 (0.09%)


Test Results:
  Loss: 7.0815
  Acc@1: 0.0003 (0.03%)
  Acc@5: 0.0006 (0.06%)
  Acc@10: 0.0011 (0.11%)

Epoch 2 Summary:
  Train - Loss: 3.2786 (TopK: 3.2712[1.00], CE: 6.9451) | Acc@1: 0.1595
  Val   - Loss: 7.0826 | Acc@1: 0.0000
  Test  - Loss: 7.0815 | Acc@1: 0.0003
  Time: 12.90s | LR: 0.000267
  Params: 440,669

============================================================
Epoch 3/600
============================================================
Epoch 3 | Batch 10/78 | Loss: 2.9978 (TopK: 2.9877, CE: 6.3437) | Acc@1: 0.1979 | Acc@5: 0.3333 | Acc@10: 0.4583 | AccumSteps: 1
Epoch 3 | Batch 20/78 | Loss: 2.9934 (TopK: 2.9832, CE: 6.3820) | Acc@1: 0.1667 | Acc@5: 0.4896 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 3 | Batch 30/78 | Loss: 2.9179 (TopK: 2.9079, CE: 6.2288) | Acc@1: 0.1875 | Acc@5: 0.5000 | Acc@10: 0.5312 | AccumSteps: 1
Epoch 3 | Batch 40/78 | Loss: 2.9047 (TopK: 2.8949, CE: 6.1737) | Acc@1: 0.1875 | Acc@5: 0.5000 | Acc@10: 0.5312 | AccumSteps: 1
Epoch 3 | Batch 50/78 | Loss: 2.7368 (TopK: 2.7275, CE: 5.8532) | Acc@1: 0.2396 | Acc@5: 0.4375 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 3 | Batch 60/78 | Loss: 2.8526 (TopK: 2.8434, CE: 5.9372) | Acc@1: 0.1875 | Acc@5: 0.4375 | Acc@10: 0.4792 | AccumSteps: 1
Epoch 3 | Batch 70/78 | Loss: 2.6869 (TopK: 2.6779, CE: 5.6897) | Acc@1: 0.2083 | Acc@5: 0.4688 | Acc@10: 0.5000 | AccumSteps: 1

Validation Results:
  Loss: 7.0763
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0003 (0.03%)
  Acc@10: 0.0009 (0.09%)


Test Results:
  Loss: 7.0763
  Acc@1: 0.0003 (0.03%)
  Acc@5: 0.0006 (0.06%)
  Acc@10: 0.0014 (0.14%)

Epoch 3 Summary:
  Train - Loss: 2.8672 (TopK: 2.8575[1.00], CE: 6.0994) | Acc@1: 0.2006
  Val   - Loss: 7.0763 | Acc@1: 0.0000
  Test  - Loss: 7.0763 | Acc@1: 0.0003
  Time: 12.96s | LR: 0.000400
  Params: 440,669

============================================================
Epoch 4/600
============================================================
Epoch 4 | Batch 10/78 | Loss: 2.2267 (TopK: 2.2155, CE: 5.0233) | Acc@1: 0.3125 | Acc@5: 0.5729 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 4 | Batch 20/78 | Loss: 2.3267 (TopK: 2.3148, CE: 5.2819) | Acc@1: 0.3125 | Acc@5: 0.5938 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 4 | Batch 30/78 | Loss: 2.5600 (TopK: 2.5478, CE: 5.6091) | Acc@1: 0.2188 | Acc@5: 0.4896 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 4 | Batch 40/78 | Loss: 2.8642 (TopK: 2.8509, CE: 6.1939) | Acc@1: 0.1979 | Acc@5: 0.3750 | Acc@10: 0.3958 | AccumSteps: 1
Epoch 4 | Batch 50/78 | Loss: 2.4276 (TopK: 2.4151, CE: 5.5260) | Acc@1: 0.3021 | Acc@5: 0.5208 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 4 | Batch 60/78 | Loss: 2.3555 (TopK: 2.3436, CE: 5.3209) | Acc@1: 0.2188 | Acc@5: 0.5729 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 4 | Batch 70/78 | Loss: 2.3934 (TopK: 2.3809, CE: 5.4875) | Acc@1: 0.2604 | Acc@5: 0.5104 | Acc@10: 0.6146 | AccumSteps: 1

Validation Results:
  Loss: 7.0659
  Acc@1: 0.1312 (13.12%)
  Acc@5: 0.2018 (20.18%)
  Acc@10: 0.2232 (22.32%)


Test Results:
  Loss: 7.0674
  Acc@1: 0.1297 (12.97%)
  Acc@5: 0.1802 (18.02%)
  Acc@10: 0.1918 (19.18%)

Epoch 4 Summary:
  Train - Loss: 2.4784 (TopK: 2.4661[1.00], CE: 5.5381) | Acc@1: 0.2413
  Val   - Loss: 7.0659 | Acc@1: 0.1312
  Test  - Loss: 7.0674 | Acc@1: 0.1297
  Time: 12.88s | LR: 0.000533
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch4.pt
  ✅ New best validation accuracy! (13.12%)
  ✅ New best test accuracy! (12.97%)

============================================================
Epoch 5/600
============================================================
Epoch 5 | Batch 10/78 | Loss: 2.5737 (TopK: 2.5572, CE: 5.8684) | Acc@1: 0.2083 | Acc@5: 0.4896 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 5 | Batch 20/78 | Loss: 2.5466 (TopK: 2.5307, CE: 5.7136) | Acc@1: 0.2292 | Acc@5: 0.4479 | Acc@10: 0.5312 | AccumSteps: 1
Epoch 5 | Batch 30/78 | Loss: 2.2545 (TopK: 2.2394, CE: 5.2487) | Acc@1: 0.2396 | Acc@5: 0.5729 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 5 | Batch 40/78 | Loss: 2.2153 (TopK: 2.2017, CE: 4.9067) | Acc@1: 0.2500 | Acc@5: 0.5417 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 5 | Batch 50/78 | Loss: 2.1914 (TopK: 2.1772, CE: 5.0031) | Acc@1: 0.2083 | Acc@5: 0.5729 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 5 | Batch 60/78 | Loss: 2.3005 (TopK: 2.2853, CE: 5.3192) | Acc@1: 0.2604 | Acc@5: 0.5208 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 5 | Batch 70/78 | Loss: 2.2825 (TopK: 2.2675, CE: 5.2710) | Acc@1: 0.3438 | Acc@5: 0.5000 | Acc@10: 0.5729 | AccumSteps: 1

Validation Results:
  Loss: 7.0534
  Acc@1: 0.1046 (10.46%)
  Acc@5: 0.2024 (20.24%)
  Acc@10: 0.2268 (22.68%)


Test Results:
  Loss: 7.0558
  Acc@1: 0.0966 (9.66%)
  Acc@5: 0.1802 (18.02%)
  Acc@10: 0.1921 (19.21%)

Epoch 5 Summary:
  Train - Loss: 2.3325 (TopK: 2.3175[0.99], CE: 5.3128) | Acc@1: 0.2512
  Val   - Loss: 7.0534 | Acc@1: 0.1046
  Test  - Loss: 7.0558 | Acc@1: 0.0966
  Time: 12.87s | LR: 0.000667
  Params: 440,669

============================================================
Epoch 6/600
============================================================
Epoch 6 | Batch 10/78 | Loss: 2.0882 (TopK: 2.0721, CE: 4.7415) | Acc@1: 0.3229 | Acc@5: 0.6354 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 6 | Batch 20/78 | Loss: 2.1837 (TopK: 2.1668, CE: 4.9924) | Acc@1: 0.2396 | Acc@5: 0.5938 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 6 | Batch 30/78 | Loss: 1.9992 (TopK: 1.9829, CE: 4.7069) | Acc@1: 0.3750 | Acc@5: 0.6146 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 6 | Batch 40/78 | Loss: 1.9853 (TopK: 1.9684, CE: 4.8003) | Acc@1: 0.2917 | Acc@5: 0.6250 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 6 | Batch 50/78 | Loss: 2.2211 (TopK: 2.2036, CE: 5.1281) | Acc@1: 0.3125 | Acc@5: 0.5521 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 6 | Batch 60/78 | Loss: 2.3384 (TopK: 2.3185, CE: 5.6467) | Acc@1: 0.2396 | Acc@5: 0.5417 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 6 | Batch 70/78 | Loss: 2.3076 (TopK: 2.2895, CE: 5.3089) | Acc@1: 0.2708 | Acc@5: 0.5521 | Acc@10: 0.5938 | AccumSteps: 1

Validation Results:
  Loss: 7.0387
  Acc@1: 0.0983 (9.83%)
  Acc@5: 0.2248 (22.48%)
  Acc@10: 0.2557 (25.57%)


Test Results:
  Loss: 7.0412
  Acc@1: 0.0926 (9.26%)
  Acc@5: 0.2085 (20.85%)
  Acc@10: 0.2282 (22.82%)

Epoch 6 Summary:
  Train - Loss: 2.2575 (TopK: 2.2396[0.99], CE: 5.2208) | Acc@1: 0.2762
  Val   - Loss: 7.0387 | Acc@1: 0.0983
  Test  - Loss: 7.0412 | Acc@1: 0.0926
  Time: 12.81s | LR: 0.000800
  Params: 440,669

============================================================
Epoch 7/600
============================================================
Epoch 7 | Batch 10/78 | Loss: 2.3585 (TopK: 2.3360, CE: 5.5529) | Acc@1: 0.2500 | Acc@5: 0.5312 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 7 | Batch 20/78 | Loss: 2.1428 (TopK: 2.1233, CE: 4.9160) | Acc@1: 0.3229 | Acc@5: 0.5417 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 7 | Batch 30/78 | Loss: 2.3971 (TopK: 2.3750, CE: 5.5293) | Acc@1: 0.2083 | Acc@5: 0.5312 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 7 | Batch 40/78 | Loss: 2.4592 (TopK: 2.4338, CE: 6.0652) | Acc@1: 0.2500 | Acc@5: 0.5104 | Acc@10: 0.5625 | AccumSteps: 1
Epoch 7 | Batch 50/78 | Loss: 2.2012 (TopK: 2.1784, CE: 5.4421) | Acc@1: 0.3125 | Acc@5: 0.5417 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 7 | Batch 60/78 | Loss: 1.9967 (TopK: 1.9763, CE: 4.8809) | Acc@1: 0.3333 | Acc@5: 0.6354 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 7 | Batch 70/78 | Loss: 2.1165 (TopK: 2.0959, CE: 5.0371) | Acc@1: 0.3438 | Acc@5: 0.5833 | Acc@10: 0.6250 | AccumSteps: 1

Validation Results:
  Loss: 7.0188
  Acc@1: 0.1036 (10.36%)
  Acc@5: 0.2551 (25.51%)
  Acc@10: 0.2620 (26.20%)


Test Results:
  Loss: 7.0208
  Acc@1: 0.0972 (9.72%)
  Acc@5: 0.2243 (22.43%)
  Acc@10: 0.2387 (23.87%)

Epoch 7 Summary:
  Train - Loss: 2.2134 (TopK: 2.1919[0.99], CE: 5.2675) | Acc@1: 0.2949
  Val   - Loss: 7.0188 | Acc@1: 0.1036
  Test  - Loss: 7.0208 | Acc@1: 0.0972
  Time: 12.88s | LR: 0.000933
  Params: 440,669

============================================================
Epoch 8/600
============================================================
Epoch 8 | Batch 10/78 | Loss: 2.3619 (TopK: 2.3363, CE: 5.5273) | Acc@1: 0.2708 | Acc@5: 0.5312 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 8 | Batch 20/78 | Loss: 2.5376 (TopK: 2.5113, CE: 5.8075) | Acc@1: 0.1875 | Acc@5: 0.4896 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 8 | Batch 30/78 | Loss: 2.4878 (TopK: 2.4608, CE: 5.8352) | Acc@1: 0.2708 | Acc@5: 0.4688 | Acc@10: 0.5208 | AccumSteps: 1
Epoch 8 | Batch 40/78 | Loss: 2.0334 (TopK: 2.0098, CE: 4.9559) | Acc@1: 0.3021 | Acc@5: 0.6250 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 8 | Batch 50/78 | Loss: 2.3363 (TopK: 2.3097, CE: 5.6333) | Acc@1: 0.2500 | Acc@5: 0.5000 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 8 | Batch 60/78 | Loss: 2.0137 (TopK: 1.9917, CE: 4.7488) | Acc@1: 0.3229 | Acc@5: 0.6042 | Acc@10: 0.6979 | AccumSteps: 1
Epoch 8 | Batch 70/78 | Loss: 1.7856 (TopK: 1.7632, CE: 4.5592) | Acc@1: 0.3646 | Acc@5: 0.6875 | Acc@10: 0.7188 | AccumSteps: 1

Validation Results:
  Loss: 6.9897
  Acc@1: 0.1171 (11.71%)
  Acc@5: 0.2876 (28.76%)
  Acc@10: 0.3028 (30.28%)


Test Results:
  Loss: 6.9913
  Acc@1: 0.1094 (10.94%)
  Acc@5: 0.2573 (25.73%)
  Acc@10: 0.2729 (27.29%)

Epoch 8 Summary:
  Train - Loss: 2.1642 (TopK: 2.1403[0.99], CE: 5.1360) | Acc@1: 0.2998
  Val   - Loss: 6.9897 | Acc@1: 0.1171
  Test  - Loss: 6.9913 | Acc@1: 0.1094
  Time: 12.84s | LR: 0.001067
  Params: 440,669

============================================================
Epoch 9/600
============================================================
Epoch 9 | Batch 10/78 | Loss: 1.8512 (TopK: 1.8282, CE: 4.3799) | Acc@1: 0.4062 | Acc@5: 0.6771 | Acc@10: 0.7188 | AccumSteps: 1
Epoch 9 | Batch 20/78 | Loss: 1.9841 (TopK: 1.9571, CE: 4.9622) | Acc@1: 0.3021 | Acc@5: 0.6146 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 9 | Batch 30/78 | Loss: 2.1891 (TopK: 2.1614, CE: 5.2465) | Acc@1: 0.3125 | Acc@5: 0.5417 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 9 | Batch 40/78 | Loss: 1.7417 (TopK: 1.7180, CE: 4.3431) | Acc@1: 0.4271 | Acc@5: 0.6667 | Acc@10: 0.6875 | AccumSteps: 1
Epoch 9 | Batch 50/78 | Loss: 1.9060 (TopK: 1.8794, CE: 4.8325) | Acc@1: 0.2708 | Acc@5: 0.6354 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 9 | Batch 60/78 | Loss: 2.0340 (TopK: 2.0076, CE: 4.9480) | Acc@1: 0.4062 | Acc@5: 0.5729 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 9 | Batch 70/78 | Loss: 2.2844 (TopK: 2.2592, CE: 5.0616) | Acc@1: 0.2188 | Acc@5: 0.5729 | Acc@10: 0.6042 | AccumSteps: 1

Validation Results:
  Loss: 6.9420
  Acc@1: 0.1354 (13.54%)
  Acc@5: 0.2890 (28.90%)
  Acc@10: 0.3167 (31.67%)


Test Results:
  Loss: 6.9454
  Acc@1: 0.1263 (12.63%)
  Acc@5: 0.2599 (25.99%)
  Acc@10: 0.2855 (28.55%)

Epoch 9 Summary:
  Train - Loss: 2.1294 (TopK: 2.1020[0.99], CE: 5.1528) | Acc@1: 0.3070
  Val   - Loss: 6.9420 | Acc@1: 0.1354
  Test  - Loss: 6.9454 | Acc@1: 0.1263
  Time: 12.82s | LR: 0.001200
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch9.pt
  ✅ New best validation accuracy! (13.54%)

============================================================
Epoch 10/600
============================================================
Epoch 10 | Batch 10/78 | Loss: 2.1952 (TopK: 2.1604, CE: 5.6468) | Acc@1: 0.3750 | Acc@5: 0.5417 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 10 | Batch 20/78 | Loss: 2.2440 (TopK: 2.2118, CE: 5.4310) | Acc@1: 0.2292 | Acc@5: 0.5625 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 10 | Batch 30/78 | Loss: 2.1279 (TopK: 2.0982, CE: 5.0661) | Acc@1: 0.2917 | Acc@5: 0.5729 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 10 | Batch 40/78 | Loss: 1.9708 (TopK: 1.9437, CE: 4.6514) | Acc@1: 0.3125 | Acc@5: 0.6146 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 10 | Batch 50/78 | Loss: 2.0839 (TopK: 2.0489, CE: 5.5558) | Acc@1: 0.3229 | Acc@5: 0.5833 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 10 | Batch 60/78 | Loss: 2.1690 (TopK: 2.1377, CE: 5.2630) | Acc@1: 0.2604 | Acc@5: 0.5833 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 10 | Batch 70/78 | Loss: 2.0553 (TopK: 2.0190, CE: 5.6431) | Acc@1: 0.2500 | Acc@5: 0.6042 | Acc@10: 0.6562 | AccumSteps: 1

Validation Results:
  Loss: 6.8623
  Acc@1: 0.1670 (16.70%)
  Acc@5: 0.2904 (29.04%)
  Acc@10: 0.3565 (35.65%)


Test Results:
  Loss: 6.8735
  Acc@1: 0.1534 (15.34%)
  Acc@5: 0.2668 (26.68%)
  Acc@10: 0.3323 (33.23%)

Epoch 10 Summary:
  Train - Loss: 2.1419 (TopK: 2.1098[0.99], CE: 5.3156) | Acc@1: 0.2994
  Val   - Loss: 6.8623 | Acc@1: 0.1670
  Test  - Loss: 6.8735 | Acc@1: 0.1534
  Time: 12.82s | LR: 0.001333
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch10.pt
  ✅ New best validation accuracy! (16.70%)
  ✅ New best test accuracy! (15.34%)

============================================================
Epoch 11/600
============================================================
Epoch 11 | Batch 10/78 | Loss: 2.1583 (TopK: 2.1254, CE: 5.1089) | Acc@1: 0.3021 | Acc@5: 0.5625 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 11 | Batch 20/78 | Loss: 1.9760 (TopK: 1.9422, CE: 5.0129) | Acc@1: 0.3229 | Acc@5: 0.6250 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 11 | Batch 30/78 | Loss: 2.0907 (TopK: 2.0540, CE: 5.3887) | Acc@1: 0.2812 | Acc@5: 0.5938 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 11 | Batch 40/78 | Loss: 2.1819 (TopK: 2.1493, CE: 5.1151) | Acc@1: 0.3542 | Acc@5: 0.5417 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 11 | Batch 50/78 | Loss: 2.1815 (TopK: 2.1487, CE: 5.1312) | Acc@1: 0.2292 | Acc@5: 0.5625 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 11 | Batch 60/78 | Loss: 2.0720 (TopK: 2.0412, CE: 4.8454) | Acc@1: 0.2917 | Acc@5: 0.6042 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 11 | Batch 70/78 | Loss: 2.4468 (TopK: 2.4102, CE: 5.7392) | Acc@1: 0.2188 | Acc@5: 0.5000 | Acc@10: 0.5833 | AccumSteps: 1

Validation Results:
  Loss: 6.7396
  Acc@1: 0.1891 (18.91%)
  Acc@5: 0.3369 (33.69%)
  Acc@10: 0.4056 (40.56%)


Test Results:
  Loss: 6.7703
  Acc@1: 0.1698 (16.98%)
  Acc@5: 0.3017 (30.17%)
  Acc@10: 0.3654 (36.54%)

Epoch 11 Summary:
  Train - Loss: 2.1326 (TopK: 2.0987[0.99], CE: 5.1763) | Acc@1: 0.2987
  Val   - Loss: 6.7396 | Acc@1: 0.1891
  Test  - Loss: 6.7703 | Acc@1: 0.1698
  Time: 13.01s | LR: 0.001467
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch11.pt
  ✅ New best validation accuracy! (18.91%)
  ✅ New best test accuracy! (16.98%)

============================================================
Epoch 12/600
============================================================
Epoch 12 | Batch 10/78 | Loss: 1.9582 (TopK: 1.9254, CE: 4.6582) | Acc@1: 0.3438 | Acc@5: 0.6250 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 12 | Batch 20/78 | Loss: 1.7768 (TopK: 1.7407, CE: 4.7447) | Acc@1: 0.3646 | Acc@5: 0.6771 | Acc@10: 0.7188 | AccumSteps: 1
Epoch 12 | Batch 30/78 | Loss: 2.5451 (TopK: 2.5023, CE: 6.0639) | Acc@1: 0.1979 | Acc@5: 0.5000 | Acc@10: 0.5104 | AccumSteps: 1
Epoch 12 | Batch 40/78 | Loss: 1.9642 (TopK: 1.9295, CE: 4.8204) | Acc@1: 0.3542 | Acc@5: 0.6354 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 12 | Batch 50/78 | Loss: 2.0469 (TopK: 2.0095, CE: 5.1315) | Acc@1: 0.3021 | Acc@5: 0.6042 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 12 | Batch 60/78 | Loss: 2.2085 (TopK: 2.1696, CE: 5.4085) | Acc@1: 0.3333 | Acc@5: 0.5521 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 12 | Batch 70/78 | Loss: 2.0166 (TopK: 1.9812, CE: 4.9285) | Acc@1: 0.2188 | Acc@5: 0.6146 | Acc@10: 0.6771 | AccumSteps: 1

Validation Results:
  Loss: 6.5689
  Acc@1: 0.1899 (18.99%)
  Acc@5: 0.3738 (37.38%)
  Acc@10: 0.4690 (46.90%)


Test Results:
  Loss: 6.6330
  Acc@1: 0.1740 (17.40%)
  Acc@5: 0.3200 (32.00%)
  Acc@10: 0.3921 (39.21%)

Epoch 12 Summary:
  Train - Loss: 2.1263 (TopK: 2.0883[0.99], CE: 5.2542) | Acc@1: 0.2902
  Val   - Loss: 6.5689 | Acc@1: 0.1899
  Test  - Loss: 6.6330 | Acc@1: 0.1740
  Time: 12.84s | LR: 0.001600
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch12.pt
  ✅ New best validation accuracy! (18.99%)
  ✅ New best test accuracy! (17.40%)

============================================================
Epoch 13/600
============================================================
Epoch 13 | Batch 10/78 | Loss: 2.1338 (TopK: 2.0954, CE: 5.0439) | Acc@1: 0.2188 | Acc@5: 0.6146 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 13 | Batch 20/78 | Loss: 2.3262 (TopK: 2.2820, CE: 5.6839) | Acc@1: 0.3021 | Acc@5: 0.5312 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 13 | Batch 30/78 | Loss: 1.8599 (TopK: 1.8161, CE: 5.1866) | Acc@1: 0.3542 | Acc@5: 0.6562 | Acc@10: 0.7083 | AccumSteps: 1
Epoch 13 | Batch 40/78 | Loss: 1.9001 (TopK: 1.8625, CE: 4.7540) | Acc@1: 0.3021 | Acc@5: 0.6562 | Acc@10: 0.7083 | AccumSteps: 1
Epoch 13 | Batch 50/78 | Loss: 1.7723 (TopK: 1.7393, CE: 4.2794) | Acc@1: 0.3854 | Acc@5: 0.6875 | Acc@10: 0.7083 | AccumSteps: 1
Epoch 13 | Batch 60/78 | Loss: 2.0681 (TopK: 2.0230, CE: 5.4942) | Acc@1: 0.3646 | Acc@5: 0.5833 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 13 | Batch 70/78 | Loss: 1.8100 (TopK: 1.7771, CE: 4.3134) | Acc@1: 0.3229 | Acc@5: 0.6875 | Acc@10: 0.7083 | AccumSteps: 1

Validation Results:
  Loss: 6.3683
  Acc@1: 0.1928 (19.28%)
  Acc@5: 0.4226 (42.26%)
  Acc@10: 0.5036 (50.36%)


Test Results:
  Loss: 6.4756
  Acc@1: 0.1675 (16.75%)
  Acc@5: 0.3506 (35.06%)
  Acc@10: 0.4194 (41.94%)

Epoch 13 Summary:
  Train - Loss: 2.0884 (TopK: 2.0477[0.99], CE: 5.1770) | Acc@1: 0.3076
  Val   - Loss: 6.3683 | Acc@1: 0.1928
  Test  - Loss: 6.4756 | Acc@1: 0.1675
  Time: 12.78s | LR: 0.001733
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch13.pt
  ✅ New best validation accuracy! (19.28%)

============================================================
Epoch 14/600
============================================================
Epoch 14 | Batch 10/78 | Loss: 2.2075 (TopK: 2.1563, CE: 5.8108) | Acc@1: 0.2812 | Acc@5: 0.5729 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 14 | Batch 20/78 | Loss: 2.2754 (TopK: 2.2327, CE: 5.2786) | Acc@1: 0.2604 | Acc@5: 0.5625 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 14 | Batch 30/78 | Loss: 2.2268 (TopK: 2.1863, CE: 5.0815) | Acc@1: 0.2708 | Acc@5: 0.5417 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 14 | Batch 40/78 | Loss: 2.3431 (TopK: 2.2991, CE: 5.4390) | Acc@1: 0.3125 | Acc@5: 0.5104 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 14 | Batch 50/78 | Loss: 2.0334 (TopK: 1.9934, CE: 4.8483) | Acc@1: 0.3438 | Acc@5: 0.6146 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 14 | Batch 60/78 | Loss: 1.9932 (TopK: 1.9497, CE: 5.0579) | Acc@1: 0.3229 | Acc@5: 0.6354 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 14 | Batch 70/78 | Loss: 2.0337 (TopK: 1.9864, CE: 5.3618) | Acc@1: 0.3438 | Acc@5: 0.6042 | Acc@10: 0.6667 | AccumSteps: 1

Validation Results:
  Loss: 6.1424
  Acc@1: 0.1905 (19.05%)
  Acc@5: 0.4524 (45.24%)
  Acc@10: 0.5235 (52.35%)


Test Results:
  Loss: 6.3032
  Acc@1: 0.1650 (16.50%)
  Acc@5: 0.3616 (36.16%)
  Acc@10: 0.4642 (46.42%)

Epoch 14 Summary:
  Train - Loss: 2.0974 (TopK: 2.0533[0.99], CE: 5.2029) | Acc@1: 0.3025
  Val   - Loss: 6.1424 | Acc@1: 0.1905
  Test  - Loss: 6.3032 | Acc@1: 0.1650
  Time: 12.80s | LR: 0.001867
  Params: 440,669

============================================================
Epoch 15/600
============================================================
Epoch 15 | Batch 10/78 | Loss: 2.2268 (TopK: 2.1844, CE: 5.0095) | Acc@1: 0.2812 | Acc@5: 0.5729 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 15 | Batch 20/78 | Loss: 2.0607 (TopK: 2.0163, CE: 4.9715) | Acc@1: 0.2604 | Acc@5: 0.6146 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 15 | Batch 30/78 | Loss: 1.9650 (TopK: 1.9194, CE: 4.9651) | Acc@1: 0.3021 | Acc@5: 0.6354 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 15 | Batch 40/78 | Loss: 2.1179 (TopK: 2.0706, CE: 5.2297) | Acc@1: 0.2396 | Acc@5: 0.6042 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 15 | Batch 50/78 | Loss: 2.2116 (TopK: 2.1610, CE: 5.5371) | Acc@1: 0.2604 | Acc@5: 0.5521 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 15 | Batch 60/78 | Loss: 2.0317 (TopK: 1.9883, CE: 4.8824) | Acc@1: 0.3125 | Acc@5: 0.6042 | Acc@10: 0.6875 | AccumSteps: 1
Epoch 15 | Batch 70/78 | Loss: 1.9869 (TopK: 1.9466, CE: 4.6350) | Acc@1: 0.3125 | Acc@5: 0.6146 | Acc@10: 0.6667 | AccumSteps: 1

Validation Results:
  Loss: 5.9065
  Acc@1: 0.2006 (20.06%)
  Acc@5: 0.4720 (47.20%)
  Acc@10: 0.5565 (55.65%)


Test Results:
  Loss: 6.1308
  Acc@1: 0.1743 (17.43%)
  Acc@5: 0.3696 (36.96%)
  Acc@10: 0.4808 (48.08%)

Epoch 15 Summary:
  Train - Loss: 2.1066 (TopK: 2.0611[0.98], CE: 5.0961) | Acc@1: 0.3040
  Val   - Loss: 5.9065 | Acc@1: 0.2006
  Test  - Loss: 6.1308 | Acc@1: 0.1743
  Time: 12.77s | LR: 0.002000
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch15.pt
  ✅ New best validation accuracy! (20.06%)
  ✅ New best test accuracy! (17.43%)

============================================================
Epoch 16/600
============================================================
Epoch 16 | Batch 10/78 | Loss: 2.1630 (TopK: 2.1129, CE: 5.2442) | Acc@1: 0.2500 | Acc@5: 0.5729 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 16 | Batch 20/78 | Loss: 2.1410 (TopK: 2.0902, CE: 5.2627) | Acc@1: 0.3333 | Acc@5: 0.5833 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 16 | Batch 30/78 | Loss: 2.0185 (TopK: 1.9732, CE: 4.8057) | Acc@1: 0.3229 | Acc@5: 0.6146 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 16 | Batch 40/78 | Loss: 2.3079 (TopK: 2.2567, CE: 5.4560) | Acc@1: 0.2604 | Acc@5: 0.5521 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 16 | Batch 50/78 | Loss: 2.2649 (TopK: 2.2167, CE: 5.2324) | Acc@1: 0.3438 | Acc@5: 0.5208 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 16 | Batch 60/78 | Loss: 2.7094 (TopK: 2.6530, CE: 6.1796) | Acc@1: 0.2396 | Acc@5: 0.4375 | Acc@10: 0.5521 | AccumSteps: 2
Epoch 16 | Batch 70/78 | Loss: 2.2807 (TopK: 2.2334, CE: 5.1925) | Acc@1: 0.3438 | Acc@5: 0.5417 | Acc@10: 0.5833 | AccumSteps: 2

Validation Results:
  Loss: 5.7083
  Acc@1: 0.2015 (20.15%)
  Acc@5: 0.4824 (48.24%)
  Acc@10: 0.5552 (55.52%)


Test Results:
  Loss: 5.9903
  Acc@1: 0.1768 (17.68%)
  Acc@5: 0.3794 (37.94%)
  Acc@10: 0.4796 (47.96%)

Epoch 16 Summary:
  Train - Loss: 2.2027 (TopK: 2.1456[0.98], CE: 5.2508) | Acc@1: 0.2955
  Val   - Loss: 5.7083 | Acc@1: 0.2015
  Test  - Loss: 5.9903 | Acc@1: 0.1768
  Time: 12.59s | LR: 0.001999
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch16.pt
  ✅ New best validation accuracy! (20.15%)
  ✅ New best test accuracy! (17.68%)

============================================================
Epoch 17/600
============================================================
Epoch 17 | Batch 10/78 | Loss: 2.2427 (TopK: 2.1841, CE: 5.6286) | Acc@1: 0.2396 | Acc@5: 0.5521 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 17 | Batch 20/78 | Loss: 2.3062 (TopK: 2.2448, CE: 5.8536) | Acc@1: 0.2292 | Acc@5: 0.5625 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 17 | Batch 30/78 | Loss: 2.0552 (TopK: 2.0015, CE: 5.1603) | Acc@1: 0.3542 | Acc@5: 0.6042 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 17 | Batch 40/78 | Loss: 1.9964 (TopK: 1.9404, CE: 5.2328) | Acc@1: 0.3750 | Acc@5: 0.6146 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 17 | Batch 50/78 | Loss: 2.1890 (TopK: 2.1328, CE: 5.4371) | Acc@1: 0.2604 | Acc@5: 0.5833 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 17 | Batch 60/78 | Loss: 2.5959 (TopK: 2.5391, CE: 5.8763) | Acc@1: 0.2188 | Acc@5: 0.4479 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 17 | Batch 70/78 | Loss: 2.2184 (TopK: 2.1671, CE: 5.1881) | Acc@1: 0.3021 | Acc@5: 0.5729 | Acc@10: 0.6146 | AccumSteps: 1

Validation Results:
  Loss: 5.4789
  Acc@1: 0.2172 (21.72%)
  Acc@5: 0.5071 (50.71%)
  Acc@10: 0.5568 (55.68%)


Test Results:
  Loss: 5.8287
  Acc@1: 0.1892 (18.92%)
  Acc@5: 0.3963 (39.63%)
  Acc@10: 0.4839 (48.39%)

Epoch 17 Summary:
  Train - Loss: 2.1430 (TopK: 2.0890[0.98], CE: 5.2617) | Acc@1: 0.2975
  Val   - Loss: 5.4789 | Acc@1: 0.2172
  Test  - Loss: 5.8287 | Acc@1: 0.1892
  Time: 12.80s | LR: 0.001995
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch17.pt
  ✅ New best validation accuracy! (21.72%)
  ✅ New best test accuracy! (18.92%)

============================================================
Epoch 18/600
============================================================
Epoch 18 | Batch 10/78 | Loss: 1.8840 (TopK: 1.8329, CE: 4.6712) | Acc@1: 0.3750 | Acc@5: 0.6354 | Acc@10: 0.6875 | AccumSteps: 1
Epoch 18 | Batch 20/78 | Loss: 2.2461 (TopK: 2.1910, CE: 5.2511) | Acc@1: 0.2500 | Acc@5: 0.5625 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 18 | Batch 30/78 | Loss: 2.0798 (TopK: 2.0287, CE: 4.8637) | Acc@1: 0.2500 | Acc@5: 0.5938 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 18 | Batch 40/78 | Loss: 1.9657 (TopK: 1.9157, CE: 4.6922) | Acc@1: 0.2812 | Acc@5: 0.6354 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 18 | Batch 50/78 | Loss: 2.1195 (TopK: 2.0632, CE: 5.1870) | Acc@1: 0.2812 | Acc@5: 0.5833 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 18 | Batch 60/78 | Loss: 2.0417 (TopK: 1.9914, CE: 4.7862) | Acc@1: 0.2812 | Acc@5: 0.6250 | Acc@10: 0.7188 | AccumSteps: 1
Epoch 18 | Batch 70/78 | Loss: 2.1254 (TopK: 2.0705, CE: 5.1210) | Acc@1: 0.3333 | Acc@5: 0.5833 | Acc@10: 0.6250 | AccumSteps: 1

Validation Results:
  Loss: 5.2701
  Acc@1: 0.2309 (23.09%)
  Acc@5: 0.5095 (50.95%)
  Acc@10: 0.5559 (55.59%)


Test Results:
  Loss: 5.6824
  Acc@1: 0.1909 (19.09%)
  Acc@5: 0.4028 (40.28%)
  Acc@10: 0.4847 (48.47%)

Epoch 18 Summary:
  Train - Loss: 2.1018 (TopK: 2.0478[0.98], CE: 5.0442) | Acc@1: 0.3114
  Val   - Loss: 5.2701 | Acc@1: 0.2309
  Test  - Loss: 5.6824 | Acc@1: 0.1909
  Time: 12.86s | LR: 0.001989
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch18.pt
  ✅ New best validation accuracy! (23.09%)
  ✅ New best test accuracy! (19.09%)

============================================================
Epoch 19/600
============================================================
Epoch 19 | Batch 10/78 | Loss: 2.1202 (TopK: 2.0653, CE: 4.9508) | Acc@1: 0.2396 | Acc@5: 0.5938 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 19 | Batch 20/78 | Loss: 2.3361 (TopK: 2.2653, CE: 5.9910) | Acc@1: 0.3125 | Acc@5: 0.5312 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 19 | Batch 30/78 | Loss: 2.2025 (TopK: 2.1534, CE: 4.7383) | Acc@1: 0.3229 | Acc@5: 0.5625 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 19 | Batch 40/78 | Loss: 1.7952 (TopK: 1.7486, CE: 4.1980) | Acc@1: 0.3750 | Acc@5: 0.6562 | Acc@10: 0.7083 | AccumSteps: 1
Epoch 19 | Batch 50/78 | Loss: 2.1025 (TopK: 2.0409, CE: 5.2850) | Acc@1: 0.3021 | Acc@5: 0.6146 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 19 | Batch 60/78 | Loss: 2.2858 (TopK: 2.2312, CE: 5.1053) | Acc@1: 0.3542 | Acc@5: 0.5104 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 19 | Batch 70/78 | Loss: 2.2973 (TopK: 2.2326, CE: 5.6354) | Acc@1: 0.2708 | Acc@5: 0.5521 | Acc@10: 0.5938 | AccumSteps: 1

Validation Results:
  Loss: 5.0908
  Acc@1: 0.2402 (24.02%)
  Acc@5: 0.5113 (51.13%)
  Acc@10: 0.5586 (55.86%)


Test Results:
  Loss: 5.5634
  Acc@1: 0.1968 (19.68%)
  Acc@5: 0.4107 (41.07%)
  Acc@10: 0.4830 (48.30%)

Epoch 19 Summary:
  Train - Loss: 2.1483 (TopK: 2.0899[0.98], CE: 5.1658) | Acc@1: 0.2971
  Val   - Loss: 5.0908 | Acc@1: 0.2402
  Test  - Loss: 5.5634 | Acc@1: 0.1968
  Time: 12.82s | LR: 0.001979
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch19.pt
  ✅ New best validation accuracy! (24.02%)
  ✅ New best test accuracy! (19.68%)

============================================================
Epoch 20/600
============================================================
Epoch 20 | Batch 10/78 | Loss: 2.0851 (TopK: 2.0274, CE: 4.9106) | Acc@1: 0.3229 | Acc@5: 0.5833 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 20 | Batch 20/78 | Loss: 2.0266 (TopK: 1.9716, CE: 4.7198) | Acc@1: 0.3021 | Acc@5: 0.6250 | Acc@10: 0.6667 | AccumSteps: 1
Epoch 20 | Batch 30/78 | Loss: 1.9676 (TopK: 1.9113, CE: 4.7216) | Acc@1: 0.3021 | Acc@5: 0.6458 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 20 | Batch 40/78 | Loss: 2.1964 (TopK: 2.1346, CE: 5.2210) | Acc@1: 0.2708 | Acc@5: 0.5729 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 20 | Batch 50/78 | Loss: 1.9315 (TopK: 1.8775, CE: 4.5765) | Acc@1: 0.3854 | Acc@5: 0.6250 | Acc@10: 0.6979 | AccumSteps: 1
Epoch 20 | Batch 60/78 | Loss: 1.4056 (TopK: 1.3612, CE: 3.5784) | Acc@1: 0.4583 | Acc@5: 0.7708 | Acc@10: 0.8125 | AccumSteps: 1
Epoch 20 | Batch 70/78 | Loss: 2.2473 (TopK: 2.1887, CE: 5.1219) | Acc@1: 0.2812 | Acc@5: 0.5417 | Acc@10: 0.6354 | AccumSteps: 1

Validation Results:
  Loss: 4.9422
  Acc@1: 0.2446 (24.46%)
  Acc@5: 0.5187 (51.87%)
  Acc@10: 0.5619 (56.19%)


Test Results:
  Loss: 5.4460
  Acc@1: 0.2005 (20.05%)
  Acc@5: 0.4169 (41.69%)
  Acc@10: 0.4844 (48.44%)

Epoch 20 Summary:
  Train - Loss: 2.0854 (TopK: 2.0273[0.98], CE: 4.9343) | Acc@1: 0.3196
  Val   - Loss: 4.9422 | Acc@1: 0.2446
  Test  - Loss: 5.4460 | Acc@1: 0.2005
  Time: 12.85s | LR: 0.001967
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch20.pt
  ✅ New best validation accuracy! (24.46%)
  ✅ New best test accuracy! (20.05%)

============================================================
Epoch 21/600
============================================================
Epoch 21 | Batch 10/78 | Loss: 2.2755 (TopK: 2.2158, CE: 5.0587) | Acc@1: 0.2708 | Acc@5: 0.5521 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 21 | Batch 20/78 | Loss: 2.2448 (TopK: 2.1819, CE: 5.1780) | Acc@1: 0.2917 | Acc@5: 0.5729 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 21 | Batch 30/78 | Loss: 2.3804 (TopK: 2.3013, CE: 6.0668) | Acc@1: 0.2917 | Acc@5: 0.5312 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 21 | Batch 40/78 | Loss: 2.3107 (TopK: 2.2467, CE: 5.2950) | Acc@1: 0.2188 | Acc@5: 0.5729 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 21 | Batch 50/78 | Loss: 2.1358 (TopK: 2.0660, CE: 5.3877) | Acc@1: 0.3021 | Acc@5: 0.6250 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 21 | Batch 60/78 | Loss: 1.9250 (TopK: 1.8731, CE: 4.3425) | Acc@1: 0.2604 | Acc@5: 0.6771 | Acc@10: 0.6979 | AccumSteps: 1
Epoch 21 | Batch 70/78 | Loss: 2.1536 (TopK: 2.0874, CE: 5.2387) | Acc@1: 0.3125 | Acc@5: 0.5833 | Acc@10: 0.6667 | AccumSteps: 1

Validation Results:
  Loss: 4.8518
  Acc@1: 0.2550 (25.50%)
  Acc@5: 0.5187 (51.87%)
  Acc@10: 0.5667 (56.67%)


Test Results:
  Loss: 5.3745
  Acc@1: 0.2104 (21.04%)
  Acc@5: 0.4183 (41.83%)
  Acc@10: 0.4855 (48.55%)

Epoch 21 Summary:
  Train - Loss: 2.2695 (TopK: 2.2049[0.98], CE: 5.2838) | Acc@1: 0.2679
  Val   - Loss: 4.8518 | Acc@1: 0.2550
  Test  - Loss: 5.3745 | Acc@1: 0.2104
  Time: 12.85s | LR: 0.001953
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch21.pt
  ✅ New best validation accuracy! (25.50%)
  ✅ New best test accuracy! (21.04%)

============================================================
Epoch 22/600
============================================================
Epoch 22 | Batch 10/78 | Loss: 2.1510 (TopK: 2.0856, CE: 5.0606) | Acc@1: 0.3438 | Acc@5: 0.6146 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 22 | Batch 20/78 | Loss: 2.3328 (TopK: 2.2626, CE: 5.4572) | Acc@1: 0.2812 | Acc@5: 0.5208 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 22 | Batch 30/78 | Loss: 2.3238 (TopK: 2.2519, CE: 5.5186) | Acc@1: 0.2083 | Acc@5: 0.5625 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 22 | Batch 40/78 | Loss: 2.1223 (TopK: 2.0580, CE: 4.9799) | Acc@1: 0.3646 | Acc@5: 0.5729 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 22 | Batch 50/78 | Loss: 2.5721 (TopK: 2.4918, CE: 6.1390) | Acc@1: 0.2188 | Acc@5: 0.4583 | Acc@10: 0.5208 | AccumSteps: 1
Epoch 22 | Batch 60/78 | Loss: 2.3924 (TopK: 2.3171, CE: 5.7401) | Acc@1: 0.3438 | Acc@5: 0.5000 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 22 | Batch 70/78 | Loss: 2.4166 (TopK: 2.3478, CE: 5.4791) | Acc@1: 0.2396 | Acc@5: 0.5208 | Acc@10: 0.5625 | AccumSteps: 1

Validation Results:
  Loss: 4.7803
  Acc@1: 0.2663 (26.63%)
  Acc@5: 0.5214 (52.14%)
  Acc@10: 0.5637 (56.37%)


Test Results:
  Loss: 5.3249
  Acc@1: 0.2222 (22.22%)
  Acc@5: 0.4219 (42.19%)
  Acc@10: 0.4847 (48.47%)

Epoch 22 Summary:
  Train - Loss: 2.2698 (TopK: 2.2017[0.98], CE: 5.2950) | Acc@1: 0.2720
  Val   - Loss: 4.7803 | Acc@1: 0.2663
  Test  - Loss: 5.3249 | Acc@1: 0.2222
  Time: 13.01s | LR: 0.001936
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch22.pt
  ✅ New best validation accuracy! (26.63%)
  ✅ New best test accuracy! (22.22%)

============================================================
Epoch 23/600
============================================================
Epoch 23 | Batch 10/78 | Loss: 2.3161 (TopK: 2.2410, CE: 5.5044) | Acc@1: 0.2604 | Acc@5: 0.5625 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 23 | Batch 20/78 | Loss: 2.2732 (TopK: 2.2051, CE: 5.1625) | Acc@1: 0.3021 | Acc@5: 0.5417 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 23 | Batch 30/78 | Loss: 2.2527 (TopK: 2.1894, CE: 4.9445) | Acc@1: 0.3333 | Acc@5: 0.5625 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 23 | Batch 40/78 | Loss: 2.6227 (TopK: 2.5424, CE: 6.0348) | Acc@1: 0.2083 | Acc@5: 0.4583 | Acc@10: 0.4896 | AccumSteps: 1
Epoch 23 | Batch 50/78 | Loss: 2.3036 (TopK: 2.2321, CE: 5.3374) | Acc@1: 0.2708 | Acc@5: 0.5521 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 23 | Batch 60/78 | Loss: 2.1905 (TopK: 2.1225, CE: 5.0805) | Acc@1: 0.2500 | Acc@5: 0.6042 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 23 | Batch 70/78 | Loss: 2.6447 (TopK: 2.5683, CE: 5.8928) | Acc@1: 0.2083 | Acc@5: 0.4792 | Acc@10: 0.5312 | AccumSteps: 1

Validation Results:
  Loss: 4.7278
  Acc@1: 0.2637 (26.37%)
  Acc@5: 0.5232 (52.32%)
  Acc@10: 0.5610 (56.10%)


Test Results:
  Loss: 5.2951
  Acc@1: 0.2222 (22.22%)
  Acc@5: 0.4250 (42.50%)
  Acc@10: 0.4858 (48.58%)

Epoch 23 Summary:
  Train - Loss: 2.3326 (TopK: 2.2619[0.98], CE: 5.3367) | Acc@1: 0.2597
  Val   - Loss: 4.7278 | Acc@1: 0.2637
  Test  - Loss: 5.2951 | Acc@1: 0.2222
  Time: 12.84s | LR: 0.001916
  Params: 440,669

============================================================
Epoch 24/600
============================================================
Epoch 24 | Batch 10/78 | Loss: 2.5002 (TopK: 2.4158, CE: 5.9333) | Acc@1: 0.2604 | Acc@5: 0.5104 | Acc@10: 0.5208 | AccumSteps: 1
Epoch 24 | Batch 20/78 | Loss: 2.2340 (TopK: 2.1553, CE: 5.4334) | Acc@1: 0.2396 | Acc@5: 0.5729 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 24 | Batch 30/78 | Loss: 2.3442 (TopK: 2.2689, CE: 5.4091) | Acc@1: 0.3125 | Acc@5: 0.5312 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 24 | Batch 40/78 | Loss: 2.3431 (TopK: 2.2707, CE: 5.2850) | Acc@1: 0.3125 | Acc@5: 0.5312 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 24 | Batch 50/78 | Loss: 2.4727 (TopK: 2.3955, CE: 5.6108) | Acc@1: 0.1875 | Acc@5: 0.5104 | Acc@10: 0.5625 | AccumSteps: 1
Epoch 24 | Batch 60/78 | Loss: 2.2674 (TopK: 2.2032, CE: 4.8762) | Acc@1: 0.2917 | Acc@5: 0.5521 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 24 | Batch 70/78 | Loss: 2.7603 (TopK: 2.6876, CE: 5.7149) | Acc@1: 0.1875 | Acc@5: 0.4896 | Acc@10: 0.5521 | AccumSteps: 1

Validation Results:
  Loss: 4.7093
  Acc@1: 0.2583 (25.83%)
  Acc@5: 0.5170 (51.70%)
  Acc@10: 0.5595 (55.95%)


Test Results:
  Loss: 5.3060
  Acc@1: 0.2137 (21.37%)
  Acc@5: 0.4183 (41.83%)
  Acc@10: 0.4853 (48.53%)

Epoch 24 Summary:
  Train - Loss: 2.2902 (TopK: 2.2169[0.98], CE: 5.2729) | Acc@1: 0.2739
  Val   - Loss: 4.7093 | Acc@1: 0.2583
  Test  - Loss: 5.3060 | Acc@1: 0.2137
  Time: 12.80s | LR: 0.001894
  Params: 440,669

============================================================
Epoch 25/600
============================================================
Epoch 25 | Batch 10/78 | Loss: 2.2941 (TopK: 2.2170, CE: 5.2991) | Acc@1: 0.3438 | Acc@5: 0.5521 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 25 | Batch 20/78 | Loss: 2.4427 (TopK: 2.3514, CE: 6.0035) | Acc@1: 0.2396 | Acc@5: 0.5000 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 25 | Batch 30/78 | Loss: 2.3186 (TopK: 2.2401, CE: 5.3799) | Acc@1: 0.2604 | Acc@5: 0.5625 | Acc@10: 0.6875 | AccumSteps: 1
Epoch 25 | Batch 40/78 | Loss: 1.8816 (TopK: 1.8122, CE: 4.5853) | Acc@1: 0.3438 | Acc@5: 0.6667 | Acc@10: 0.6979 | AccumSteps: 1
Epoch 25 | Batch 50/78 | Loss: 2.5638 (TopK: 2.4835, CE: 5.6955) | Acc@1: 0.2604 | Acc@5: 0.4583 | Acc@10: 0.5104 | AccumSteps: 1
Epoch 25 | Batch 60/78 | Loss: 2.1867 (TopK: 2.1140, CE: 5.0203) | Acc@1: 0.2917 | Acc@5: 0.5625 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 25 | Batch 70/78 | Loss: 2.2466 (TopK: 2.1750, CE: 5.0384) | Acc@1: 0.2604 | Acc@5: 0.5833 | Acc@10: 0.6667 | AccumSteps: 1

Validation Results:
  Loss: 4.6975
  Acc@1: 0.2619 (26.19%)
  Acc@5: 0.5113 (51.13%)
  Acc@10: 0.5583 (55.83%)


Test Results:
  Loss: 5.3289
  Acc@1: 0.2126 (21.26%)
  Acc@5: 0.4143 (41.43%)
  Acc@10: 0.4827 (48.27%)

Epoch 25 Summary:
  Train - Loss: 2.2610 (TopK: 2.1835[0.97], CE: 5.2828) | Acc@1: 0.2802
  Val   - Loss: 4.6975 | Acc@1: 0.2619
  Test  - Loss: 5.3289 | Acc@1: 0.2126
  Time: 12.88s | LR: 0.001869
  Params: 440,669

============================================================
Epoch 26/600
============================================================
Epoch 26 | Batch 10/78 | Loss: 2.4766 (TopK: 2.3880, CE: 5.7943) | Acc@1: 0.2500 | Acc@5: 0.5104 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 26 | Batch 20/78 | Loss: 2.4642 (TopK: 2.3774, CE: 5.7129) | Acc@1: 0.2604 | Acc@5: 0.5208 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 26 | Batch 30/78 | Loss: 2.6335 (TopK: 2.5134, CE: 7.1329) | Acc@1: 0.2396 | Acc@5: 0.4792 | Acc@10: 0.5312 | AccumSteps: 1
Epoch 26 | Batch 40/78 | Loss: 2.6683 (TopK: 2.5690, CE: 6.3884) | Acc@1: 0.2292 | Acc@5: 0.4583 | Acc@10: 0.5312 | AccumSteps: 1
Epoch 26 | Batch 50/78 | Loss: 2.5528 (TopK: 2.4605, CE: 6.0078) | Acc@1: 0.2188 | Acc@5: 0.5104 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 26 | Batch 60/78 | Loss: 2.6078 (TopK: 2.5382, CE: 5.2148) | Acc@1: 0.2083 | Acc@5: 0.4896 | Acc@10: 0.5625 | AccumSteps: 1
Epoch 26 | Batch 70/78 | Loss: 2.6294 (TopK: 2.5601, CE: 5.2254) | Acc@1: 0.2083 | Acc@5: 0.5208 | Acc@10: 0.6146 | AccumSteps: 1

Validation Results:
  Loss: 4.6523
  Acc@1: 0.2720 (27.20%)
  Acc@5: 0.5268 (52.68%)
  Acc@10: 0.5655 (56.55%)


Test Results:
  Loss: 5.3002
  Acc@1: 0.2171 (21.71%)
  Acc@5: 0.4287 (42.87%)
  Acc@10: 0.4864 (48.64%)

Epoch 26 Summary:
  Train - Loss: 2.4934 (TopK: 2.4071[0.97], CE: 5.7255) | Acc@1: 0.2481
  Val   - Loss: 4.6523 | Acc@1: 0.2720
  Test  - Loss: 5.3002 | Acc@1: 0.2171
  Time: 12.92s | LR: 0.001842
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch26.pt
  ✅ New best validation accuracy! (27.20%)

============================================================
Epoch 27/600
============================================================
Epoch 27 | Batch 10/78 | Loss: 3.3245 (TopK: 3.2100, CE: 7.4521) | Acc@1: 0.1042 | Acc@5: 0.3333 | Acc@10: 0.4167 | AccumSteps: 1
Epoch 27 | Batch 20/78 | Loss: 3.5225 (TopK: 3.4155, CE: 7.3796) | Acc@1: 0.0729 | Acc@5: 0.3021 | Acc@10: 0.3646 | AccumSteps: 1
Epoch 27 | Batch 30/78 | Loss: 3.1771 (TopK: 3.0758, CE: 6.8275) | Acc@1: 0.1458 | Acc@5: 0.3333 | Acc@10: 0.3750 | AccumSteps: 1
Epoch 27 | Batch 40/78 | Loss: 3.3309 (TopK: 3.1963, CE: 8.1835) | Acc@1: 0.1146 | Acc@5: 0.3125 | Acc@10: 0.3958 | AccumSteps: 1
Epoch 27 | Batch 50/78 | Loss: 3.0345 (TopK: 2.9173, CE: 7.2560) | Acc@1: 0.2083 | Acc@5: 0.3542 | Acc@10: 0.4479 | AccumSteps: 1
Epoch 27 | Batch 60/78 | Loss: 2.5313 (TopK: 2.4220, CE: 6.4707) | Acc@1: 0.2708 | Acc@5: 0.5000 | Acc@10: 0.5625 | AccumSteps: 1
Epoch 27 | Batch 70/78 | Loss: 2.7714 (TopK: 2.6717, CE: 6.3627) | Acc@1: 0.1875 | Acc@5: 0.4375 | Acc@10: 0.5417 | AccumSteps: 1

Validation Results:
  Loss: 4.6370
  Acc@1: 0.2714 (27.14%)
  Acc@5: 0.5256 (52.56%)
  Acc@10: 0.5640 (56.40%)


Test Results:
  Loss: 5.3163
  Acc@1: 0.2174 (21.74%)
  Acc@5: 0.4292 (42.92%)
  Acc@10: 0.4844 (48.44%)

Epoch 27 Summary:
  Train - Loss: 2.9043 (TopK: 2.8013[0.97], CE: 6.6156) | Acc@1: 0.1866
  Val   - Loss: 4.6370 | Acc@1: 0.2714
  Test  - Loss: 5.3163 | Acc@1: 0.2174
  Time: 12.83s | LR: 0.001813
  Params: 440,669

============================================================
Epoch 28/600
============================================================
Epoch 28 | Batch 10/78 | Loss: 2.4887 (TopK: 2.3909, CE: 5.8822) | Acc@1: 0.2500 | Acc@5: 0.5104 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 28 | Batch 20/78 | Loss: 2.4811 (TopK: 2.3842, CE: 5.8446) | Acc@1: 0.2500 | Acc@5: 0.5000 | Acc@10: 0.5833 | AccumSteps: 1
Epoch 28 | Batch 30/78 | Loss: 2.6586 (TopK: 2.5561, CE: 6.2164) | Acc@1: 0.1667 | Acc@5: 0.4896 | Acc@10: 0.5625 | AccumSteps: 1
Epoch 28 | Batch 40/78 | Loss: 2.3976 (TopK: 2.3115, CE: 5.3860) | Acc@1: 0.2708 | Acc@5: 0.5417 | Acc@10: 0.6146 | AccumSteps: 1
Epoch 28 | Batch 50/78 | Loss: 2.6792 (TopK: 2.5958, CE: 5.5748) | Acc@1: 0.2188 | Acc@5: 0.4688 | Acc@10: 0.5625 | AccumSteps: 1
Epoch 28 | Batch 60/78 | Loss: 2.5930 (TopK: 2.5006, CE: 5.8010) | Acc@1: 0.2083 | Acc@5: 0.4896 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 28 | Batch 70/78 | Loss: 2.1657 (TopK: 2.0873, CE: 4.8873) | Acc@1: 0.2708 | Acc@5: 0.6146 | Acc@10: 0.6875 | AccumSteps: 1

Validation Results:
  Loss: 4.6627
  Acc@1: 0.2669 (26.69%)
  Acc@5: 0.5193 (51.93%)
  Acc@10: 0.5693 (56.93%)


Test Results:
  Loss: 5.3406
  Acc@1: 0.2118 (21.18%)
  Acc@5: 0.4233 (42.33%)
  Acc@10: 0.4957 (49.57%)

Epoch 28 Summary:
  Train - Loss: 2.3789 (TopK: 2.2888[0.97], CE: 5.5073) | Acc@1: 0.2592
  Val   - Loss: 4.6627 | Acc@1: 0.2669
  Test  - Loss: 5.3406 | Acc@1: 0.2118
  Time: 12.81s | LR: 0.001781
  Params: 440,669

============================================================
Epoch 29/600
============================================================
Epoch 29 | Batch 10/78 | Loss: 2.6078 (TopK: 2.5216, CE: 5.4969) | Acc@1: 0.2396 | Acc@5: 0.4688 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 29 | Batch 20/78 | Loss: 2.2037 (TopK: 2.1183, CE: 5.0624) | Acc@1: 0.3542 | Acc@5: 0.5625 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 29 | Batch 30/78 | Loss: 2.1820 (TopK: 2.0868, CE: 5.3702) | Acc@1: 0.3229 | Acc@5: 0.5938 | Acc@10: 0.6458 | AccumSteps: 1
Epoch 29 | Batch 40/78 | Loss: 2.2853 (TopK: 2.1766, CE: 5.9273) | Acc@1: 0.3125 | Acc@5: 0.5521 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 29 | Batch 50/78 | Loss: 2.6778 (TopK: 2.5924, CE: 5.5385) | Acc@1: 0.2083 | Acc@5: 0.4792 | Acc@10: 0.5104 | AccumSteps: 1
Epoch 29 | Batch 60/78 | Loss: 2.3183 (TopK: 2.2306, CE: 5.2554) | Acc@1: 0.2917 | Acc@5: 0.5729 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 29 | Batch 70/78 | Loss: 2.3138 (TopK: 2.2198, CE: 5.4618) | Acc@1: 0.2396 | Acc@5: 0.5521 | Acc@10: 0.6354 | AccumSteps: 1

Validation Results:
  Loss: 4.6980
  Acc@1: 0.2672 (26.72%)
  Acc@5: 0.5199 (51.99%)
  Acc@10: 0.5756 (57.56%)


Test Results:
  Loss: 5.3516
  Acc@1: 0.2163 (21.63%)
  Acc@5: 0.4233 (42.33%)
  Acc@10: 0.4954 (49.54%)

Epoch 29 Summary:
  Train - Loss: 2.3218 (TopK: 2.2308[0.97], CE: 5.3692) | Acc@1: 0.2735
  Val   - Loss: 4.6980 | Acc@1: 0.2672
  Test  - Loss: 5.3516 | Acc@1: 0.2163
  Time: 12.79s | LR: 0.001747
  Params: 440,669

============================================================
Epoch 30/600
============================================================
Epoch 30 | Batch 10/78 | Loss: 2.3807 (TopK: 2.2787, CE: 5.6796) | Acc@1: 0.2917 | Acc@5: 0.5521 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 30 | Batch 20/78 | Loss: 2.6633 (TopK: 2.5792, CE: 5.3829) | Acc@1: 0.1667 | Acc@5: 0.5000 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 30 | Batch 30/78 | Loss: 2.6643 (TopK: 2.5642, CE: 5.9002) | Acc@1: 0.2292 | Acc@5: 0.4479 | Acc@10: 0.5312 | AccumSteps: 1
Epoch 30 | Batch 40/78 | Loss: 2.4086 (TopK: 2.3120, CE: 5.5331) | Acc@1: 0.3021 | Acc@5: 0.5208 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 30 | Batch 50/78 | Loss: 2.4642 (TopK: 2.3746, CE: 5.3641) | Acc@1: 0.2188 | Acc@5: 0.5521 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 30 | Batch 60/78 | Loss: 2.1535 (TopK: 2.0667, CE: 4.9591) | Acc@1: 0.3021 | Acc@5: 0.6458 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 30 | Batch 70/78 | Loss: 2.4626 (TopK: 2.3601, CE: 5.7758) | Acc@1: 0.2396 | Acc@5: 0.5417 | Acc@10: 0.5833 | AccumSteps: 1

Validation Results:
  Loss: 4.7445
  Acc@1: 0.2708 (27.08%)
  Acc@5: 0.5241 (52.41%)
  Acc@10: 0.5747 (57.47%)


Test Results:
  Loss: 5.3698
  Acc@1: 0.2194 (21.94%)
  Acc@5: 0.4230 (42.30%)
  Acc@10: 0.4915 (49.15%)

Epoch 30 Summary:
  Train - Loss: nan (TopK: 0.0000[0.97], CE: 0.0000) | Acc@1: 0.2604
  Val   - Loss: 4.7445 | Acc@1: 0.2708
  Test  - Loss: 5.3698 | Acc@1: 0.2194
  Time: 12.72s | LR: 0.001711
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch30.pt

============================================================
Epoch 31/600
============================================================
Epoch 31 | Batch 10/78 | Loss: 2.1200 (TopK: 2.0213, CE: 5.2067) | Acc@1: 0.2812 | Acc@5: 0.6354 | Acc@10: 0.7083 | AccumSteps: 1
Epoch 31 | Batch 20/78 | Loss: 2.2775 (TopK: 2.1854, CE: 5.1549) | Acc@1: 0.2500 | Acc@5: 0.5833 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 31 | Batch 30/78 | Loss: 2.5309 (TopK: 2.4242, CE: 5.8651) | Acc@1: 0.2396 | Acc@5: 0.5208 | Acc@10: 0.5729 | AccumSteps: 1
Epoch 31 | Batch 40/78 | Loss: 2.2252 (TopK: 2.1212, CE: 5.4749) | Acc@1: 0.2708 | Acc@5: 0.6042 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 31 | Batch 50/78 | Loss: 1.8787 (TopK: 1.7946, CE: 4.5067) | Acc@1: 0.3958 | Acc@5: 0.6667 | Acc@10: 0.6979 | AccumSteps: 1
Epoch 31 | Batch 60/78 | Loss: 2.1679 (TopK: 2.0761, CE: 5.0393) | Acc@1: 0.3229 | Acc@5: 0.6042 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 31 | Batch 70/78 | Loss: 2.5748 (TopK: 2.4719, CE: 5.7927) | Acc@1: 0.2292 | Acc@5: 0.4688 | Acc@10: 0.5729 | AccumSteps: 1

Validation Results:
  Loss: 4.7317
  Acc@1: 0.2705 (27.05%)
  Acc@5: 0.5256 (52.56%)
  Acc@10: 0.5741 (57.41%)


Test Results:
  Loss: 5.3238
  Acc@1: 0.2332 (23.32%)
  Acc@5: 0.4253 (42.53%)
  Acc@10: 0.4999 (49.99%)

Epoch 31 Summary:
  Train - Loss: 2.3128 (TopK: 2.2124[0.97], CE: 5.4496) | Acc@1: 0.2718
  Val   - Loss: 4.7317 | Acc@1: 0.2705
  Test  - Loss: 5.3238 | Acc@1: 0.2332
  Time: 12.76s | LR: 0.001674
  Params: 440,669
  ✅ New best test accuracy! (23.32%)

============================================================
Epoch 32/600
============================================================
Epoch 32 | Batch 10/78 | Loss: 2.4885 (TopK: 2.3964, CE: 5.2728) | Acc@1: 0.2812 | Acc@5: 0.5208 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 32 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2708 | Acc@5: 0.6458 | Acc@10: 0.7188 | AccumSteps: 1
Epoch 32 | Batch 30/78 | Loss: 2.2541 (TopK: 2.1644, CE: 4.9667) | Acc@1: 0.3229 | Acc@5: 0.5625 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 32 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2188 | Acc@5: 0.5208 | Acc@10: 0.5521 | AccumSteps: 1
Epoch 32 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2604 | Acc@5: 0.5417 | Acc@10: 0.5938 | AccumSteps: 1
Epoch 32 | Batch 60/78 | Loss: 2.0595 (TopK: 1.9711, CE: 4.7319) | Acc@1: 0.3229 | Acc@5: 0.6354 | Acc@10: 0.6979 | AccumSteps: 1
Epoch 32 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2812 | Acc@5: 0.4896 | Acc@10: 0.6042 | AccumSteps: 1

Validation Results:
  Loss: 4.7382
  Acc@1: 0.2690 (26.90%)
  Acc@5: 0.5193 (51.93%)
  Acc@10: 0.5705 (57.05%)


Test Results:
  Loss: 5.2923
  Acc@1: 0.2216 (22.16%)
  Acc@5: 0.4267 (42.67%)
  Acc@10: 0.4994 (49.94%)

Epoch 32 Summary:
  Train - Loss: nan (TopK: 0.0000[0.97], CE: 0.0000) | Acc@1: 0.2702
  Val   - Loss: 4.7382 | Acc@1: 0.2690
  Test  - Loss: 5.2923 | Acc@1: 0.2216
  Time: 12.37s | LR: 0.001634
  Params: 440,669

============================================================
Epoch 33/600
============================================================
Epoch 33 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2708 | Acc@5: 0.5729 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 33 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2500 | Acc@5: 0.5208 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 33 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2500 | Acc@5: 0.5729 | Acc@10: 0.6771 | AccumSteps: 1
Epoch 33 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2188 | Acc@5: 0.5625 | Acc@10: 0.6250 | AccumSteps: 1
Epoch 33 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2292 | Acc@5: 0.5729 | Acc@10: 0.6354 | AccumSteps: 1
Epoch 33 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2708 | Acc@5: 0.5521 | Acc@10: 0.6042 | AccumSteps: 1
Epoch 33 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2917 | Acc@5: 0.5521 | Acc@10: 0.6458 | AccumSteps: 1

Validation Results:
  Loss: 4.7589
  Acc@1: 0.2708 (27.08%)
  Acc@5: 0.5173 (51.73%)
  Acc@10: 0.5684 (56.84%)


Test Results:
  Loss: 5.2910
  Acc@1: 0.2256 (22.56%)
  Acc@5: 0.4230 (42.30%)
  Acc@10: 0.4920 (49.20%)

Epoch 33 Summary:
  Train - Loss: nan (TopK: 0.0000[0.97], CE: 0.0000) | Acc@1: 0.2596
  Val   - Loss: 4.7589 | Acc@1: 0.2708
  Test  - Loss: 5.2910 | Acc@1: 0.2256
  Time: 12.15s | LR: 0.001593
  Params: 440,669

============================================================
Epoch 34/600
============================================================
Epoch 34 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.3021 | Acc@5: 0.4688 | Acc@10: 0.5417 | AccumSteps: 1
Epoch 34 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.2708 | Acc@5: 0.5833 | Acc@10: 0.6562 | AccumSteps: 1
Epoch 34 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 34 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 34 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1979 | AccumSteps: 1
Epoch 34 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 34 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1354 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 34 Summary:
  Train - Loss: nan (TopK: 0.0000[0.97], CE: 0.0000) | Acc@1: 0.0960
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.13s | LR: 0.001550
  Params: 440,669

============================================================
Epoch 35/600
============================================================
Epoch 35 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.0938 | AccumSteps: 1
Epoch 35 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 35 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 35 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 35 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.0729 | AccumSteps: 1
Epoch 35 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 35 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1562 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 35 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 11.98s | LR: 0.001505
  Params: 440,669

============================================================
Epoch 36/600
============================================================
Epoch 36 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0938 | AccumSteps: 1
Epoch 36 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 36 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1979 | AccumSteps: 1
Epoch 36 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0625 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 36 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 36 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 36 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1667 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 36 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.20s | LR: 0.001459
  Params: 440,669

============================================================
Epoch 37/600
============================================================
Epoch 37 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 37 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 37 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 37 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 37 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 37 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 37 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.2083 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 37 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.10s | LR: 0.001412
  Params: 440,669

============================================================
Epoch 38/600
============================================================
Epoch 38 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 38 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1979 | AccumSteps: 1
Epoch 38 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 38 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 38 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.2500 | AccumSteps: 1
Epoch 38 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 38 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1458 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 38 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.23s | LR: 0.001364
  Params: 440,669

============================================================
Epoch 39/600
============================================================
Epoch 39 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 39 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 39 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 39 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 39 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 39 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 39 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0625 | Acc@10: 0.1875 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 39 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.08s | LR: 0.001315
  Params: 440,669

============================================================
Epoch 40/600
============================================================
Epoch 40 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 40 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 40 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1979 | AccumSteps: 1
Epoch 40 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 40 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 40 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 40 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 40 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.03s | LR: 0.001265
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch40.pt

============================================================
Epoch 41/600
============================================================
Epoch 41 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 41 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 41 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 41 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 41 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 41 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 41 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0625 | Acc@10: 0.2188 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 41 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.06s | LR: 0.001214
  Params: 440,669

============================================================
Epoch 42/600
============================================================
Epoch 42 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 42 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 42 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 42 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 42 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 42 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 42 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1458 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 42 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.10s | LR: 0.001162
  Params: 440,669

============================================================
Epoch 43/600
============================================================
Epoch 43 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 43 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2396 | AccumSteps: 1
Epoch 43 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 43 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 43 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 43 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0625 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 43 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2604 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 43 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.10s | LR: 0.001111
  Params: 440,669

============================================================
Epoch 44/600
============================================================
Epoch 44 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2396 | AccumSteps: 1
Epoch 44 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 44 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 44 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 44 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 44 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 44 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2188 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 44 Summary:
  Train - Loss: nan (TopK: 0.0000[0.96], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.08s | LR: 0.001058
  Params: 440,669

============================================================
Epoch 45/600
============================================================
Epoch 45 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 45 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 45 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 45 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 45 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 45 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 45 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2083 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 45 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.01s | LR: 0.001006
  Params: 440,669

============================================================
Epoch 46/600
============================================================
Epoch 46 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2396 | AccumSteps: 1
Epoch 46 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 46 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 46 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 46 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 46 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 46 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 46 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.03s | LR: 0.000954
  Params: 440,669

============================================================
Epoch 47/600
============================================================
Epoch 47 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 47 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.0938 | AccumSteps: 1
Epoch 47 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 47 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 47 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 47 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0729 | AccumSteps: 1
Epoch 47 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1562 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 47 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 11.95s | LR: 0.000901
  Params: 440,669

============================================================
Epoch 48/600
============================================================
Epoch 48 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 48 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.2292 | AccumSteps: 1
Epoch 48 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1042 | AccumSteps: 1
Epoch 48 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 48 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 48 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 48 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1771 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 48 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.06s | LR: 0.000850
  Params: 440,669

============================================================
Epoch 49/600
============================================================
Epoch 49 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1250 | AccumSteps: 1
Epoch 49 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 49 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 49 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 49 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 49 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 49 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1667 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 49 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.06s | LR: 0.000798
  Params: 440,669

============================================================
Epoch 50/600
============================================================
Epoch 50 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 50 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0938 | AccumSteps: 1
Epoch 50 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1250 | AccumSteps: 1
Epoch 50 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2604 | AccumSteps: 1
Epoch 50 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 50 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 50 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 50 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.04s | LR: 0.000747
  Params: 440,669
  Saved checkpoint: checkpoints/enhanced_hrm_epoch50.pt

============================================================
Epoch 51/600
============================================================
Epoch 51 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1042 | AccumSteps: 1
Epoch 51 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 51 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 51 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1771 | AccumSteps: 1
Epoch 51 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 51 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 51 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1875 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 51 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.08s | LR: 0.000697
  Params: 440,669

============================================================
Epoch 52/600
============================================================
Epoch 52 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1250 | AccumSteps: 1
Epoch 52 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 52 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 52 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 52 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 52 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 52 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1667 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 52 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.04s | LR: 0.000647
  Params: 440,669

============================================================
Epoch 53/600
============================================================
Epoch 53 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 53 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1042 | AccumSteps: 1
Epoch 53 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2500 | AccumSteps: 1
Epoch 53 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 53 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 53 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 53 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1771 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 53 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.06s | LR: 0.000599
  Params: 440,669

============================================================
Epoch 54/600
============================================================
Epoch 54 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 54 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1979 | AccumSteps: 1
Epoch 54 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1250 | AccumSteps: 1
Epoch 54 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 54 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 54 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 54 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0833 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 54 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.08s | LR: 0.000551
  Params: 440,669

============================================================
Epoch 55/600
============================================================
Epoch 55 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1250 | AccumSteps: 1
Epoch 55 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 55 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 55 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 55 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 55 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 55 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1354 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 55 Summary:
  Train - Loss: nan (TopK: 0.0000[0.95], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.00s | LR: 0.000505
  Params: 440,669

============================================================
Epoch 56/600
============================================================
Epoch 56 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 56 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1042 | AccumSteps: 1
Epoch 56 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1979 | AccumSteps: 1
Epoch 56 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 56 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 56 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1250 | AccumSteps: 1
Epoch 56 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1667 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 56 Summary:
  Train - Loss: nan (TopK: 0.0000[0.94], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.06s | LR: 0.000460
  Params: 440,669

============================================================
Epoch 57/600
============================================================
Epoch 57 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2188 | AccumSteps: 1
Epoch 57 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 57 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 57 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 57 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 57 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0625 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 57 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1146 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 57 Summary:
  Train - Loss: nan (TopK: 0.0000[0.94], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 11.98s | LR: 0.000417
  Params: 440,669

============================================================
Epoch 58/600
============================================================
Epoch 58 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 58 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 58 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1562 | AccumSteps: 1
Epoch 58 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 58 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0312 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 58 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.0833 | AccumSteps: 1
Epoch 58 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2188 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 58 Summary:
  Train - Loss: nan (TopK: 0.0000[0.94], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 11.96s | LR: 0.000375
  Params: 440,669

============================================================
Epoch 59/600
============================================================
Epoch 59 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2083 | AccumSteps: 1
Epoch 59 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1458 | AccumSteps: 1
Epoch 59 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0625 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 59 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 59 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 59 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1146 | AccumSteps: 1
Epoch 59 | Batch 70/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.1771 | AccumSteps: 1

Validation Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.1999 (19.99%)
  Acc@10: 0.3445 (34.45%)


Test Results:
  Loss: nan
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.2545 (25.45%)
  Acc@10: 0.3769 (37.69%)

Epoch 59 Summary:
  Train - Loss: nan (TopK: 0.0000[0.94], CE: 0.0000) | Acc@1: 0.0000
  Val   - Loss: nan | Acc@1: 0.0000
  Test  - Loss: nan | Acc@1: 0.0000
  Time: 12.14s | LR: 0.000335
  Params: 440,669

============================================================
Epoch 60/600
============================================================
Epoch 60 | Batch 10/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0208 | Acc@10: 0.2188 | AccumSteps: 1
Epoch 60 | Batch 20/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.1667 | AccumSteps: 1
Epoch 60 | Batch 30/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0417 | Acc@10: 0.2292 | AccumSteps: 1
Epoch 60 | Batch 40/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.1875 | AccumSteps: 1
Epoch 60 | Batch 50/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0104 | Acc@10: 0.1354 | AccumSteps: 1
Epoch 60 | Batch 60/78 | Loss: nan (TopK: nan, CE: nan) | Acc@1: 0.0000 | Acc@5: 0.0521 | Acc@10: 0.2188 | AccumSteps: 1
