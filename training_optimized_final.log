No module named 'torch_sparse'
`torch-sparse` is not installed, which is ok, as long as no sparse modules are used.
Using device: cuda

============================================================
Loading datasets...
============================================================
Loaded 7424 samples from data/geolife/geolife_transformer_7_train.pk
Vocabulary size: 1187 (unique locations: 1156)
Loaded 3334 samples from data/geolife/geolife_transformer_7_validation.pk
Vocabulary size: 1176 (unique locations: 382)
Loaded 3502 samples from data/geolife/geolife_transformer_7_test.pk
Vocabulary size: 1177 (unique locations: 355)
Train: 7424, Val: 3334, Test: 3502

============================================================
Initializing Optimized HRM...
============================================================
Total parameters: 478,843
Hidden size: 96 (50% larger than previous 64)
✓ Within <500K budget!
Parameter allocation optimizations:
  - Shared transformer blocks (no duplication)
  - Single-path attention (not multi-scale)
  - Simple residual (not gated fusion)
  - Compact embeddings
  → Result: 50% more capacity in same budget!

============================================================
Training Optimized HRM...
============================================================


============================================================
Epoch 1/500
============================================================
Epoch 1 | Batch 10/78 | Loss: 3.4918 (TopK: 3.4882, CE: 7.0707) | Acc@1: 0.0000 | Acc@5: 0.0000 | Acc@10: 0.0104
Epoch 1 | Batch 20/78 | Loss: 3.4142 (TopK: 3.4106, CE: 7.0177) | Acc@1: 0.0208 | Acc@5: 0.0833 | Acc@10: 0.1250
Epoch 1 | Batch 30/78 | Loss: 3.3181 (TopK: 3.3145, CE: 6.9516) | Acc@1: 0.0625 | Acc@5: 0.1146 | Acc@10: 0.1458
Epoch 1 | Batch 40/78 | Loss: 3.2950 (TopK: 3.2914, CE: 6.9474) | Acc@1: 0.1562 | Acc@5: 0.1979 | Acc@10: 0.1979
Epoch 1 | Batch 50/78 | Loss: 3.2464 (TopK: 3.2428, CE: 6.9199) | Acc@1: 0.0833 | Acc@5: 0.1979 | Acc@10: 0.2500
Epoch 1 | Batch 60/78 | Loss: 3.2387 (TopK: 3.2350, CE: 6.9331) | Acc@1: 0.0312 | Acc@5: 0.1875 | Acc@10: 0.2083
Epoch 1 | Batch 70/78 | Loss: 3.1906 (TopK: 3.1869, CE: 6.9232) | Acc@1: 0.1042 | Acc@5: 0.2188 | Acc@10: 0.2188

Validation Results:
  Loss: 7.0317
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0006 (0.06%)
  Acc@10: 0.0009 (0.09%)


Test Results:
  Loss: 7.0367
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0000 (0.00%)
  Acc@10: 0.0000 (0.00%)

Epoch 1 Summary:
  Train - Loss: 3.3031 (TopK: 3.2994[1.00], CE: 6.9576) | Acc@1: 0.0620
  Val   - Loss: 7.0317 | Acc@1: 0.0000
  Test  - Loss: 7.0367 | Acc@1: 0.0000
  Time: 8.72s | LR: 0.000050

============================================================
Epoch 2/500
============================================================
Epoch 2 | Batch 10/78 | Loss: 3.0957 (TopK: 3.0881, CE: 6.8781) | Acc@1: 0.0833 | Acc@5: 0.2083 | Acc@10: 0.2604
Epoch 2 | Batch 20/78 | Loss: 3.0350 (TopK: 3.0273, CE: 6.8427) | Acc@1: 0.0938 | Acc@5: 0.2604 | Acc@10: 0.2917
Epoch 2 | Batch 30/78 | Loss: 2.9604 (TopK: 2.9527, CE: 6.7888) | Acc@1: 0.1042 | Acc@5: 0.2292 | Acc@10: 0.2812
Epoch 2 | Batch 40/78 | Loss: 2.9676 (TopK: 2.9599, CE: 6.8081) | Acc@1: 0.1042 | Acc@5: 0.2188 | Acc@10: 0.2604
Epoch 2 | Batch 50/78 | Loss: 2.8057 (TopK: 2.7980, CE: 6.6627) | Acc@1: 0.1667 | Acc@5: 0.3125 | Acc@10: 0.3333
Epoch 2 | Batch 60/78 | Loss: 2.8869 (TopK: 2.8792, CE: 6.7314) | Acc@1: 0.1146 | Acc@5: 0.2812 | Acc@10: 0.3542
Epoch 2 | Batch 70/78 | Loss: 2.8060 (TopK: 2.7983, CE: 6.6573) | Acc@1: 0.1562 | Acc@5: 0.3333 | Acc@10: 0.4167

Validation Results:
  Loss: 7.0095
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0009 (0.09%)
  Acc@10: 0.0012 (0.12%)


Test Results:
  Loss: 7.0161
  Acc@1: 0.0000 (0.00%)
  Acc@5: 0.0000 (0.00%)
  Acc@10: 0.0000 (0.00%)

Epoch 2 Summary:
  Train - Loss: 2.9615 (TopK: 2.9539[1.00], CE: 6.7856) | Acc@1: 0.1051
  Val   - Loss: 7.0095 | Acc@1: 0.0000
  Test  - Loss: 7.0161 | Acc@1: 0.0000
  Time: 7.74s | LR: 0.000100

============================================================
Epoch 3/500
============================================================
Epoch 3 | Batch 10/78 | Loss: 2.9398 (TopK: 2.9282, CE: 6.7734) | Acc@1: 0.0729 | Acc@5: 0.2396 | Acc@10: 0.2812
Epoch 3 | Batch 20/78 | Loss: 2.8776 (TopK: 2.8661, CE: 6.7125) | Acc@1: 0.1250 | Acc@5: 0.2708 | Acc@10: 0.3021
Epoch 3 | Batch 30/78 | Loss: 2.8665 (TopK: 2.8549, CE: 6.6951) | Acc@1: 0.1146 | Acc@5: 0.3125 | Acc@10: 0.3542
Epoch 3 | Batch 40/78 | Loss: 2.8667 (TopK: 2.8552, CE: 6.6861) | Acc@1: 0.1354 | Acc@5: 0.2708 | Acc@10: 0.3125
Epoch 3 | Batch 50/78 | Loss: 2.8479 (TopK: 2.8364, CE: 6.6677) | Acc@1: 0.0833 | Acc@5: 0.3229 | Acc@10: 0.3646
Epoch 3 | Batch 60/78 | Loss: 2.8722 (TopK: 2.8608, CE: 6.6786) | Acc@1: 0.1250 | Acc@5: 0.3021 | Acc@10: 0.3958
Epoch 3 | Batch 70/78 | Loss: 2.8649 (TopK: 2.8535, CE: 6.6527) | Acc@1: 0.1562 | Acc@5: 0.2812 | Acc@10: 0.3750

Validation Results:
  Loss: 6.9860
  Acc@1: 0.0466 (4.66%)
  Acc@5: 0.1265 (12.65%)
  Acc@10: 0.1961 (19.61%)


Test Results:
  Loss: 6.9955
  Acc@1: 0.0453 (4.53%)
  Acc@5: 0.1130 (11.30%)
  Acc@10: 0.1763 (17.63%)

Epoch 3 Summary:
  Train - Loss: 2.8719 (TopK: 2.8604[1.00], CE: 6.6923) | Acc@1: 0.1149
  Val   - Loss: 6.9860 | Acc@1: 0.0466
  Test  - Loss: 6.9955 | Acc@1: 0.0453
  Time: 7.82s | LR: 0.000150
  Saved checkpoint
  ✅ New best validation: 4.66%
  ✅ New best test: 4.53%

============================================================
Epoch 4/500
============================================================
Epoch 4 | Batch 10/78 | Loss: 2.6245 (TopK: 2.6091, CE: 6.4513) | Acc@1: 0.2396 | Acc@5: 0.3958 | Acc@10: 0.4896
Epoch 4 | Batch 20/78 | Loss: 2.5982 (TopK: 2.5828, CE: 6.4264) | Acc@1: 0.2500 | Acc@5: 0.4167 | Acc@10: 0.4688
Epoch 4 | Batch 30/78 | Loss: 2.7965 (TopK: 2.7812, CE: 6.6026) | Acc@1: 0.1562 | Acc@5: 0.3542 | Acc@10: 0.4271
Epoch 4 | Batch 40/78 | Loss: 2.8323 (TopK: 2.8170, CE: 6.6381) | Acc@1: 0.1562 | Acc@5: 0.2500 | Acc@10: 0.3333
Epoch 4 | Batch 50/78 | Loss: 2.5586 (TopK: 2.5431, CE: 6.4019) | Acc@1: 0.2604 | Acc@5: 0.4062 | Acc@10: 0.4792
Epoch 4 | Batch 60/78 | Loss: 2.7358 (TopK: 2.7205, CE: 6.5550) | Acc@1: 0.1771 | Acc@5: 0.4271 | Acc@10: 0.5208
Epoch 4 | Batch 70/78 | Loss: 2.6576 (TopK: 2.6423, CE: 6.4668) | Acc@1: 0.2083 | Acc@5: 0.4062 | Acc@10: 0.4792

Validation Results:
  Loss: 6.9677
  Acc@1: 0.1113 (11.13%)
  Acc@5: 0.1994 (19.94%)
  Acc@10: 0.2024 (20.24%)


Test Results:
  Loss: 6.9814
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.1797 (17.97%)
  Acc@10: 0.1797 (17.97%)

Epoch 4 Summary:
  Train - Loss: 2.7421 (TopK: 2.7268[1.00], CE: 6.5552) | Acc@1: 0.1839
  Val   - Loss: 6.9677 | Acc@1: 0.1113
  Test  - Loss: 6.9814 | Acc@1: 0.0935
  Time: 7.74s | LR: 0.000200
  Saved checkpoint
  ✅ New best validation: 11.13%
  ✅ New best test: 9.35%

============================================================
Epoch 5/500
============================================================
Epoch 5 | Batch 10/78 | Loss: 2.7609 (TopK: 2.7419, CE: 6.5428) | Acc@1: 0.1771 | Acc@5: 0.3646 | Acc@10: 0.4479
Epoch 5 | Batch 20/78 | Loss: 2.7450 (TopK: 2.7260, CE: 6.5280) | Acc@1: 0.1875 | Acc@5: 0.3750 | Acc@10: 0.4167
Epoch 5 | Batch 30/78 | Loss: 2.6724 (TopK: 2.6536, CE: 6.4309) | Acc@1: 0.1979 | Acc@5: 0.4583 | Acc@10: 0.5417
Epoch 5 | Batch 40/78 | Loss: 2.5733 (TopK: 2.5544, CE: 6.3222) | Acc@1: 0.2083 | Acc@5: 0.5104 | Acc@10: 0.5625
Epoch 5 | Batch 50/78 | Loss: 2.7109 (TopK: 2.6920, CE: 6.4687) | Acc@1: 0.1771 | Acc@5: 0.4375 | Acc@10: 0.5417
Epoch 5 | Batch 60/78 | Loss: 2.6167 (TopK: 2.5980, CE: 6.3446) | Acc@1: 0.2188 | Acc@5: 0.4271 | Acc@10: 0.4688
Epoch 5 | Batch 70/78 | Loss: 2.5867 (TopK: 2.5679, CE: 6.3232) | Acc@1: 0.2500 | Acc@5: 0.3438 | Acc@10: 0.3958

Validation Results:
  Loss: 6.9566
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2018 (20.18%)
  Acc@10: 0.2021 (20.21%)


Test Results:
  Loss: 6.9747
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.1797 (17.97%)
  Acc@10: 0.1800 (18.00%)

Epoch 5 Summary:
  Train - Loss: 2.6535 (TopK: 2.6346[0.99], CE: 6.4162) | Acc@1: 0.2049
  Val   - Loss: 6.9566 | Acc@1: 0.1131
  Test  - Loss: 6.9747 | Acc@1: 0.0935
  Time: 7.83s | LR: 0.000250
  Saved checkpoint
  ✅ New best validation: 11.31%

============================================================
Epoch 6/500
============================================================
Epoch 6 | Batch 10/78 | Loss: 2.3589 (TopK: 2.3364, CE: 6.0895) | Acc@1: 0.2708 | Acc@5: 0.5208 | Acc@10: 0.5729
Epoch 6 | Batch 20/78 | Loss: 2.6237 (TopK: 2.6013, CE: 6.3445) | Acc@1: 0.1875 | Acc@5: 0.3542 | Acc@10: 0.4583
Epoch 6 | Batch 30/78 | Loss: 2.3405 (TopK: 2.3185, CE: 5.9867) | Acc@1: 0.2708 | Acc@5: 0.5000 | Acc@10: 0.5521
Epoch 6 | Batch 40/78 | Loss: 2.2776 (TopK: 2.2554, CE: 5.9661) | Acc@1: 0.2604 | Acc@5: 0.5521 | Acc@10: 0.6354
Epoch 6 | Batch 50/78 | Loss: 2.4745 (TopK: 2.4524, CE: 6.1424) | Acc@1: 0.2188 | Acc@5: 0.4062 | Acc@10: 0.4479
Epoch 6 | Batch 60/78 | Loss: 2.3827 (TopK: 2.3608, CE: 6.0151) | Acc@1: 0.2604 | Acc@5: 0.4792 | Acc@10: 0.5417
Epoch 6 | Batch 70/78 | Loss: 2.5148 (TopK: 2.4926, CE: 6.1900) | Acc@1: 0.1771 | Acc@5: 0.4271 | Acc@10: 0.5000

Validation Results:
  Loss: 6.9521
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2018 (20.18%)
  Acc@10: 0.2021 (20.21%)


Test Results:
  Loss: 6.9746
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.1797 (17.97%)
  Acc@10: 0.1800 (18.00%)

Epoch 6 Summary:
  Train - Loss: 2.5014 (TopK: 2.4792[0.99], CE: 6.1819) | Acc@1: 0.2198
  Val   - Loss: 6.9521 | Acc@1: 0.1131
  Test  - Loss: 6.9746 | Acc@1: 0.0935
  Time: 7.87s | LR: 0.000300

============================================================
Epoch 7/500
============================================================
Epoch 7 | Batch 10/78 | Loss: 2.6738 (TopK: 2.6482, CE: 6.3043) | Acc@1: 0.1458 | Acc@5: 0.4167 | Acc@10: 0.5000
Epoch 7 | Batch 20/78 | Loss: 2.4018 (TopK: 2.3766, CE: 5.9657) | Acc@1: 0.1979 | Acc@5: 0.4896 | Acc@10: 0.5417
Epoch 7 | Batch 30/78 | Loss: 2.4820 (TopK: 2.4569, CE: 6.0400) | Acc@1: 0.1771 | Acc@5: 0.4375 | Acc@10: 0.4688
Epoch 7 | Batch 40/78 | Loss: 2.5421 (TopK: 2.5169, CE: 6.1242) | Acc@1: 0.1771 | Acc@5: 0.4271 | Acc@10: 0.5312
Epoch 7 | Batch 50/78 | Loss: 2.4115 (TopK: 2.3871, CE: 5.8691) | Acc@1: 0.2188 | Acc@5: 0.5208 | Acc@10: 0.5938
Epoch 7 | Batch 60/78 | Loss: 2.3504 (TopK: 2.3261, CE: 5.8087) | Acc@1: 0.2396 | Acc@5: 0.4688 | Acc@10: 0.5625
Epoch 7 | Batch 70/78 | Loss: 2.3253 (TopK: 2.3009, CE: 5.7921) | Acc@1: 0.3021 | Acc@5: 0.4896 | Acc@10: 0.5417

Validation Results:
  Loss: 6.9543
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2018 (20.18%)
  Acc@10: 0.2428 (24.28%)


Test Results:
  Loss: 6.9825
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.1797 (17.97%)
  Acc@10: 0.2019 (20.19%)

Epoch 7 Summary:
  Train - Loss: 2.4489 (TopK: 2.4240[0.99], CE: 5.9795) | Acc@1: 0.2212
  Val   - Loss: 6.9543 | Acc@1: 0.1131
  Test  - Loss: 6.9825 | Acc@1: 0.0935
  Time: 7.83s | LR: 0.000350

============================================================
Epoch 8/500
============================================================
Epoch 8 | Batch 10/78 | Loss: 2.5261 (TopK: 2.4983, CE: 5.9736) | Acc@1: 0.1771 | Acc@5: 0.4688 | Acc@10: 0.5833
Epoch 8 | Batch 20/78 | Loss: 2.6412 (TopK: 2.6129, CE: 6.1520) | Acc@1: 0.1667 | Acc@5: 0.4062 | Acc@10: 0.4792
Epoch 8 | Batch 30/78 | Loss: 2.7414 (TopK: 2.7130, CE: 6.2640) | Acc@1: 0.1979 | Acc@5: 0.3646 | Acc@10: 0.4896
Epoch 8 | Batch 40/78 | Loss: 2.3821 (TopK: 2.3553, CE: 5.7053) | Acc@1: 0.2396 | Acc@5: 0.4688 | Acc@10: 0.5833
Epoch 8 | Batch 50/78 | Loss: 2.6573 (TopK: 2.6292, CE: 6.1363) | Acc@1: 0.1771 | Acc@5: 0.3958 | Acc@10: 0.4479
Epoch 8 | Batch 60/78 | Loss: 2.2647 (TopK: 2.2379, CE: 5.5946) | Acc@1: 0.2604 | Acc@5: 0.5521 | Acc@10: 0.6250
Epoch 8 | Batch 70/78 | Loss: 2.2568 (TopK: 2.2303, CE: 5.5339) | Acc@1: 0.2604 | Acc@5: 0.5729 | Acc@10: 0.6771

Validation Results:
  Loss: 6.9621
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2306 (23.06%)
  Acc@10: 0.2711 (27.11%)


Test Results:
  Loss: 6.9976
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.1943 (19.43%)
  Acc@10: 0.2340 (23.40%)

Epoch 8 Summary:
  Train - Loss: 2.4163 (TopK: 2.3890[0.99], CE: 5.8043) | Acc@1: 0.2338
  Val   - Loss: 6.9621 | Acc@1: 0.1131
  Test  - Loss: 6.9976 | Acc@1: 0.0935
  Time: 7.90s | LR: 0.000400

============================================================
Epoch 9/500
============================================================
Epoch 9 | Batch 10/78 | Loss: 2.3179 (TopK: 2.2877, CE: 5.6407) | Acc@1: 0.2396 | Acc@5: 0.5104 | Acc@10: 0.5938
Epoch 9 | Batch 20/78 | Loss: 2.2222 (TopK: 2.1932, CE: 5.4175) | Acc@1: 0.2917 | Acc@5: 0.5729 | Acc@10: 0.6042
Epoch 9 | Batch 30/78 | Loss: 2.3839 (TopK: 2.3541, CE: 5.6679) | Acc@1: 0.2500 | Acc@5: 0.4896 | Acc@10: 0.5208
Epoch 9 | Batch 40/78 | Loss: 2.1725 (TopK: 2.1437, CE: 5.3408) | Acc@1: 0.2917 | Acc@5: 0.6146 | Acc@10: 0.6771
Epoch 9 | Batch 50/78 | Loss: 2.2393 (TopK: 2.2107, CE: 5.3906) | Acc@1: 0.2188 | Acc@5: 0.5417 | Acc@10: 0.5938
Epoch 9 | Batch 60/78 | Loss: 2.2477 (TopK: 2.2190, CE: 5.4133) | Acc@1: 0.2708 | Acc@5: 0.5208 | Acc@10: 0.5312
Epoch 9 | Batch 70/78 | Loss: 2.3304 (TopK: 2.3014, CE: 5.5231) | Acc@1: 0.2396 | Acc@5: 0.5104 | Acc@10: 0.5521

Validation Results:
  Loss: 6.9748
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2720 (27.20%)
  Acc@10: 0.2765 (27.65%)


Test Results:
  Loss: 7.0188
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2298 (22.98%)
  Acc@10: 0.2591 (25.91%)

Epoch 9 Summary:
  Train - Loss: 2.3536 (TopK: 2.3241[0.99], CE: 5.5984) | Acc@1: 0.2320
  Val   - Loss: 6.9748 | Acc@1: 0.1131
  Test  - Loss: 7.0188 | Acc@1: 0.0935
  Time: 7.83s | LR: 0.000450

============================================================
Epoch 10/500
============================================================
Epoch 10 | Batch 10/78 | Loss: 2.2652 (TopK: 2.2337, CE: 5.3874) | Acc@1: 0.2917 | Acc@5: 0.5104 | Acc@10: 0.5417
Epoch 10 | Batch 20/78 | Loss: 2.3942 (TopK: 2.3611, CE: 5.6713) | Acc@1: 0.2292 | Acc@5: 0.4896 | Acc@10: 0.5729
Epoch 10 | Batch 30/78 | Loss: 2.3301 (TopK: 2.2984, CE: 5.4716) | Acc@1: 0.2083 | Acc@5: 0.5521 | Acc@10: 0.6146
Epoch 10 | Batch 40/78 | Loss: 2.0878 (TopK: 2.0582, CE: 5.0186) | Acc@1: 0.2917 | Acc@5: 0.5833 | Acc@10: 0.6562
Epoch 10 | Batch 50/78 | Loss: 2.1865 (TopK: 2.1551, CE: 5.2899) | Acc@1: 0.3333 | Acc@5: 0.5417 | Acc@10: 0.5833
Epoch 10 | Batch 60/78 | Loss: 2.3259 (TopK: 2.2950, CE: 5.3797) | Acc@1: 0.2500 | Acc@5: 0.5312 | Acc@10: 0.5938
Epoch 10 | Batch 70/78 | Loss: 2.3997 (TopK: 2.3677, CE: 5.5678) | Acc@1: 0.2396 | Acc@5: 0.5104 | Acc@10: 0.6146

Validation Results:
  Loss: 6.9893
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2747 (27.47%)
  Acc@10: 0.2774 (27.74%)


Test Results:
  Loss: 7.0419
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2574 (25.74%)
  Acc@10: 0.2670 (26.70%)

Epoch 10 Summary:
  Train - Loss: 2.3037 (TopK: 2.2723[0.99], CE: 5.4034) | Acc@1: 0.2435
  Val   - Loss: 6.9893 | Acc@1: 0.1131
  Test  - Loss: 7.0419 | Acc@1: 0.0935
  Time: 7.78s | LR: 0.000500
  Saved checkpoint

============================================================
Epoch 11/500
============================================================
Epoch 11 | Batch 10/78 | Loss: 2.3223 (TopK: 2.2874, CE: 5.4633) | Acc@1: 0.2604 | Acc@5: 0.5208 | Acc@10: 0.5729
Epoch 11 | Batch 20/78 | Loss: 2.2721 (TopK: 2.2380, CE: 5.3417) | Acc@1: 0.2604 | Acc@5: 0.5521 | Acc@10: 0.6042
Epoch 11 | Batch 30/78 | Loss: 2.2391 (TopK: 2.2070, CE: 5.1246) | Acc@1: 0.2812 | Acc@5: 0.5625 | Acc@10: 0.6562
Epoch 11 | Batch 40/78 | Loss: 2.2061 (TopK: 2.1734, CE: 5.1438) | Acc@1: 0.2917 | Acc@5: 0.5417 | Acc@10: 0.5938
Epoch 11 | Batch 50/78 | Loss: 2.3330 (TopK: 2.3005, CE: 5.2604) | Acc@1: 0.2292 | Acc@5: 0.5000 | Acc@10: 0.5938
Epoch 11 | Batch 60/78 | Loss: 2.1279 (TopK: 2.0964, CE: 4.9619) | Acc@1: 0.3438 | Acc@5: 0.5833 | Acc@10: 0.6250
Epoch 11 | Batch 70/78 | Loss: 2.4714 (TopK: 2.4379, CE: 5.4802) | Acc@1: 0.2083 | Acc@5: 0.5417 | Acc@10: 0.6042

Validation Results:
  Loss: 7.0042
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2759 (27.59%)
  Acc@10: 0.3071 (30.71%)


Test Results:
  Loss: 7.0658
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2619 (26.19%)
  Acc@10: 0.2972 (29.72%)

Epoch 11 Summary:
  Train - Loss: 2.2587 (TopK: 2.2258[0.99], CE: 5.2250) | Acc@1: 0.2618
  Val   - Loss: 7.0042 | Acc@1: 0.1131
  Test  - Loss: 7.0658 | Acc@1: 0.0935
  Time: 7.84s | LR: 0.000550

============================================================
Epoch 12/500
============================================================
Epoch 12 | Batch 10/78 | Loss: 2.2203 (TopK: 2.1830, CE: 5.2883) | Acc@1: 0.3021 | Acc@5: 0.6250 | Acc@10: 0.7188
Epoch 12 | Batch 20/78 | Loss: 1.9528 (TopK: 1.9202, CE: 4.6339) | Acc@1: 0.3125 | Acc@5: 0.6771 | Acc@10: 0.7188
Epoch 12 | Batch 30/78 | Loss: 2.6259 (TopK: 2.5884, CE: 5.7149) | Acc@1: 0.1771 | Acc@5: 0.4167 | Acc@10: 0.4792
Epoch 12 | Batch 40/78 | Loss: 2.0997 (TopK: 2.0668, CE: 4.8080) | Acc@1: 0.3438 | Acc@5: 0.5833 | Acc@10: 0.6250
Epoch 12 | Batch 50/78 | Loss: 2.1098 (TopK: 2.0777, CE: 4.7510) | Acc@1: 0.3750 | Acc@5: 0.5938 | Acc@10: 0.6562
Epoch 12 | Batch 60/78 | Loss: 2.0434 (TopK: 2.0105, CE: 4.7528) | Acc@1: 0.2812 | Acc@5: 0.6250 | Acc@10: 0.6354
Epoch 12 | Batch 70/78 | Loss: 2.0500 (TopK: 2.0156, CE: 4.8834) | Acc@1: 0.3438 | Acc@5: 0.6146 | Acc@10: 0.6562

Validation Results:
  Loss: 7.0184
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.3053 (30.53%)
  Acc@10: 0.3104 (31.04%)


Test Results:
  Loss: 7.0887
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2778 (27.78%)
  Acc@10: 0.2992 (29.92%)

Epoch 12 Summary:
  Train - Loss: 2.1721 (TopK: 2.1378[0.99], CE: 5.0011) | Acc@1: 0.2882
  Val   - Loss: 7.0184 | Acc@1: 0.1131
  Test  - Loss: 7.0887 | Acc@1: 0.0935
  Time: 7.75s | LR: 0.000600

============================================================
Epoch 13/500
============================================================
Epoch 13 | Batch 10/78 | Loss: 2.1087 (TopK: 2.0709, CE: 4.9773) | Acc@1: 0.2188 | Acc@5: 0.6250 | Acc@10: 0.6562
Epoch 13 | Batch 20/78 | Loss: 2.3003 (TopK: 2.2626, CE: 5.1618) | Acc@1: 0.3125 | Acc@5: 0.5208 | Acc@10: 0.5521
Epoch 13 | Batch 30/78 | Loss: 1.9295 (TopK: 1.8951, CE: 4.5388) | Acc@1: 0.3333 | Acc@5: 0.6458 | Acc@10: 0.6771
Epoch 13 | Batch 40/78 | Loss: 1.9612 (TopK: 1.9261, CE: 4.6246) | Acc@1: 0.3021 | Acc@5: 0.6250 | Acc@10: 0.6458
Epoch 13 | Batch 50/78 | Loss: 1.8586 (TopK: 1.8274, CE: 4.2224) | Acc@1: 0.3958 | Acc@5: 0.6354 | Acc@10: 0.7188
Epoch 13 | Batch 60/78 | Loss: 2.1292 (TopK: 2.0932, CE: 4.8595) | Acc@1: 0.3021 | Acc@5: 0.5938 | Acc@10: 0.6562
Epoch 13 | Batch 70/78 | Loss: 1.7479 (TopK: 1.7168, CE: 4.1080) | Acc@1: 0.4062 | Acc@5: 0.6979 | Acc@10: 0.7500

Validation Results:
  Loss: 7.0305
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.3042 (30.42%)
  Acc@10: 0.3208 (32.08%)


Test Results:
  Loss: 7.1091
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2778 (27.78%)
  Acc@10: 0.3056 (30.56%)

Epoch 13 Summary:
  Train - Loss: 2.0842 (TopK: 2.0486[0.99], CE: 4.7869) | Acc@1: 0.3009
  Val   - Loss: 7.0305 | Acc@1: 0.1131
  Test  - Loss: 7.1091 | Acc@1: 0.0935
  Time: 7.78s | LR: 0.000650

============================================================
Epoch 14/500
============================================================
Epoch 14 | Batch 10/78 | Loss: 1.9790 (TopK: 1.9416, CE: 4.6100) | Acc@1: 0.3542 | Acc@5: 0.6146 | Acc@10: 0.6667
Epoch 14 | Batch 20/78 | Loss: 2.0845 (TopK: 2.0481, CE: 4.6478) | Acc@1: 0.3646 | Acc@5: 0.5521 | Acc@10: 0.6042
Epoch 14 | Batch 30/78 | Loss: 2.0937 (TopK: 2.0583, CE: 4.5876) | Acc@1: 0.2396 | Acc@5: 0.5938 | Acc@10: 0.6771
Epoch 14 | Batch 40/78 | Loss: 2.2179 (TopK: 2.1801, CE: 4.8792) | Acc@1: 0.2708 | Acc@5: 0.5104 | Acc@10: 0.5521
Epoch 14 | Batch 50/78 | Loss: 2.0371 (TopK: 2.0011, CE: 4.5688) | Acc@1: 0.3542 | Acc@5: 0.5729 | Acc@10: 0.6458
Epoch 14 | Batch 60/78 | Loss: 2.0800 (TopK: 2.0420, CE: 4.7544) | Acc@1: 0.3021 | Acc@5: 0.5833 | Acc@10: 0.6667
Epoch 14 | Batch 70/78 | Loss: 2.0403 (TopK: 2.0062, CE: 4.4473) | Acc@1: 0.3750 | Acc@5: 0.5729 | Acc@10: 0.6354

Validation Results:
  Loss: 7.0378
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2967 (29.67%)
  Acc@10: 0.3274 (32.74%)


Test Results:
  Loss: 7.1234
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2719 (27.19%)
  Acc@10: 0.2995 (29.95%)

Epoch 14 Summary:
  Train - Loss: 2.0522 (TopK: 2.0156[0.99], CE: 4.6293) | Acc@1: 0.3138
  Val   - Loss: 7.0378 | Acc@1: 0.1131
  Test  - Loss: 7.1234 | Acc@1: 0.0935
  Time: 7.79s | LR: 0.000700

============================================================
Epoch 15/500
============================================================
Epoch 15 | Batch 10/78 | Loss: 2.1071 (TopK: 2.0665, CE: 4.7721) | Acc@1: 0.2604 | Acc@5: 0.5417 | Acc@10: 0.6250
Epoch 15 | Batch 20/78 | Loss: 1.9705 (TopK: 1.9326, CE: 4.4623) | Acc@1: 0.3125 | Acc@5: 0.6146 | Acc@10: 0.6667
Epoch 15 | Batch 30/78 | Loss: 1.9652 (TopK: 1.9279, CE: 4.4182) | Acc@1: 0.3021 | Acc@5: 0.6250 | Acc@10: 0.6667
Epoch 15 | Batch 40/78 | Loss: 2.0186 (TopK: 1.9806, CE: 4.5097) | Acc@1: 0.2500 | Acc@5: 0.6354 | Acc@10: 0.6771
Epoch 15 | Batch 50/78 | Loss: 2.0428 (TopK: 2.0053, CE: 4.5024) | Acc@1: 0.2708 | Acc@5: 0.5833 | Acc@10: 0.6354
Epoch 15 | Batch 60/78 | Loss: 1.9374 (TopK: 1.9007, CE: 4.3492) | Acc@1: 0.3333 | Acc@5: 0.6667 | Acc@10: 0.6875
Epoch 15 | Batch 70/78 | Loss: 1.9490 (TopK: 1.9116, CE: 4.4041) | Acc@1: 0.2708 | Acc@5: 0.6354 | Acc@10: 0.6667

Validation Results:
  Loss: 7.0402
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2914 (29.14%)
  Acc@10: 0.3227 (32.27%)


Test Results:
  Loss: 7.1315
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2736 (27.36%)
  Acc@10: 0.2964 (29.64%)

Epoch 15 Summary:
  Train - Loss: 2.0145 (TopK: 1.9768[0.98], CE: 4.4917) | Acc@1: 0.3132
  Val   - Loss: 7.0402 | Acc@1: 0.1131
  Test  - Loss: 7.1315 | Acc@1: 0.0935
  Time: 7.77s | LR: 0.000750

============================================================
Epoch 16/500
============================================================
Epoch 16 | Batch 10/78 | Loss: 2.0201 (TopK: 1.9807, CE: 4.4406) | Acc@1: 0.2812 | Acc@5: 0.6354 | Acc@10: 0.6979
Epoch 16 | Batch 20/78 | Loss: 1.9403 (TopK: 1.9019, CE: 4.2995) | Acc@1: 0.2917 | Acc@5: 0.6354 | Acc@10: 0.6979
Epoch 16 | Batch 30/78 | Loss: 1.8408 (TopK: 1.8041, CE: 4.0961) | Acc@1: 0.3125 | Acc@5: 0.6458 | Acc@10: 0.7083
Epoch 16 | Batch 40/78 | Loss: 2.1787 (TopK: 2.1367, CE: 4.7625) | Acc@1: 0.2500 | Acc@5: 0.5729 | Acc@10: 0.6250
Epoch 16 | Batch 50/78 | Loss: 2.0324 (TopK: 1.9920, CE: 4.5114) | Acc@1: 0.3333 | Acc@5: 0.5729 | Acc@10: 0.6354
Epoch 16 | Batch 60/78 | Loss: 2.0477 (TopK: 2.0095, CE: 4.4001) | Acc@1: 0.3125 | Acc@5: 0.6042 | Acc@10: 0.6458
Epoch 16 | Batch 70/78 | Loss: 2.0335 (TopK: 1.9939, CE: 4.4713) | Acc@1: 0.3646 | Acc@5: 0.6042 | Acc@10: 0.6146

Validation Results:
  Loss: 7.0370
  Acc@1: 0.1131 (11.31%)
  Acc@5: 0.2849 (28.49%)
  Acc@10: 0.3153 (31.53%)


Test Results:
  Loss: 7.1332
  Acc@1: 0.0935 (9.35%)
  Acc@5: 0.2699 (26.99%)
  Acc@10: 0.2888 (28.88%)

Epoch 16 Summary:
  Train - Loss: 1.9721 (TopK: 1.9334[0.98], CE: 4.3518) | Acc@1: 0.3180
  Val   - Loss: 7.0370 | Acc@1: 0.1131
  Test  - Loss: 7.1332 | Acc@1: 0.0935
  Time: 7.84s | LR: 0.000800

============================================================
Epoch 17/500
============================================================
Epoch 17 | Batch 10/78 | Loss: 2.0846 (TopK: 2.0421, CE: 4.5459) | Acc@1: 0.2917 | Acc@5: 0.5833 | Acc@10: 0.6354
Epoch 17 | Batch 20/78 | Loss: 2.0300 (TopK: 1.9893, CE: 4.3835) | Acc@1: 0.3646 | Acc@5: 0.6146 | Acc@10: 0.6875
Epoch 17 | Batch 30/78 | Loss: 1.8274 (TopK: 1.7891, CE: 4.0383) | Acc@1: 0.3542 | Acc@5: 0.6667 | Acc@10: 0.6875
Epoch 17 | Batch 40/78 | Loss: 1.9177 (TopK: 1.8775, CE: 4.2407) | Acc@1: 0.3750 | Acc@5: 0.6250 | Acc@10: 0.6562
Epoch 17 | Batch 50/78 | Loss: 1.8356 (TopK: 1.7970, CE: 4.0631) | Acc@1: 0.3229 | Acc@5: 0.6458 | Acc@10: 0.6875
Epoch 17 | Batch 60/78 | Loss: 2.1239 (TopK: 2.0799, CE: 4.6725) | Acc@1: 0.2812 | Acc@5: 0.5625 | Acc@10: 0.5938
Epoch 17 | Batch 70/78 | Loss: 1.8850 (TopK: 1.8449, CE: 4.2005) | Acc@1: 0.3646 | Acc@5: 0.6354 | Acc@10: 0.6667

Validation Results:
  Loss: 7.0321
  Acc@1: 0.1160 (11.60%)
  Acc@5: 0.2796 (27.96%)
  Acc@10: 0.3028 (30.28%)


Test Results:
  Loss: 7.1304
  Acc@1: 0.0961 (9.61%)
  Acc@5: 0.2649 (26.49%)
  Acc@10: 0.2759 (27.59%)

Epoch 17 Summary:
  Train - Loss: 1.9318 (TopK: 1.8921[0.98], CE: 4.2285) | Acc@1: 0.3369
  Val   - Loss: 7.0321 | Acc@1: 0.1160
  Test  - Loss: 7.1304 | Acc@1: 0.0961
  Time: 7.82s | LR: 0.000850
  Saved checkpoint
  ✅ New best validation: 11.60%
  ✅ New best test: 9.61%

============================================================
Epoch 18/500
