Using device: cuda
GPU: NVIDIA L4

============================================================
Loading datasets...
============================================================
Loaded 7424 samples from data/geolife/geolife_transformer_7_train.pk
Vocabulary size: 1187 (unique locations: 1156)
Loaded 3334 samples from data/geolife/geolife_transformer_7_validation.pk
Vocabulary size: 1176 (unique locations: 382)
Loaded 3502 samples from data/geolife/geolife_transformer_7_test.pk
Vocabulary size: 1177 (unique locations: 355)
Train samples: 7424
Val samples: 3334
Test samples: 3502

============================================================
Initializing model...
============================================================
Total parameters: 998,496
Trainable parameters: 998,240

============================================================
Starting training...
============================================================


============================================================
Epoch 1/150
============================================================
Epoch 1 | Batch 10/29 | Loss: 7.3207 | Acc@1: 0.0039 | Acc@5: 0.0195 | Acc@10: 0.0195
Epoch 1 | Batch 20/29 | Loss: 7.2869 | Acc@1: 0.0039 | Acc@5: 0.0117 | Acc@10: 0.0156

Validation Results:
  Loss: 7.0114
  Acc@1: 0.0042 (0.42%)
  Acc@5: 0.0435 (4.35%)
  Acc@10: 0.0812 (8.12%)


Test Results:
  Loss: 7.0137
  Acc@1: 0.0025 (0.25%)
  Acc@5: 0.0394 (3.94%)
  Acc@10: 0.0686 (6.86%)

Epoch 1 Summary:
  Train - Loss: 7.3514 | Acc@1: 0.0031
  Val   - Loss: 7.0114 | Acc@1: 0.0042
  Test  - Loss: 7.0137 | Acc@1: 0.0025
  Time: 16.50s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch1.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 2/150
============================================================
Epoch 2 | Batch 10/29 | Loss: 7.0380 | Acc@1: 0.0195 | Acc@5: 0.0625 | Acc@10: 0.0859
Epoch 2 | Batch 20/29 | Loss: 6.8413 | Acc@1: 0.0430 | Acc@5: 0.1211 | Acc@10: 0.1484

Validation Results:
  Loss: 6.5835
  Acc@1: 0.1398 (13.98%)
  Acc@5: 0.1735 (17.35%)
  Acc@10: 0.1853 (18.53%)


Test Results:
  Loss: 6.6079
  Acc@1: 0.1246 (12.46%)
  Acc@5: 0.1578 (15.78%)
  Acc@10: 0.1702 (17.02%)

Epoch 2 Summary:
  Train - Loss: 6.8908 | Acc@1: 0.0404
  Val   - Loss: 6.5835 | Acc@1: 0.1398
  Test  - Loss: 6.6079 | Acc@1: 0.1246
  Time: 15.51s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch2.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 3/150
============================================================
Epoch 3 | Batch 10/29 | Loss: 6.5523 | Acc@1: 0.1055 | Acc@5: 0.1914 | Acc@10: 0.2148
Epoch 3 | Batch 20/29 | Loss: 6.5958 | Acc@1: 0.1289 | Acc@5: 0.1875 | Acc@10: 0.1992

Validation Results:
  Loss: 6.3631
  Acc@1: 0.1376 (13.76%)
  Acc@5: 0.1830 (18.30%)
  Acc@10: 0.1964 (19.64%)


Test Results:
  Loss: 6.4106
  Acc@1: 0.1328 (13.28%)
  Acc@5: 0.1682 (16.82%)
  Acc@10: 0.1766 (17.66%)

Epoch 3 Summary:
  Train - Loss: 6.5831 | Acc@1: 0.1207
  Val   - Loss: 6.3631 | Acc@1: 0.1376
  Test  - Loss: 6.4106 | Acc@1: 0.1328
  Time: 15.52s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 4/150
============================================================
Epoch 4 | Batch 10/29 | Loss: 6.2576 | Acc@1: 0.1641 | Acc@5: 0.2383 | Acc@10: 0.2617
Epoch 4 | Batch 20/29 | Loss: 6.3753 | Acc@1: 0.1406 | Acc@5: 0.2266 | Acc@10: 0.2422

Validation Results:
  Loss: 6.2172
  Acc@1: 0.1367 (13.67%)
  Acc@5: 0.1903 (19.03%)
  Acc@10: 0.2065 (20.65%)


Test Results:
  Loss: 6.2906
  Acc@1: 0.1345 (13.45%)
  Acc@5: 0.1758 (17.58%)
  Acc@10: 0.1887 (18.87%)

Epoch 4 Summary:
  Train - Loss: 6.3289 | Acc@1: 0.1533
  Val   - Loss: 6.2172 | Acc@1: 0.1367
  Test  - Loss: 6.2906 | Acc@1: 0.1345
  Time: 15.54s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 5/150
============================================================
Epoch 5 | Batch 10/29 | Loss: 6.3329 | Acc@1: 0.1289 | Acc@5: 0.2031 | Acc@10: 0.2344
Epoch 5 | Batch 20/29 | Loss: 6.1302 | Acc@1: 0.1562 | Acc@5: 0.2266 | Acc@10: 0.2539

Validation Results:
  Loss: 6.1111
  Acc@1: 0.1281 (12.81%)
  Acc@5: 0.1981 (19.81%)
  Acc@10: 0.2171 (21.71%)


Test Results:
  Loss: 6.2065
  Acc@1: 0.1284 (12.84%)
  Acc@5: 0.1865 (18.65%)
  Acc@10: 0.2011 (20.11%)

Epoch 5 Summary:
  Train - Loss: 6.1347 | Acc@1: 0.1654
  Val   - Loss: 6.1111 | Acc@1: 0.1281
  Test  - Loss: 6.2065 | Acc@1: 0.1284
  Time: 14.72s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch5.pt

============================================================
Epoch 6/150
============================================================
Epoch 6 | Batch 10/29 | Loss: 6.1229 | Acc@1: 0.1562 | Acc@5: 0.2422 | Acc@10: 0.3047
Epoch 6 | Batch 20/29 | Loss: 5.8438 | Acc@1: 0.1875 | Acc@5: 0.3008 | Acc@10: 0.3477

Validation Results:
  Loss: 6.0223
  Acc@1: 0.1401 (14.01%)
  Acc@5: 0.2299 (22.99%)
  Acc@10: 0.2673 (26.73%)


Test Results:
  Loss: 6.1424
  Acc@1: 0.1357 (13.57%)
  Acc@5: 0.2058 (20.58%)
  Acc@10: 0.2348 (23.48%)

Epoch 6 Summary:
  Train - Loss: 5.9919 | Acc@1: 0.1713
  Val   - Loss: 6.0223 | Acc@1: 0.1401
  Test  - Loss: 6.1424 | Acc@1: 0.1357
  Time: 15.49s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch6.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 7/150
============================================================
Epoch 7 | Batch 10/29 | Loss: 5.8729 | Acc@1: 0.1719 | Acc@5: 0.2969 | Acc@10: 0.3359
Epoch 7 | Batch 20/29 | Loss: 5.6821 | Acc@1: 0.1992 | Acc@5: 0.3164 | Acc@10: 0.3477

Validation Results:
  Loss: 5.9559
  Acc@1: 0.1426 (14.26%)
  Acc@5: 0.2584 (25.84%)
  Acc@10: 0.3038 (30.38%)


Test Results:
  Loss: 6.0891
  Acc@1: 0.1356 (13.56%)
  Acc@5: 0.2305 (23.05%)
  Acc@10: 0.2594 (25.94%)

Epoch 7 Summary:
  Train - Loss: 5.8678 | Acc@1: 0.1759
  Val   - Loss: 5.9559 | Acc@1: 0.1426
  Test  - Loss: 6.0891 | Acc@1: 0.1356
  Time: 15.53s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch7.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 8/150
============================================================
Epoch 8 | Batch 10/29 | Loss: 5.7237 | Acc@1: 0.1719 | Acc@5: 0.3008 | Acc@10: 0.3672
Epoch 8 | Batch 20/29 | Loss: 5.7202 | Acc@1: 0.1680 | Acc@5: 0.3242 | Acc@10: 0.3867

Validation Results:
  Loss: 5.8793
  Acc@1: 0.1456 (14.56%)
  Acc@5: 0.2751 (27.51%)
  Acc@10: 0.3347 (33.47%)


Test Results:
  Loss: 6.0283
  Acc@1: 0.1391 (13.91%)
  Acc@5: 0.2541 (25.41%)
  Acc@10: 0.2718 (27.18%)

Epoch 8 Summary:
  Train - Loss: 5.7664 | Acc@1: 0.1769
  Val   - Loss: 5.8793 | Acc@1: 0.1456
  Test  - Loss: 6.0283 | Acc@1: 0.1391
  Time: 14.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch8.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 9/150
============================================================
Epoch 9 | Batch 10/29 | Loss: 5.6228 | Acc@1: 0.2109 | Acc@5: 0.3438 | Acc@10: 0.3906
Epoch 9 | Batch 20/29 | Loss: 5.6587 | Acc@1: 0.2109 | Acc@5: 0.3398 | Acc@10: 0.3789

Validation Results:
  Loss: 5.8166
  Acc@1: 0.1476 (14.76%)
  Acc@5: 0.2921 (29.21%)
  Acc@10: 0.3598 (35.98%)


Test Results:
  Loss: 5.9778
  Acc@1: 0.1434 (14.34%)
  Acc@5: 0.2634 (26.34%)
  Acc@10: 0.2840 (28.40%)

Epoch 9 Summary:
  Train - Loss: 5.6692 | Acc@1: 0.1863
  Val   - Loss: 5.8166 | Acc@1: 0.1476
  Test  - Loss: 5.9778 | Acc@1: 0.1434
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch9.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 10/150
============================================================
Epoch 10 | Batch 10/29 | Loss: 5.7266 | Acc@1: 0.1758 | Acc@5: 0.3242 | Acc@10: 0.3711
Epoch 10 | Batch 20/29 | Loss: 5.5104 | Acc@1: 0.1914 | Acc@5: 0.3477 | Acc@10: 0.4062

Validation Results:
  Loss: 5.7631
  Acc@1: 0.1507 (15.07%)
  Acc@5: 0.3108 (31.08%)
  Acc@10: 0.3763 (37.63%)


Test Results:
  Loss: 5.9363
  Acc@1: 0.1445 (14.45%)
  Acc@5: 0.2698 (26.98%)
  Acc@10: 0.3037 (30.37%)

Epoch 10 Summary:
  Train - Loss: 5.5630 | Acc@1: 0.1954
  Val   - Loss: 5.7631 | Acc@1: 0.1507
  Test  - Loss: 5.9363 | Acc@1: 0.1445
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch10.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 11/150
============================================================
Epoch 11 | Batch 10/29 | Loss: 5.4927 | Acc@1: 0.2109 | Acc@5: 0.3789 | Acc@10: 0.4180
Epoch 11 | Batch 20/29 | Loss: 5.6678 | Acc@1: 0.1523 | Acc@5: 0.3438 | Acc@10: 0.3945

Validation Results:
  Loss: 5.7026
  Acc@1: 0.1576 (15.76%)
  Acc@5: 0.3301 (33.01%)
  Acc@10: 0.3967 (39.67%)


Test Results:
  Loss: 5.8928
  Acc@1: 0.1481 (14.81%)
  Acc@5: 0.2771 (27.71%)
  Acc@10: 0.3227 (32.27%)

Epoch 11 Summary:
  Train - Loss: 5.4881 | Acc@1: 0.2004
  Val   - Loss: 5.7026 | Acc@1: 0.1576
  Test  - Loss: 5.8928 | Acc@1: 0.1481
  Time: 15.54s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch11.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 12/150
============================================================
Epoch 12 | Batch 10/29 | Loss: 5.5720 | Acc@1: 0.1953 | Acc@5: 0.3516 | Acc@10: 0.3867
Epoch 12 | Batch 20/29 | Loss: 5.1389 | Acc@1: 0.2461 | Acc@5: 0.4414 | Acc@10: 0.4883

Validation Results:
  Loss: 5.6600
  Acc@1: 0.1621 (16.21%)
  Acc@5: 0.3410 (34.10%)
  Acc@10: 0.4131 (41.31%)


Test Results:
  Loss: 5.8610
  Acc@1: 0.1523 (15.23%)
  Acc@5: 0.2866 (28.66%)
  Acc@10: 0.3425 (34.25%)

Epoch 12 Summary:
  Train - Loss: 5.4044 | Acc@1: 0.2066
  Val   - Loss: 5.6600 | Acc@1: 0.1621
  Test  - Loss: 5.8610 | Acc@1: 0.1523
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch12.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 13/150
============================================================
Epoch 13 | Batch 10/29 | Loss: 5.3151 | Acc@1: 0.2070 | Acc@5: 0.4336 | Acc@10: 0.4844
Epoch 13 | Batch 20/29 | Loss: 5.0284 | Acc@1: 0.2305 | Acc@5: 0.4609 | Acc@10: 0.5273

Validation Results:
  Loss: 5.6083
  Acc@1: 0.1763 (17.63%)
  Acc@5: 0.3685 (36.85%)
  Acc@10: 0.4249 (42.49%)


Test Results:
  Loss: 5.8284
  Acc@1: 0.1583 (15.83%)
  Acc@5: 0.3006 (30.06%)
  Acc@10: 0.3540 (35.40%)

Epoch 13 Summary:
  Train - Loss: 5.3294 | Acc@1: 0.2140
  Val   - Loss: 5.6083 | Acc@1: 0.1763
  Test  - Loss: 5.8284 | Acc@1: 0.1583
  Time: 15.55s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch13.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 14/150
============================================================
Epoch 14 | Batch 10/29 | Loss: 5.3443 | Acc@1: 0.2266 | Acc@5: 0.3945 | Acc@10: 0.4453
Epoch 14 | Batch 20/29 | Loss: 5.3721 | Acc@1: 0.2109 | Acc@5: 0.3984 | Acc@10: 0.4570

Validation Results:
  Loss: 5.5579
  Acc@1: 0.1797 (17.97%)
  Acc@5: 0.3869 (38.69%)
  Acc@10: 0.4430 (44.30%)


Test Results:
  Loss: 5.7833
  Acc@1: 0.1591 (15.91%)
  Acc@5: 0.3151 (31.51%)
  Acc@10: 0.3707 (37.07%)

Epoch 14 Summary:
  Train - Loss: 5.2525 | Acc@1: 0.2170
  Val   - Loss: 5.5579 | Acc@1: 0.1797
  Test  - Loss: 5.7833 | Acc@1: 0.1591
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch14.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 15/150
============================================================
Epoch 15 | Batch 10/29 | Loss: 5.1693 | Acc@1: 0.2109 | Acc@5: 0.4297 | Acc@10: 0.4844
Epoch 15 | Batch 20/29 | Loss: 5.0506 | Acc@1: 0.2227 | Acc@5: 0.4844 | Acc@10: 0.5234

Validation Results:
  Loss: 5.5271
  Acc@1: 0.1864 (18.64%)
  Acc@5: 0.4053 (40.53%)
  Acc@10: 0.4483 (44.83%)


Test Results:
  Loss: 5.7709
  Acc@1: 0.1738 (17.38%)
  Acc@5: 0.3294 (32.94%)
  Acc@10: 0.3825 (38.25%)

Epoch 15 Summary:
  Train - Loss: 5.1811 | Acc@1: 0.2263
  Val   - Loss: 5.5271 | Acc@1: 0.1864
  Test  - Loss: 5.7709 | Acc@1: 0.1738
  Time: 14.98s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch15.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 16/150
============================================================
Epoch 16 | Batch 10/29 | Loss: 5.1753 | Acc@1: 0.2109 | Acc@5: 0.4141 | Acc@10: 0.4883
Epoch 16 | Batch 20/29 | Loss: 5.1318 | Acc@1: 0.2227 | Acc@5: 0.4297 | Acc@10: 0.4922

Validation Results:
  Loss: 5.4423
  Acc@1: 0.1936 (19.36%)
  Acc@5: 0.4126 (41.26%)
  Acc@10: 0.4533 (45.33%)


Test Results:
  Loss: 5.7049
  Acc@1: 0.1775 (17.75%)
  Acc@5: 0.3388 (33.88%)
  Acc@10: 0.3890 (38.90%)

Epoch 16 Summary:
  Train - Loss: 5.1057 | Acc@1: 0.2346
  Val   - Loss: 5.4423 | Acc@1: 0.1936
  Test  - Loss: 5.7049 | Acc@1: 0.1775
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch16.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 17/150
============================================================
Epoch 17 | Batch 10/29 | Loss: 4.9607 | Acc@1: 0.2500 | Acc@5: 0.4766 | Acc@10: 0.5547
Epoch 17 | Batch 20/29 | Loss: 5.1006 | Acc@1: 0.2500 | Acc@5: 0.4375 | Acc@10: 0.4844

Validation Results:
  Loss: 5.4092
  Acc@1: 0.2079 (20.79%)
  Acc@5: 0.4207 (42.07%)
  Acc@10: 0.4642 (46.42%)


Test Results:
  Loss: 5.6776
  Acc@1: 0.1891 (18.91%)
  Acc@5: 0.3497 (34.97%)
  Acc@10: 0.4031 (40.31%)

Epoch 17 Summary:
  Train - Loss: 5.0451 | Acc@1: 0.2445
  Val   - Loss: 5.4092 | Acc@1: 0.2079
  Test  - Loss: 5.6776 | Acc@1: 0.1891
  Time: 15.50s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch17.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 18/150
============================================================
Epoch 18 | Batch 10/29 | Loss: 4.9782 | Acc@1: 0.2461 | Acc@5: 0.4922 | Acc@10: 0.5391
Epoch 18 | Batch 20/29 | Loss: 5.0570 | Acc@1: 0.2539 | Acc@5: 0.4453 | Acc@10: 0.4844

Validation Results:
  Loss: 5.3714
  Acc@1: 0.2143 (21.43%)
  Acc@5: 0.4302 (43.02%)
  Acc@10: 0.4728 (47.28%)


Test Results:
  Loss: 5.6484
  Acc@1: 0.1926 (19.26%)
  Acc@5: 0.3574 (35.74%)
  Acc@10: 0.4184 (41.84%)

Epoch 18 Summary:
  Train - Loss: 4.9868 | Acc@1: 0.2509
  Val   - Loss: 5.3714 | Acc@1: 0.2143
  Test  - Loss: 5.6484 | Acc@1: 0.1926
  Time: 14.92s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch18.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 19/150
============================================================
Epoch 19 | Batch 10/29 | Loss: 5.0668 | Acc@1: 0.2852 | Acc@5: 0.4453 | Acc@10: 0.5000
Epoch 19 | Batch 20/29 | Loss: 4.9475 | Acc@1: 0.2656 | Acc@5: 0.4922 | Acc@10: 0.5312

Validation Results:
  Loss: 5.3274
  Acc@1: 0.2176 (21.76%)
  Acc@5: 0.4368 (43.68%)
  Acc@10: 0.4767 (47.67%)


Test Results:
  Loss: 5.6138
  Acc@1: 0.1957 (19.57%)
  Acc@5: 0.3671 (36.71%)
  Acc@10: 0.4286 (42.86%)

Epoch 19 Summary:
  Train - Loss: 4.9324 | Acc@1: 0.2596
  Val   - Loss: 5.3274 | Acc@1: 0.2176
  Test  - Loss: 5.6138 | Acc@1: 0.1957
  Time: 15.54s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch19.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 20/150
============================================================
Epoch 20 | Batch 10/29 | Loss: 5.0280 | Acc@1: 0.2305 | Acc@5: 0.4688 | Acc@10: 0.5117
Epoch 20 | Batch 20/29 | Loss: 4.7753 | Acc@1: 0.2539 | Acc@5: 0.5156 | Acc@10: 0.5625

Validation Results:
  Loss: 5.2777
  Acc@1: 0.2176 (21.76%)
  Acc@5: 0.4433 (44.33%)
  Acc@10: 0.4846 (48.46%)


Test Results:
  Loss: 5.5850
  Acc@1: 0.2001 (20.01%)
  Acc@5: 0.3733 (37.33%)
  Acc@10: 0.4363 (43.63%)

Epoch 20 Summary:
  Train - Loss: 4.8692 | Acc@1: 0.2656
  Val   - Loss: 5.2777 | Acc@1: 0.2176
  Test  - Loss: 5.5850 | Acc@1: 0.2001
  Time: 15.54s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch20.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 21/150
============================================================
Epoch 21 | Batch 10/29 | Loss: 4.6540 | Acc@1: 0.2539 | Acc@5: 0.5312 | Acc@10: 0.5859
Epoch 21 | Batch 20/29 | Loss: 4.8939 | Acc@1: 0.2617 | Acc@5: 0.4844 | Acc@10: 0.5195

Validation Results:
  Loss: 5.2246
  Acc@1: 0.2207 (22.07%)
  Acc@5: 0.4452 (44.52%)
  Acc@10: 0.4890 (48.90%)


Test Results:
  Loss: 5.5302
  Acc@1: 0.2071 (20.71%)
  Acc@5: 0.3794 (37.94%)
  Acc@10: 0.4423 (44.23%)

Epoch 21 Summary:
  Train - Loss: 4.8216 | Acc@1: 0.2686
  Val   - Loss: 5.2246 | Acc@1: 0.2207
  Test  - Loss: 5.5302 | Acc@1: 0.2071
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch21.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 22/150
============================================================
Epoch 22 | Batch 10/29 | Loss: 4.7292 | Acc@1: 0.2812 | Acc@5: 0.5000 | Acc@10: 0.5430
Epoch 22 | Batch 20/29 | Loss: 4.7877 | Acc@1: 0.2500 | Acc@5: 0.5078 | Acc@10: 0.5469

Validation Results:
  Loss: 5.1886
  Acc@1: 0.2210 (22.10%)
  Acc@5: 0.4528 (45.28%)
  Acc@10: 0.4935 (49.35%)


Test Results:
  Loss: 5.5084
  Acc@1: 0.2088 (20.88%)
  Acc@5: 0.3904 (39.04%)
  Acc@10: 0.4525 (45.25%)

Epoch 22 Summary:
  Train - Loss: 4.7738 | Acc@1: 0.2764
  Val   - Loss: 5.1886 | Acc@1: 0.2210
  Test  - Loss: 5.5084 | Acc@1: 0.2088
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch22.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 23/150
============================================================
Epoch 23 | Batch 10/29 | Loss: 5.1973 | Acc@1: 0.2344 | Acc@5: 0.4297 | Acc@10: 0.4688
Epoch 23 | Batch 20/29 | Loss: 4.9517 | Acc@1: 0.2539 | Acc@5: 0.4609 | Acc@10: 0.5156

Validation Results:
  Loss: 5.1376
  Acc@1: 0.2210 (22.10%)
  Acc@5: 0.4586 (45.86%)
  Acc@10: 0.4971 (49.71%)


Test Results:
  Loss: 5.4641
  Acc@1: 0.2113 (21.13%)
  Acc@5: 0.3972 (39.72%)
  Acc@10: 0.4588 (45.88%)

Epoch 23 Summary:
  Train - Loss: 4.7225 | Acc@1: 0.2791
  Val   - Loss: 5.1376 | Acc@1: 0.2210
  Test  - Loss: 5.4641 | Acc@1: 0.2113
  Time: 15.52s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 24/150
============================================================
Epoch 24 | Batch 10/29 | Loss: 4.5589 | Acc@1: 0.3125 | Acc@5: 0.5664 | Acc@10: 0.6055
Epoch 24 | Batch 20/29 | Loss: 4.5446 | Acc@1: 0.3203 | Acc@5: 0.5469 | Acc@10: 0.5664

Validation Results:
  Loss: 5.0944
  Acc@1: 0.2227 (22.27%)
  Acc@5: 0.4648 (46.48%)
  Acc@10: 0.5002 (50.02%)


Test Results:
  Loss: 5.4324
  Acc@1: 0.2126 (21.26%)
  Acc@5: 0.4011 (40.11%)
  Acc@10: 0.4639 (46.39%)

Epoch 24 Summary:
  Train - Loss: 4.6713 | Acc@1: 0.2850
  Val   - Loss: 5.0944 | Acc@1: 0.2227
  Test  - Loss: 5.4324 | Acc@1: 0.2126
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch24.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 25/150
============================================================
Epoch 25 | Batch 10/29 | Loss: 4.6341 | Acc@1: 0.2617 | Acc@5: 0.5391 | Acc@10: 0.5742
Epoch 25 | Batch 20/29 | Loss: 4.6085 | Acc@1: 0.3164 | Acc@5: 0.5352 | Acc@10: 0.5547

Validation Results:
  Loss: 5.0759
  Acc@1: 0.2227 (22.27%)
  Acc@5: 0.4717 (47.17%)
  Acc@10: 0.5021 (50.21%)


Test Results:
  Loss: 5.3998
  Acc@1: 0.2159 (21.59%)
  Acc@5: 0.4214 (42.14%)
  Acc@10: 0.4736 (47.36%)

Epoch 25 Summary:
  Train - Loss: 4.6342 | Acc@1: 0.2827
  Val   - Loss: 5.0759 | Acc@1: 0.2227
  Test  - Loss: 5.3998 | Acc@1: 0.2159
  Time: 14.96s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch25.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 26/150
============================================================
Epoch 26 | Batch 10/29 | Loss: 4.4696 | Acc@1: 0.3086 | Acc@5: 0.5508 | Acc@10: 0.5977
Epoch 26 | Batch 20/29 | Loss: 4.5507 | Acc@1: 0.2812 | Acc@5: 0.5586 | Acc@10: 0.6133

Validation Results:
  Loss: 5.0331
  Acc@1: 0.2252 (22.52%)
  Acc@5: 0.4762 (47.62%)
  Acc@10: 0.5069 (50.69%)


Test Results:
  Loss: 5.3764
  Acc@1: 0.2188 (21.88%)
  Acc@5: 0.4221 (42.21%)
  Acc@10: 0.4809 (48.09%)

Epoch 26 Summary:
  Train - Loss: 4.5938 | Acc@1: 0.2874
  Val   - Loss: 5.0331 | Acc@1: 0.2252
  Test  - Loss: 5.3764 | Acc@1: 0.2188
  Time: 15.49s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch26.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 27/150
============================================================
Epoch 27 | Batch 10/29 | Loss: 4.4745 | Acc@1: 0.3203 | Acc@5: 0.5547 | Acc@10: 0.5938
Epoch 27 | Batch 20/29 | Loss: 4.5390 | Acc@1: 0.2852 | Acc@5: 0.5391 | Acc@10: 0.5938

Validation Results:
  Loss: 5.0042
  Acc@1: 0.2294 (22.94%)
  Acc@5: 0.4773 (47.73%)
  Acc@10: 0.5077 (50.77%)


Test Results:
  Loss: 5.3405
  Acc@1: 0.2181 (21.81%)
  Acc@5: 0.4298 (42.98%)
  Acc@10: 0.4839 (48.39%)

Epoch 27 Summary:
  Train - Loss: 4.5620 | Acc@1: 0.2943
  Val   - Loss: 5.0042 | Acc@1: 0.2294
  Test  - Loss: 5.3405 | Acc@1: 0.2181
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch27.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 28/150
============================================================
Epoch 28 | Batch 10/29 | Loss: 4.5018 | Acc@1: 0.2773 | Acc@5: 0.5430 | Acc@10: 0.5898
Epoch 28 | Batch 20/29 | Loss: 4.6573 | Acc@1: 0.2734 | Acc@5: 0.5117 | Acc@10: 0.5625

Validation Results:
  Loss: 4.9642
  Acc@1: 0.2363 (23.63%)
  Acc@5: 0.4807 (48.07%)
  Acc@10: 0.5130 (51.30%)


Test Results:
  Loss: 5.3083
  Acc@1: 0.2218 (22.18%)
  Acc@5: 0.4337 (43.37%)
  Acc@10: 0.4859 (48.59%)

Epoch 28 Summary:
  Train - Loss: 4.5174 | Acc@1: 0.2949
  Val   - Loss: 4.9642 | Acc@1: 0.2363
  Test  - Loss: 5.3083 | Acc@1: 0.2218
  Time: 15.02s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch28.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 29/150
============================================================
Epoch 29 | Batch 10/29 | Loss: 4.0538 | Acc@1: 0.3867 | Acc@5: 0.6133 | Acc@10: 0.6484
Epoch 29 | Batch 20/29 | Loss: 4.5502 | Acc@1: 0.2852 | Acc@5: 0.5625 | Acc@10: 0.5742

Validation Results:
  Loss: 4.9261
  Acc@1: 0.2416 (24.16%)
  Acc@5: 0.4823 (48.23%)
  Acc@10: 0.5200 (52.00%)


Test Results:
  Loss: 5.2787
  Acc@1: 0.2273 (22.73%)
  Acc@5: 0.4374 (43.74%)
  Acc@10: 0.4906 (49.06%)

Epoch 29 Summary:
  Train - Loss: 4.4817 | Acc@1: 0.2981
  Val   - Loss: 4.9261 | Acc@1: 0.2416
  Test  - Loss: 5.2787 | Acc@1: 0.2273
  Time: 15.54s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch29.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 30/150
============================================================
Epoch 30 | Batch 10/29 | Loss: 4.7238 | Acc@1: 0.2695 | Acc@5: 0.5078 | Acc@10: 0.5586
Epoch 30 | Batch 20/29 | Loss: 4.4197 | Acc@1: 0.3125 | Acc@5: 0.5703 | Acc@10: 0.6094

Validation Results:
  Loss: 4.8930
  Acc@1: 0.2531 (25.31%)
  Acc@5: 0.4854 (48.54%)
  Acc@10: 0.5383 (53.83%)


Test Results:
  Loss: 5.2467
  Acc@1: 0.2322 (23.22%)
  Acc@5: 0.4416 (44.16%)
  Acc@10: 0.4940 (49.40%)

Epoch 30 Summary:
  Train - Loss: 4.4469 | Acc@1: 0.3005
  Val   - Loss: 4.8930 | Acc@1: 0.2531
  Test  - Loss: 5.2467 | Acc@1: 0.2322
  Time: 15.50s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch30.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 31/150
============================================================
Epoch 31 | Batch 10/29 | Loss: 4.6720 | Acc@1: 0.2500 | Acc@5: 0.5195 | Acc@10: 0.5625
Epoch 31 | Batch 20/29 | Loss: 4.2474 | Acc@1: 0.3320 | Acc@5: 0.5859 | Acc@10: 0.6445

Validation Results:
  Loss: 4.8596
  Acc@1: 0.2609 (26.09%)
  Acc@5: 0.4885 (48.85%)
  Acc@10: 0.5564 (55.64%)


Test Results:
  Loss: 5.2194
  Acc@1: 0.2396 (23.96%)
  Acc@5: 0.4476 (44.76%)
  Acc@10: 0.4977 (49.77%)

Epoch 31 Summary:
  Train - Loss: 4.4131 | Acc@1: 0.3071
  Val   - Loss: 4.8596 | Acc@1: 0.2609
  Test  - Loss: 5.2194 | Acc@1: 0.2396
  Time: 15.51s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch31.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 32/150
============================================================
Epoch 32 | Batch 10/29 | Loss: 4.3458 | Acc@1: 0.3086 | Acc@5: 0.5508 | Acc@10: 0.6016
Epoch 32 | Batch 20/29 | Loss: 4.2562 | Acc@1: 0.3047 | Acc@5: 0.5781 | Acc@10: 0.6133

Validation Results:
  Loss: 4.8493
  Acc@1: 0.2729 (27.29%)
  Acc@5: 0.4918 (49.18%)
  Acc@10: 0.5470 (54.70%)


Test Results:
  Loss: 5.1958
  Acc@1: 0.2485 (24.85%)
  Acc@5: 0.4567 (45.67%)
  Acc@10: 0.5021 (50.21%)

Epoch 32 Summary:
  Train - Loss: 4.3781 | Acc@1: 0.3097
  Val   - Loss: 4.8493 | Acc@1: 0.2729
  Test  - Loss: 5.1958 | Acc@1: 0.2485
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch32.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 33/150
============================================================
Epoch 33 | Batch 10/29 | Loss: 4.3586 | Acc@1: 0.3008 | Acc@5: 0.5547 | Acc@10: 0.5820
Epoch 33 | Batch 20/29 | Loss: 4.5093 | Acc@1: 0.3164 | Acc@5: 0.5195 | Acc@10: 0.5625

Validation Results:
  Loss: 4.8012
  Acc@1: 0.2865 (28.65%)
  Acc@5: 0.4929 (49.29%)
  Acc@10: 0.5664 (56.64%)


Test Results:
  Loss: 5.1822
  Acc@1: 0.2485 (24.85%)
  Acc@5: 0.4511 (45.11%)
  Acc@10: 0.5029 (50.29%)

Epoch 33 Summary:
  Train - Loss: 4.3562 | Acc@1: 0.3144
  Val   - Loss: 4.8012 | Acc@1: 0.2865
  Test  - Loss: 5.1822 | Acc@1: 0.2485
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch33.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 34/150
============================================================
Epoch 34 | Batch 10/29 | Loss: 3.9171 | Acc@1: 0.3672 | Acc@5: 0.6523 | Acc@10: 0.6797
Epoch 34 | Batch 20/29 | Loss: 4.3275 | Acc@1: 0.3047 | Acc@5: 0.5898 | Acc@10: 0.6133

Validation Results:
  Loss: 4.7913
  Acc@1: 0.2868 (28.68%)
  Acc@5: 0.4960 (49.60%)
  Acc@10: 0.5698 (56.98%)


Test Results:
  Loss: 5.1430
  Acc@1: 0.2630 (26.30%)
  Acc@5: 0.4604 (46.04%)
  Acc@10: 0.5076 (50.76%)

Epoch 34 Summary:
  Train - Loss: 4.3234 | Acc@1: 0.3175
  Val   - Loss: 4.7913 | Acc@1: 0.2868
  Test  - Loss: 5.1430 | Acc@1: 0.2630
  Time: 15.53s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch34.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 35/150
============================================================
Epoch 35 | Batch 10/29 | Loss: 4.0564 | Acc@1: 0.3789 | Acc@5: 0.6016 | Acc@10: 0.6328
Epoch 35 | Batch 20/29 | Loss: 4.1401 | Acc@1: 0.3359 | Acc@5: 0.5898 | Acc@10: 0.6406

Validation Results:
  Loss: 4.7657
  Acc@1: 0.3024 (30.24%)
  Acc@5: 0.4999 (49.99%)
  Acc@10: 0.5742 (57.42%)


Test Results:
  Loss: 5.1318
  Acc@1: 0.2672 (26.72%)
  Acc@5: 0.4593 (45.93%)
  Acc@10: 0.5097 (50.97%)

Epoch 35 Summary:
  Train - Loss: 4.2955 | Acc@1: 0.3211
  Val   - Loss: 4.7657 | Acc@1: 0.3024
  Test  - Loss: 5.1318 | Acc@1: 0.2672
  Time: 14.95s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch35.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 36/150
============================================================
Epoch 36 | Batch 10/29 | Loss: 4.0986 | Acc@1: 0.3789 | Acc@5: 0.6016 | Acc@10: 0.6367
Epoch 36 | Batch 20/29 | Loss: 4.1276 | Acc@1: 0.3438 | Acc@5: 0.6055 | Acc@10: 0.6328

Validation Results:
  Loss: 4.7372
  Acc@1: 0.3149 (31.49%)
  Acc@5: 0.5060 (50.60%)
  Acc@10: 0.5759 (57.59%)


Test Results:
  Loss: 5.0965
  Acc@1: 0.2686 (26.86%)
  Acc@5: 0.4630 (46.30%)
  Acc@10: 0.5109 (51.09%)

Epoch 36 Summary:
  Train - Loss: 4.2611 | Acc@1: 0.3225
  Val   - Loss: 4.7372 | Acc@1: 0.3149
  Test  - Loss: 5.0965 | Acc@1: 0.2686
  Time: 15.52s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch36.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 37/150
============================================================
Epoch 37 | Batch 10/29 | Loss: 4.3120 | Acc@1: 0.3086 | Acc@5: 0.5820 | Acc@10: 0.6289
Epoch 37 | Batch 20/29 | Loss: 4.0837 | Acc@1: 0.3125 | Acc@5: 0.6055 | Acc@10: 0.6602

Validation Results:
  Loss: 4.7242
  Acc@1: 0.3172 (31.72%)
  Acc@5: 0.5105 (51.05%)
  Acc@10: 0.5804 (58.04%)


Test Results:
  Loss: 5.0967
  Acc@1: 0.2746 (27.46%)
  Acc@5: 0.4645 (46.45%)
  Acc@10: 0.5140 (51.40%)

Epoch 37 Summary:
  Train - Loss: 4.2403 | Acc@1: 0.3281
  Val   - Loss: 4.7242 | Acc@1: 0.3172
  Test  - Loss: 5.0967 | Acc@1: 0.2746
  Time: 15.53s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch37.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 38/150
============================================================
Epoch 38 | Batch 10/29 | Loss: 4.3768 | Acc@1: 0.2812 | Acc@5: 0.5547 | Acc@10: 0.5820
Epoch 38 | Batch 20/29 | Loss: 4.1752 | Acc@1: 0.3398 | Acc@5: 0.5859 | Acc@10: 0.6211

Validation Results:
  Loss: 4.7036
  Acc@1: 0.3238 (32.38%)
  Acc@5: 0.5155 (51.55%)
  Acc@10: 0.5840 (58.40%)


Test Results:
  Loss: 5.0600
  Acc@1: 0.2792 (27.92%)
  Acc@5: 0.4656 (46.56%)
  Acc@10: 0.5183 (51.83%)

Epoch 38 Summary:
  Train - Loss: 4.2088 | Acc@1: 0.3303
  Val   - Loss: 4.7036 | Acc@1: 0.3238
  Test  - Loss: 5.0600 | Acc@1: 0.2792
  Time: 14.99s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch38.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 39/150
============================================================
Epoch 39 | Batch 10/29 | Loss: 4.1144 | Acc@1: 0.3594 | Acc@5: 0.5938 | Acc@10: 0.6094
Epoch 39 | Batch 20/29 | Loss: 4.0828 | Acc@1: 0.3203 | Acc@5: 0.6094 | Acc@10: 0.6484

Validation Results:
  Loss: 4.6772
  Acc@1: 0.3266 (32.66%)
  Acc@5: 0.5361 (53.61%)
  Acc@10: 0.5873 (58.73%)


Test Results:
  Loss: 5.0451
  Acc@1: 0.2790 (27.90%)
  Acc@5: 0.4659 (46.59%)
  Acc@10: 0.5177 (51.77%)

Epoch 39 Summary:
  Train - Loss: 4.1823 | Acc@1: 0.3316
  Val   - Loss: 4.6772 | Acc@1: 0.3266
  Test  - Loss: 5.0451 | Acc@1: 0.2790
  Time: 15.53s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch39.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 40/150
============================================================
Epoch 40 | Batch 10/29 | Loss: 4.2575 | Acc@1: 0.2969 | Acc@5: 0.5664 | Acc@10: 0.5938
Epoch 40 | Batch 20/29 | Loss: 3.9233 | Acc@1: 0.3594 | Acc@5: 0.6406 | Acc@10: 0.6680

Validation Results:
  Loss: 4.6564
  Acc@1: 0.3286 (32.86%)
  Acc@5: 0.5539 (55.39%)
  Acc@10: 0.5898 (58.98%)


Test Results:
  Loss: 5.0287
  Acc@1: 0.2813 (28.13%)
  Acc@5: 0.4709 (47.09%)
  Acc@10: 0.5198 (51.98%)

Epoch 40 Summary:
  Train - Loss: 4.1621 | Acc@1: 0.3366
  Val   - Loss: 4.6564 | Acc@1: 0.3286
  Test  - Loss: 5.0287 | Acc@1: 0.2813
  Time: 15.50s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch40.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 41/150
============================================================
Epoch 41 | Batch 10/29 | Loss: 4.0154 | Acc@1: 0.3203 | Acc@5: 0.6094 | Acc@10: 0.6367
Epoch 41 | Batch 20/29 | Loss: 4.0483 | Acc@1: 0.3477 | Acc@5: 0.5820 | Acc@10: 0.6055

Validation Results:
  Loss: 4.6403
  Acc@1: 0.3297 (32.97%)
  Acc@5: 0.5597 (55.97%)
  Acc@10: 0.5924 (59.24%)


Test Results:
  Loss: 5.0125
  Acc@1: 0.2830 (28.30%)
  Acc@5: 0.4739 (47.39%)
  Acc@10: 0.5205 (52.05%)

Epoch 41 Summary:
  Train - Loss: 4.1386 | Acc@1: 0.3335
  Val   - Loss: 4.6403 | Acc@1: 0.3297
  Test  - Loss: 5.0125 | Acc@1: 0.2830
  Time: 15.51s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch41.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 42/150
============================================================
Epoch 42 | Batch 10/29 | Loss: 4.4673 | Acc@1: 0.2852 | Acc@5: 0.5312 | Acc@10: 0.5508
Epoch 42 | Batch 20/29 | Loss: 4.0273 | Acc@1: 0.3242 | Acc@5: 0.6250 | Acc@10: 0.6602

Validation Results:
  Loss: 4.6265
  Acc@1: 0.3325 (33.25%)
  Acc@5: 0.5625 (56.25%)
  Acc@10: 0.5929 (59.29%)


Test Results:
  Loss: 4.9981
  Acc@1: 0.2869 (28.69%)
  Acc@5: 0.4793 (47.93%)
  Acc@10: 0.5225 (52.25%)

Epoch 42 Summary:
  Train - Loss: 4.1241 | Acc@1: 0.3314
  Val   - Loss: 4.6265 | Acc@1: 0.3325
  Test  - Loss: 4.9981 | Acc@1: 0.2869
  Time: 15.51s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch42.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 43/150
============================================================
Epoch 43 | Batch 10/29 | Loss: 4.1333 | Acc@1: 0.3203 | Acc@5: 0.5703 | Acc@10: 0.6094
Epoch 43 | Batch 20/29 | Loss: 4.4206 | Acc@1: 0.2969 | Acc@5: 0.5273 | Acc@10: 0.5625

Validation Results:
  Loss: 4.6040
  Acc@1: 0.3297 (32.97%)
  Acc@5: 0.5675 (56.75%)
  Acc@10: 0.5946 (59.46%)


Test Results:
  Loss: 4.9862
  Acc@1: 0.2822 (28.22%)
  Acc@5: 0.4861 (48.61%)
  Acc@10: 0.5233 (52.33%)

Epoch 43 Summary:
  Train - Loss: 4.1020 | Acc@1: 0.3367
  Val   - Loss: 4.6040 | Acc@1: 0.3297
  Test  - Loss: 4.9862 | Acc@1: 0.2822
  Time: 15.55s | LR: 0.000012

============================================================
Epoch 44/150
============================================================
Epoch 44 | Batch 10/29 | Loss: 3.9420 | Acc@1: 0.3750 | Acc@5: 0.6055 | Acc@10: 0.6523
Epoch 44 | Batch 20/29 | Loss: 4.2280 | Acc@1: 0.3281 | Acc@5: 0.5586 | Acc@10: 0.5664

Validation Results:
  Loss: 4.5851
  Acc@1: 0.3331 (33.31%)
  Acc@5: 0.5703 (57.03%)
  Acc@10: 0.5960 (59.60%)


Test Results:
  Loss: 4.9718
  Acc@1: 0.2863 (28.63%)
  Acc@5: 0.4903 (49.03%)
  Acc@10: 0.5236 (52.36%)

Epoch 44 Summary:
  Train - Loss: 4.0702 | Acc@1: 0.3428
  Val   - Loss: 4.5851 | Acc@1: 0.3331
  Test  - Loss: 4.9718 | Acc@1: 0.2863
  Time: 5.29s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch44.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 45/150
============================================================
Epoch 45 | Batch 10/29 | Loss: 4.3639 | Acc@1: 0.3203 | Acc@5: 0.5430 | Acc@10: 0.5664
Epoch 45 | Batch 20/29 | Loss: 4.1638 | Acc@1: 0.2930 | Acc@5: 0.5703 | Acc@10: 0.6211

Validation Results:
  Loss: 4.5680
  Acc@1: 0.3328 (33.28%)
  Acc@5: 0.5734 (57.34%)
  Acc@10: 0.5968 (59.68%)


Test Results:
  Loss: 4.9583
  Acc@1: 0.2845 (28.45%)
  Acc@5: 0.4973 (49.73%)
  Acc@10: 0.5241 (52.41%)

Epoch 45 Summary:
  Train - Loss: 4.0630 | Acc@1: 0.3429
  Val   - Loss: 4.5680 | Acc@1: 0.3328
  Test  - Loss: 4.9583 | Acc@1: 0.2845
  Time: 6.16s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch45.pt

============================================================
Epoch 46/150
============================================================
Epoch 46 | Batch 10/29 | Loss: 3.9382 | Acc@1: 0.3672 | Acc@5: 0.6211 | Acc@10: 0.6641
Epoch 46 | Batch 20/29 | Loss: 3.9674 | Acc@1: 0.3555 | Acc@5: 0.6289 | Acc@10: 0.6680

Validation Results:
  Loss: 4.5601
  Acc@1: 0.3342 (33.42%)
  Acc@5: 0.5756 (57.56%)
  Acc@10: 0.5979 (59.79%)


Test Results:
  Loss: 4.9433
  Acc@1: 0.2901 (29.01%)
  Acc@5: 0.4992 (49.92%)
  Acc@10: 0.5273 (52.73%)

Epoch 46 Summary:
  Train - Loss: 4.0337 | Acc@1: 0.3466
  Val   - Loss: 4.5601 | Acc@1: 0.3342
  Test  - Loss: 4.9433 | Acc@1: 0.2901
  Time: 4.54s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch46.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 47/150
============================================================
Epoch 47 | Batch 10/29 | Loss: 3.9698 | Acc@1: 0.3203 | Acc@5: 0.6211 | Acc@10: 0.6562
Epoch 47 | Batch 20/29 | Loss: 4.1168 | Acc@1: 0.3125 | Acc@5: 0.5781 | Acc@10: 0.6250

Validation Results:
  Loss: 4.5449
  Acc@1: 0.3331 (33.31%)
  Acc@5: 0.5762 (57.62%)
  Acc@10: 0.5988 (59.88%)


Test Results:
  Loss: 4.9337
  Acc@1: 0.2892 (28.92%)
  Acc@5: 0.5027 (50.27%)
  Acc@10: 0.5311 (53.11%)

Epoch 47 Summary:
  Train - Loss: 4.0118 | Acc@1: 0.3450
  Val   - Loss: 4.5449 | Acc@1: 0.3331
  Test  - Loss: 4.9337 | Acc@1: 0.2892
  Time: 4.38s | LR: 0.000012

============================================================
Epoch 48/150
============================================================
Epoch 48 | Batch 10/29 | Loss: 4.0457 | Acc@1: 0.3203 | Acc@5: 0.6172 | Acc@10: 0.6523
Epoch 48 | Batch 20/29 | Loss: 3.9028 | Acc@1: 0.3398 | Acc@5: 0.6328 | Acc@10: 0.6680

Validation Results:
  Loss: 4.5394
  Acc@1: 0.3344 (33.44%)
  Acc@5: 0.5801 (58.01%)
  Acc@10: 0.5993 (59.93%)


Test Results:
  Loss: 4.9291
  Acc@1: 0.2899 (28.99%)
  Acc@5: 0.5059 (50.59%)
  Acc@10: 0.5314 (53.14%)

Epoch 48 Summary:
  Train - Loss: 4.0002 | Acc@1: 0.3452
  Val   - Loss: 4.5394 | Acc@1: 0.3344
  Test  - Loss: 4.9291 | Acc@1: 0.2899
  Time: 4.34s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch48.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 49/150
============================================================
Epoch 49 | Batch 10/29 | Loss: 4.1761 | Acc@1: 0.3516 | Acc@5: 0.5781 | Acc@10: 0.6055
Epoch 49 | Batch 20/29 | Loss: 4.0037 | Acc@1: 0.3242 | Acc@5: 0.6211 | Acc@10: 0.6523

Validation Results:
  Loss: 4.5266
  Acc@1: 0.3319 (33.19%)
  Acc@5: 0.5815 (58.15%)
  Acc@10: 0.5999 (59.99%)


Test Results:
  Loss: 4.9131
  Acc@1: 0.2936 (29.36%)
  Acc@5: 0.5072 (50.72%)
  Acc@10: 0.5328 (53.28%)

Epoch 49 Summary:
  Train - Loss: 3.9778 | Acc@1: 0.3506
  Val   - Loss: 4.5266 | Acc@1: 0.3319
  Test  - Loss: 4.9131 | Acc@1: 0.2936
  Time: 4.35s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 50/150
============================================================
Epoch 50 | Batch 10/29 | Loss: 3.8145 | Acc@1: 0.3789 | Acc@5: 0.6367 | Acc@10: 0.6602
Epoch 50 | Batch 20/29 | Loss: 4.1926 | Acc@1: 0.3398 | Acc@5: 0.5625 | Acc@10: 0.5898

Validation Results:
  Loss: 4.5097
  Acc@1: 0.3364 (33.64%)
  Acc@5: 0.5837 (58.37%)
  Acc@10: 0.6010 (60.10%)


Test Results:
  Loss: 4.9049
  Acc@1: 0.2914 (29.14%)
  Acc@5: 0.5085 (50.85%)
  Acc@10: 0.5342 (53.42%)

Epoch 50 Summary:
  Train - Loss: 3.9610 | Acc@1: 0.3525
  Val   - Loss: 4.5097 | Acc@1: 0.3364
  Test  - Loss: 4.9049 | Acc@1: 0.2914
  Time: 4.38s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch50.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 51/150
============================================================
Epoch 51 | Batch 10/29 | Loss: 3.9203 | Acc@1: 0.3242 | Acc@5: 0.6367 | Acc@10: 0.6680
Epoch 51 | Batch 20/29 | Loss: 3.9791 | Acc@1: 0.3281 | Acc@5: 0.6094 | Acc@10: 0.6406

Validation Results:
  Loss: 4.4967
  Acc@1: 0.3325 (33.25%)
  Acc@5: 0.5862 (58.62%)
  Acc@10: 0.6030 (60.30%)


Test Results:
  Loss: 4.8886
  Acc@1: 0.2954 (29.54%)
  Acc@5: 0.5101 (51.01%)
  Acc@10: 0.5362 (53.62%)

Epoch 51 Summary:
  Train - Loss: 3.9422 | Acc@1: 0.3481
  Val   - Loss: 4.4967 | Acc@1: 0.3325
  Test  - Loss: 4.8886 | Acc@1: 0.2954
  Time: 4.34s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 52/150
============================================================
Epoch 52 | Batch 10/29 | Loss: 3.8992 | Acc@1: 0.3164 | Acc@5: 0.6250 | Acc@10: 0.6797
Epoch 52 | Batch 20/29 | Loss: 3.9804 | Acc@1: 0.3320 | Acc@5: 0.5938 | Acc@10: 0.6211

Validation Results:
  Loss: 4.4835
  Acc@1: 0.3344 (33.44%)
  Acc@5: 0.5859 (58.59%)
  Acc@10: 0.6035 (60.35%)


Test Results:
  Loss: 4.8769
  Acc@1: 0.2954 (29.54%)
  Acc@5: 0.5109 (51.09%)
  Acc@10: 0.5379 (53.79%)

Epoch 52 Summary:
  Train - Loss: 3.9299 | Acc@1: 0.3440
  Val   - Loss: 4.4835 | Acc@1: 0.3344
  Test  - Loss: 4.8769 | Acc@1: 0.2954
  Time: 4.32s | LR: 0.000012

============================================================
Epoch 53/150
============================================================
Epoch 53 | Batch 10/29 | Loss: 3.9508 | Acc@1: 0.3789 | Acc@5: 0.6133 | Acc@10: 0.6367
Epoch 53 | Batch 20/29 | Loss: 4.1570 | Acc@1: 0.3203 | Acc@5: 0.5547 | Acc@10: 0.6055

Validation Results:
  Loss: 4.4717
  Acc@1: 0.3342 (33.42%)
  Acc@5: 0.5865 (58.65%)
  Acc@10: 0.6032 (60.32%)


Test Results:
  Loss: 4.8662
  Acc@1: 0.2964 (29.64%)
  Acc@5: 0.5121 (51.21%)
  Acc@10: 0.5394 (53.94%)

Epoch 53 Summary:
  Train - Loss: 3.9070 | Acc@1: 0.3494
  Val   - Loss: 4.4717 | Acc@1: 0.3342
  Test  - Loss: 4.8662 | Acc@1: 0.2964
  Time: 4.37s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 54/150
============================================================
Epoch 54 | Batch 10/29 | Loss: 3.9700 | Acc@1: 0.3242 | Acc@5: 0.6289 | Acc@10: 0.6523
Epoch 54 | Batch 20/29 | Loss: 3.8124 | Acc@1: 0.3242 | Acc@5: 0.6445 | Acc@10: 0.6719

Validation Results:
  Loss: 4.4650
  Acc@1: 0.3342 (33.42%)
  Acc@5: 0.5859 (58.59%)
  Acc@10: 0.6041 (60.41%)


Test Results:
  Loss: 4.8677
  Acc@1: 0.3007 (30.07%)
  Acc@5: 0.5119 (51.19%)
  Acc@10: 0.5376 (53.76%)

Epoch 54 Summary:
  Train - Loss: 3.8845 | Acc@1: 0.3525
  Val   - Loss: 4.4650 | Acc@1: 0.3342
  Test  - Loss: 4.8677 | Acc@1: 0.3007
  Time: 4.34s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 55/150
============================================================
Epoch 55 | Batch 10/29 | Loss: 3.6638 | Acc@1: 0.3828 | Acc@5: 0.6367 | Acc@10: 0.6836
Epoch 55 | Batch 20/29 | Loss: 3.9018 | Acc@1: 0.3711 | Acc@5: 0.6172 | Acc@10: 0.6641

Validation Results:
  Loss: 4.4556
  Acc@1: 0.3319 (33.19%)
  Acc@5: 0.5871 (58.71%)
  Acc@10: 0.6052 (60.52%)


Test Results:
  Loss: 4.8609
  Acc@1: 0.2959 (29.59%)
  Acc@5: 0.5130 (51.30%)
  Acc@10: 0.5400 (54.00%)

Epoch 55 Summary:
  Train - Loss: 3.8717 | Acc@1: 0.3504
  Val   - Loss: 4.4556 | Acc@1: 0.3319
  Test  - Loss: 4.8609 | Acc@1: 0.2959
  Time: 4.35s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch55.pt

============================================================
Epoch 56/150
============================================================
Epoch 56 | Batch 10/29 | Loss: 3.8997 | Acc@1: 0.3398 | Acc@5: 0.6133 | Acc@10: 0.6484
Epoch 56 | Batch 20/29 | Loss: 3.7906 | Acc@1: 0.3789 | Acc@5: 0.6367 | Acc@10: 0.6641

Validation Results:
  Loss: 4.4428
  Acc@1: 0.3361 (33.61%)
  Acc@5: 0.5876 (58.76%)
  Acc@10: 0.6057 (60.57%)


Test Results:
  Loss: 4.8464
  Acc@1: 0.3003 (30.03%)
  Acc@5: 0.5150 (51.50%)
  Acc@10: 0.5407 (54.07%)

Epoch 56 Summary:
  Train - Loss: 3.8619 | Acc@1: 0.3536
  Val   - Loss: 4.4428 | Acc@1: 0.3361
  Test  - Loss: 4.8464 | Acc@1: 0.3003
  Time: 4.42s | LR: 0.000012

============================================================
Epoch 57/150
============================================================
Epoch 57 | Batch 10/29 | Loss: 4.0072 | Acc@1: 0.3281 | Acc@5: 0.6094 | Acc@10: 0.6484
Epoch 57 | Batch 20/29 | Loss: 3.4830 | Acc@1: 0.4062 | Acc@5: 0.6875 | Acc@10: 0.7188

Validation Results:
  Loss: 4.4460
  Acc@1: 0.3317 (33.17%)
  Acc@5: 0.5873 (58.73%)
  Acc@10: 0.6069 (60.69%)


Test Results:
  Loss: 4.8522
  Acc@1: 0.3015 (30.15%)
  Acc@5: 0.5160 (51.60%)
  Acc@10: 0.5407 (54.07%)

Epoch 57 Summary:
  Train - Loss: 3.8534 | Acc@1: 0.3534
  Val   - Loss: 4.4460 | Acc@1: 0.3317
  Test  - Loss: 4.8522 | Acc@1: 0.3015
  Time: 4.37s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 58/150
============================================================
Epoch 58 | Batch 10/29 | Loss: 3.6830 | Acc@1: 0.3359 | Acc@5: 0.6445 | Acc@10: 0.6836
Epoch 58 | Batch 20/29 | Loss: 3.5961 | Acc@1: 0.3438 | Acc@5: 0.6992 | Acc@10: 0.7148

Validation Results:
  Loss: 4.4175
  Acc@1: 0.3361 (33.61%)
  Acc@5: 0.5884 (58.84%)
  Acc@10: 0.6083 (60.83%)


Test Results:
  Loss: 4.8244
  Acc@1: 0.3039 (30.39%)
  Acc@5: 0.5172 (51.72%)
  Acc@10: 0.5404 (54.04%)

Epoch 58 Summary:
  Train - Loss: 3.8339 | Acc@1: 0.3526
  Val   - Loss: 4.4175 | Acc@1: 0.3361
  Test  - Loss: 4.8244 | Acc@1: 0.3039
  Time: 4.36s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 59/150
============================================================
Epoch 59 | Batch 10/29 | Loss: 3.6015 | Acc@1: 0.4180 | Acc@5: 0.6719 | Acc@10: 0.7031
Epoch 59 | Batch 20/29 | Loss: 3.8734 | Acc@1: 0.3516 | Acc@5: 0.6289 | Acc@10: 0.6719

Validation Results:
  Loss: 4.4111
  Acc@1: 0.3364 (33.64%)
  Acc@5: 0.5882 (58.82%)
  Acc@10: 0.6085 (60.85%)


Test Results:
  Loss: 4.8215
  Acc@1: 0.3060 (30.60%)
  Acc@5: 0.5165 (51.65%)
  Acc@10: 0.5415 (54.15%)

Epoch 59 Summary:
  Train - Loss: 3.8238 | Acc@1: 0.3544
  Val   - Loss: 4.4111 | Acc@1: 0.3364
  Test  - Loss: 4.8215 | Acc@1: 0.3060
  Time: 4.38s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 60/150
============================================================
Epoch 60 | Batch 10/29 | Loss: 3.9258 | Acc@1: 0.3555 | Acc@5: 0.6172 | Acc@10: 0.6562
Epoch 60 | Batch 20/29 | Loss: 3.5064 | Acc@1: 0.4180 | Acc@5: 0.7070 | Acc@10: 0.7266

Validation Results:
  Loss: 4.4010
  Acc@1: 0.3367 (33.67%)
  Acc@5: 0.5896 (58.96%)
  Acc@10: 0.6091 (60.91%)


Test Results:
  Loss: 4.8197
  Acc@1: 0.3022 (30.22%)
  Acc@5: 0.5183 (51.83%)
  Acc@10: 0.5403 (54.03%)

Epoch 60 Summary:
  Train - Loss: 3.8113 | Acc@1: 0.3526
  Val   - Loss: 4.4010 | Acc@1: 0.3367
  Test  - Loss: 4.8197 | Acc@1: 0.3022
  Time: 4.43s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch60.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 61/150
============================================================
Epoch 61 | Batch 10/29 | Loss: 3.7382 | Acc@1: 0.3594 | Acc@5: 0.6484 | Acc@10: 0.6758
Epoch 61 | Batch 20/29 | Loss: 3.7369 | Acc@1: 0.3438 | Acc@5: 0.6211 | Acc@10: 0.6719

Validation Results:
  Loss: 4.3967
  Acc@1: 0.3347 (33.47%)
  Acc@5: 0.5907 (59.07%)
  Acc@10: 0.6097 (60.97%)


Test Results:
  Loss: 4.7960
  Acc@1: 0.3063 (30.63%)
  Acc@5: 0.5164 (51.64%)
  Acc@10: 0.5418 (54.18%)

Epoch 61 Summary:
  Train - Loss: 3.7954 | Acc@1: 0.3516
  Val   - Loss: 4.3967 | Acc@1: 0.3347
  Test  - Loss: 4.7960 | Acc@1: 0.3063
  Time: 4.37s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 62/150
============================================================
Epoch 62 | Batch 10/29 | Loss: 3.9874 | Acc@1: 0.3242 | Acc@5: 0.5625 | Acc@10: 0.6172
Epoch 62 | Batch 20/29 | Loss: 3.8500 | Acc@1: 0.3398 | Acc@5: 0.6211 | Acc@10: 0.6680

Validation Results:
  Loss: 4.3899
  Acc@1: 0.3361 (33.61%)
  Acc@5: 0.5907 (59.07%)
  Acc@10: 0.6099 (60.99%)


Test Results:
  Loss: 4.8060
  Acc@1: 0.3046 (30.46%)
  Acc@5: 0.5183 (51.83%)
  Acc@10: 0.5411 (54.11%)

Epoch 62 Summary:
  Train - Loss: 3.7802 | Acc@1: 0.3490
  Val   - Loss: 4.3899 | Acc@1: 0.3361
  Test  - Loss: 4.8060 | Acc@1: 0.3046
  Time: 5.44s | LR: 0.000012

============================================================
Epoch 63/150
============================================================
Epoch 63 | Batch 10/29 | Loss: 3.8564 | Acc@1: 0.3594 | Acc@5: 0.5977 | Acc@10: 0.6758
Epoch 63 | Batch 20/29 | Loss: 4.0301 | Acc@1: 0.3398 | Acc@5: 0.5938 | Acc@10: 0.6289

Validation Results:
  Loss: 4.3845
  Acc@1: 0.3356 (33.56%)
  Acc@5: 0.5921 (59.21%)
  Acc@10: 0.6102 (61.02%)


Test Results:
  Loss: 4.8030
  Acc@1: 0.3001 (30.01%)
  Acc@5: 0.5185 (51.85%)
  Acc@10: 0.5413 (54.13%)

Epoch 63 Summary:
  Train - Loss: 3.7643 | Acc@1: 0.3551
  Val   - Loss: 4.3845 | Acc@1: 0.3356
  Test  - Loss: 4.8030 | Acc@1: 0.3001
  Time: 9.82s | LR: 0.000012

============================================================
Epoch 64/150
============================================================
Epoch 64 | Batch 10/29 | Loss: 3.6235 | Acc@1: 0.3477 | Acc@5: 0.6602 | Acc@10: 0.6836
Epoch 64 | Batch 20/29 | Loss: 3.4422 | Acc@1: 0.3828 | Acc@5: 0.6836 | Acc@10: 0.7148

Validation Results:
  Loss: 4.3818
  Acc@1: 0.3342 (33.42%)
  Acc@5: 0.5938 (59.38%)
  Acc@10: 0.6108 (61.08%)


Test Results:
  Loss: 4.7959
  Acc@1: 0.3064 (30.64%)
  Acc@5: 0.5200 (52.00%)
  Acc@10: 0.5424 (54.24%)

Epoch 64 Summary:
  Train - Loss: 3.7561 | Acc@1: 0.3517
  Val   - Loss: 4.3818 | Acc@1: 0.3342
  Test  - Loss: 4.7959 | Acc@1: 0.3064
  Time: 11.53s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 65/150
============================================================
Epoch 65 | Batch 10/29 | Loss: 3.7343 | Acc@1: 0.3477 | Acc@5: 0.6367 | Acc@10: 0.6836
Epoch 65 | Batch 20/29 | Loss: 3.9412 | Acc@1: 0.3477 | Acc@5: 0.6016 | Acc@10: 0.6289

Validation Results:
  Loss: 4.3679
  Acc@1: 0.3350 (33.50%)
  Acc@5: 0.5932 (59.32%)
  Acc@10: 0.6116 (61.16%)


Test Results:
  Loss: 4.7869
  Acc@1: 0.3058 (30.58%)
  Acc@5: 0.5189 (51.89%)
  Acc@10: 0.5428 (54.28%)

Epoch 65 Summary:
  Train - Loss: 3.7418 | Acc@1: 0.3526
  Val   - Loss: 4.3679 | Acc@1: 0.3350
  Test  - Loss: 4.7869 | Acc@1: 0.3058
  Time: 10.78s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch65.pt

============================================================
Epoch 66/150
============================================================
Epoch 66 | Batch 10/29 | Loss: 3.5256 | Acc@1: 0.3438 | Acc@5: 0.6719 | Acc@10: 0.6953
Epoch 66 | Batch 20/29 | Loss: 3.8742 | Acc@1: 0.3555 | Acc@5: 0.6055 | Acc@10: 0.6562

Validation Results:
  Loss: 4.3549
  Acc@1: 0.3333 (33.33%)
  Acc@5: 0.5946 (59.46%)
  Acc@10: 0.6119 (61.19%)


Test Results:
  Loss: 4.7720
  Acc@1: 0.3053 (30.53%)
  Acc@5: 0.5228 (52.28%)
  Acc@10: 0.5450 (54.50%)

Epoch 66 Summary:
  Train - Loss: 3.7209 | Acc@1: 0.3559
  Val   - Loss: 4.3549 | Acc@1: 0.3333
  Test  - Loss: 4.7720 | Acc@1: 0.3053
  Time: 10.92s | LR: 0.000012

============================================================
Epoch 67/150
============================================================
Epoch 67 | Batch 10/29 | Loss: 3.5576 | Acc@1: 0.3438 | Acc@5: 0.6641 | Acc@10: 0.7031
Epoch 67 | Batch 20/29 | Loss: 3.7961 | Acc@1: 0.3477 | Acc@5: 0.6406 | Acc@10: 0.6797

Validation Results:
  Loss: 4.3486
  Acc@1: 0.3370 (33.70%)
  Acc@5: 0.5954 (59.54%)
  Acc@10: 0.6124 (61.24%)


Test Results:
  Loss: 4.7707
  Acc@1: 0.3042 (30.42%)
  Acc@5: 0.5232 (52.32%)
  Acc@10: 0.5457 (54.57%)

Epoch 67 Summary:
  Train - Loss: 3.7219 | Acc@1: 0.3495
  Val   - Loss: 4.3486 | Acc@1: 0.3370
  Test  - Loss: 4.7707 | Acc@1: 0.3042
  Time: 11.75s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch67.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 68/150
============================================================
Epoch 68 | Batch 10/29 | Loss: 3.7570 | Acc@1: 0.3281 | Acc@5: 0.6406 | Acc@10: 0.6641
Epoch 68 | Batch 20/29 | Loss: 3.6393 | Acc@1: 0.3633 | Acc@5: 0.6562 | Acc@10: 0.6914

Validation Results:
  Loss: 4.3451
  Acc@1: 0.3353 (33.53%)
  Acc@5: 0.5946 (59.46%)
  Acc@10: 0.6136 (61.36%)


Test Results:
  Loss: 4.7734
  Acc@1: 0.3072 (30.72%)
  Acc@5: 0.5221 (52.21%)
  Acc@10: 0.5461 (54.61%)

Epoch 68 Summary:
  Train - Loss: 3.7079 | Acc@1: 0.3526
  Val   - Loss: 4.3451 | Acc@1: 0.3353
  Test  - Loss: 4.7734 | Acc@1: 0.3072
  Time: 11.01s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 69/150
============================================================
Epoch 69 | Batch 10/29 | Loss: 3.6209 | Acc@1: 0.3711 | Acc@5: 0.6562 | Acc@10: 0.6836
Epoch 69 | Batch 20/29 | Loss: 3.5521 | Acc@1: 0.3789 | Acc@5: 0.6641 | Acc@10: 0.6992

Validation Results:
  Loss: 4.3375
  Acc@1: 0.3361 (33.61%)
  Acc@5: 0.5954 (59.54%)
  Acc@10: 0.6138 (61.38%)


Test Results:
  Loss: 4.7579
  Acc@1: 0.3092 (30.92%)
  Acc@5: 0.5236 (52.36%)
  Acc@10: 0.5467 (54.67%)

Epoch 69 Summary:
  Train - Loss: 3.6935 | Acc@1: 0.3555
  Val   - Loss: 4.3375 | Acc@1: 0.3361
  Test  - Loss: 4.7579 | Acc@1: 0.3092
  Time: 11.15s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 70/150
============================================================
Epoch 70 | Batch 10/29 | Loss: 3.6818 | Acc@1: 0.3555 | Acc@5: 0.6523 | Acc@10: 0.6875
Epoch 70 | Batch 20/29 | Loss: 3.7316 | Acc@1: 0.3594 | Acc@5: 0.6289 | Acc@10: 0.6523

Validation Results:
  Loss: 4.3382
  Acc@1: 0.3372 (33.72%)
  Acc@5: 0.5960 (59.60%)
  Acc@10: 0.6144 (61.44%)


Test Results:
  Loss: 4.7548
  Acc@1: 0.3097 (30.97%)
  Acc@5: 0.5231 (52.31%)
  Acc@10: 0.5474 (54.74%)

Epoch 70 Summary:
  Train - Loss: 3.6801 | Acc@1: 0.3565
  Val   - Loss: 4.3382 | Acc@1: 0.3372
  Test  - Loss: 4.7548 | Acc@1: 0.3097
  Time: 11.67s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch70.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 71/150
============================================================
Epoch 71 | Batch 10/29 | Loss: 3.7354 | Acc@1: 0.3828 | Acc@5: 0.6445 | Acc@10: 0.6641
Epoch 71 | Batch 20/29 | Loss: 3.6626 | Acc@1: 0.3750 | Acc@5: 0.6484 | Acc@10: 0.6797

Validation Results:
  Loss: 4.3344
  Acc@1: 0.3344 (33.44%)
  Acc@5: 0.5974 (59.74%)
  Acc@10: 0.6147 (61.47%)


Test Results:
  Loss: 4.7651
  Acc@1: 0.2996 (29.96%)
  Acc@5: 0.5250 (52.50%)
  Acc@10: 0.5475 (54.75%)

Epoch 71 Summary:
  Train - Loss: 3.6802 | Acc@1: 0.3606
  Val   - Loss: 4.3344 | Acc@1: 0.3344
  Test  - Loss: 4.7651 | Acc@1: 0.2996
  Time: 11.51s | LR: 0.000012

============================================================
Epoch 72/150
============================================================
Epoch 72 | Batch 10/29 | Loss: 3.6853 | Acc@1: 0.3320 | Acc@5: 0.6562 | Acc@10: 0.6875
Epoch 72 | Batch 20/29 | Loss: 3.7026 | Acc@1: 0.3594 | Acc@5: 0.6406 | Acc@10: 0.6875

Validation Results:
  Loss: 4.3174
  Acc@1: 0.3386 (33.86%)
  Acc@5: 0.5979 (59.79%)
  Acc@10: 0.6152 (61.52%)


Test Results:
  Loss: 4.7393
  Acc@1: 0.3082 (30.82%)
  Acc@5: 0.5245 (52.45%)
  Acc@10: 0.5502 (55.02%)

Epoch 72 Summary:
  Train - Loss: 3.6642 | Acc@1: 0.3544
  Val   - Loss: 4.3174 | Acc@1: 0.3386
  Test  - Loss: 4.7393 | Acc@1: 0.3082
  Time: 10.91s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch72.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 73/150
============================================================
Epoch 73 | Batch 10/29 | Loss: 3.8453 | Acc@1: 0.3164 | Acc@5: 0.5938 | Acc@10: 0.6367
Epoch 73 | Batch 20/29 | Loss: 3.5953 | Acc@1: 0.4062 | Acc@5: 0.6562 | Acc@10: 0.7109

Validation Results:
  Loss: 4.3264
  Acc@1: 0.3344 (33.44%)
  Acc@5: 0.5977 (59.77%)
  Acc@10: 0.6161 (61.61%)


Test Results:
  Loss: 4.7540
  Acc@1: 0.3050 (30.50%)
  Acc@5: 0.5249 (52.49%)
  Acc@10: 0.5477 (54.77%)

Epoch 73 Summary:
  Train - Loss: 3.6474 | Acc@1: 0.3592
  Val   - Loss: 4.3264 | Acc@1: 0.3344
  Test  - Loss: 4.7540 | Acc@1: 0.3050
  Time: 11.22s | LR: 0.000012

============================================================
Epoch 74/150
============================================================
Epoch 74 | Batch 10/29 | Loss: 3.7555 | Acc@1: 0.3633 | Acc@5: 0.6367 | Acc@10: 0.6719
Epoch 74 | Batch 20/29 | Loss: 3.6051 | Acc@1: 0.3008 | Acc@5: 0.6680 | Acc@10: 0.7109

Validation Results:
  Loss: 4.3086
  Acc@1: 0.3384 (33.84%)
  Acc@5: 0.5977 (59.77%)
  Acc@10: 0.6164 (61.64%)


Test Results:
  Loss: 4.7310
  Acc@1: 0.3089 (30.89%)
  Acc@5: 0.5244 (52.44%)
  Acc@10: 0.5499 (54.99%)

Epoch 74 Summary:
  Train - Loss: 3.6414 | Acc@1: 0.3586
  Val   - Loss: 4.3086 | Acc@1: 0.3384
  Test  - Loss: 4.7310 | Acc@1: 0.3089
  Time: 11.33s | LR: 0.000012

============================================================
Epoch 75/150
============================================================
Epoch 75 | Batch 10/29 | Loss: 3.6975 | Acc@1: 0.3750 | Acc@5: 0.6250 | Acc@10: 0.6602
Epoch 75 | Batch 20/29 | Loss: 3.7428 | Acc@1: 0.3555 | Acc@5: 0.6250 | Acc@10: 0.6641

Validation Results:
  Loss: 4.3113
  Acc@1: 0.3339 (33.39%)
  Acc@5: 0.5979 (59.79%)
  Acc@10: 0.6169 (61.69%)


Test Results:
  Loss: 4.7404
  Acc@1: 0.3088 (30.88%)
  Acc@5: 0.5255 (52.55%)
  Acc@10: 0.5522 (55.22%)

Epoch 75 Summary:
  Train - Loss: 3.6294 | Acc@1: 0.3595
  Val   - Loss: 4.3113 | Acc@1: 0.3339
  Test  - Loss: 4.7404 | Acc@1: 0.3088
  Time: 11.36s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch75.pt

============================================================
Epoch 76/150
============================================================
Epoch 76 | Batch 10/29 | Loss: 3.5791 | Acc@1: 0.3711 | Acc@5: 0.6484 | Acc@10: 0.6680
Epoch 76 | Batch 20/29 | Loss: 3.6148 | Acc@1: 0.3398 | Acc@5: 0.6523 | Acc@10: 0.6797

Validation Results:
  Loss: 4.3041
  Acc@1: 0.3381 (33.81%)
  Acc@5: 0.5982 (59.82%)
  Acc@10: 0.6169 (61.69%)


Test Results:
  Loss: 4.7400
  Acc@1: 0.3009 (30.09%)
  Acc@5: 0.5250 (52.50%)
  Acc@10: 0.5524 (55.24%)

Epoch 76 Summary:
  Train - Loss: 3.6256 | Acc@1: 0.3568
  Val   - Loss: 4.3041 | Acc@1: 0.3381
  Test  - Loss: 4.7400 | Acc@1: 0.3009
  Time: 11.29s | LR: 0.000012

============================================================
Epoch 77/150
============================================================
Epoch 77 | Batch 10/29 | Loss: 4.0102 | Acc@1: 0.3086 | Acc@5: 0.5977 | Acc@10: 0.6445
Epoch 77 | Batch 20/29 | Loss: 3.6498 | Acc@1: 0.3203 | Acc@5: 0.6406 | Acc@10: 0.6719

Validation Results:
  Loss: 4.3000
  Acc@1: 0.3356 (33.56%)
  Acc@5: 0.5982 (59.82%)
  Acc@10: 0.6172 (61.72%)


Test Results:
  Loss: 4.7276
  Acc@1: 0.3114 (31.14%)
  Acc@5: 0.5261 (52.61%)
  Acc@10: 0.5527 (55.27%)

Epoch 77 Summary:
  Train - Loss: 3.6164 | Acc@1: 0.3596
  Val   - Loss: 4.3000 | Acc@1: 0.3356
  Test  - Loss: 4.7276 | Acc@1: 0.3114
  Time: 11.14s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 78/150
============================================================
Epoch 78 | Batch 10/29 | Loss: 3.6100 | Acc@1: 0.3242 | Acc@5: 0.6406 | Acc@10: 0.6836
Epoch 78 | Batch 20/29 | Loss: 3.5958 | Acc@1: 0.4102 | Acc@5: 0.6367 | Acc@10: 0.6797

Validation Results:
  Loss: 4.2962
  Acc@1: 0.3395 (33.95%)
  Acc@5: 0.5993 (59.93%)
  Acc@10: 0.6183 (61.83%)


Test Results:
  Loss: 4.7295
  Acc@1: 0.3113 (31.13%)
  Acc@5: 0.5246 (52.46%)
  Acc@10: 0.5527 (55.27%)

Epoch 78 Summary:
  Train - Loss: 3.6028 | Acc@1: 0.3568
  Val   - Loss: 4.2962 | Acc@1: 0.3395
  Test  - Loss: 4.7295 | Acc@1: 0.3113
  Time: 7.27s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch78.pt
  ✅ New best validation accuracy! Saved to checkpoints/location_hrm_opt_best_val.pt

============================================================
Epoch 79/150
============================================================
Epoch 79 | Batch 10/29 | Loss: 3.1866 | Acc@1: 0.4141 | Acc@5: 0.7266 | Acc@10: 0.7500
Epoch 79 | Batch 20/29 | Loss: 3.8062 | Acc@1: 0.3594 | Acc@5: 0.6328 | Acc@10: 0.6602

Validation Results:
  Loss: 4.2928
  Acc@1: 0.3356 (33.56%)
  Acc@5: 0.5991 (59.91%)
  Acc@10: 0.6203 (62.03%)


Test Results:
  Loss: 4.7228
  Acc@1: 0.3096 (30.96%)
  Acc@5: 0.5256 (52.56%)
  Acc@10: 0.5543 (55.43%)

Epoch 79 Summary:
  Train - Loss: 3.5916 | Acc@1: 0.3614
  Val   - Loss: 4.2928 | Acc@1: 0.3356
  Test  - Loss: 4.7228 | Acc@1: 0.3096
  Time: 4.36s | LR: 0.000012

============================================================
Epoch 80/150
============================================================
Epoch 80 | Batch 10/29 | Loss: 3.4104 | Acc@1: 0.3555 | Acc@5: 0.6953 | Acc@10: 0.7266
Epoch 80 | Batch 20/29 | Loss: 3.5172 | Acc@1: 0.3438 | Acc@5: 0.6758 | Acc@10: 0.6914

Validation Results:
  Loss: 4.2822
  Acc@1: 0.3389 (33.89%)
  Acc@5: 0.5988 (59.88%)
  Acc@10: 0.6214 (62.14%)


Test Results:
  Loss: 4.7175
  Acc@1: 0.3035 (30.35%)
  Acc@5: 0.5260 (52.60%)
  Acc@10: 0.5550 (55.50%)

Epoch 80 Summary:
  Train - Loss: 3.5820 | Acc@1: 0.3576
  Val   - Loss: 4.2822 | Acc@1: 0.3389
  Test  - Loss: 4.7175 | Acc@1: 0.3035
  Time: 4.39s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch80.pt

============================================================
Epoch 81/150
============================================================
Epoch 81 | Batch 10/29 | Loss: 4.1185 | Acc@1: 0.3125 | Acc@5: 0.5625 | Acc@10: 0.6094
Epoch 81 | Batch 20/29 | Loss: 3.5471 | Acc@1: 0.3633 | Acc@5: 0.6602 | Acc@10: 0.7109

Validation Results:
  Loss: 4.2898
  Acc@1: 0.3381 (33.81%)
  Acc@5: 0.5988 (59.88%)
  Acc@10: 0.6217 (62.17%)


Test Results:
  Loss: 4.7271
  Acc@1: 0.3067 (30.67%)
  Acc@5: 0.5260 (52.60%)
  Acc@10: 0.5551 (55.51%)

Epoch 81 Summary:
  Train - Loss: 3.5758 | Acc@1: 0.3575
  Val   - Loss: 4.2898 | Acc@1: 0.3381
  Test  - Loss: 4.7271 | Acc@1: 0.3067
  Time: 4.43s | LR: 0.000012

============================================================
Epoch 82/150
============================================================
Epoch 82 | Batch 10/29 | Loss: 3.6573 | Acc@1: 0.3281 | Acc@5: 0.6484 | Acc@10: 0.6836
Epoch 82 | Batch 20/29 | Loss: 3.8536 | Acc@1: 0.3008 | Acc@5: 0.6055 | Acc@10: 0.6484

Validation Results:
  Loss: 4.2847
  Acc@1: 0.3395 (33.95%)
  Acc@5: 0.5999 (59.99%)
  Acc@10: 0.6239 (62.39%)


Test Results:
  Loss: 4.7248
  Acc@1: 0.3002 (30.02%)
  Acc@5: 0.5267 (52.67%)
  Acc@10: 0.5565 (55.65%)

Epoch 82 Summary:
  Train - Loss: 3.5696 | Acc@1: 0.3580
  Val   - Loss: 4.2847 | Acc@1: 0.3395
  Test  - Loss: 4.7248 | Acc@1: 0.3002
  Time: 4.36s | LR: 0.000012

============================================================
Epoch 83/150
============================================================
Epoch 83 | Batch 10/29 | Loss: 3.3444 | Acc@1: 0.4102 | Acc@5: 0.6914 | Acc@10: 0.7148
Epoch 83 | Batch 20/29 | Loss: 3.6137 | Acc@1: 0.3633 | Acc@5: 0.6523 | Acc@10: 0.6914

Validation Results:
  Loss: 4.2828
  Acc@1: 0.3350 (33.50%)
  Acc@5: 0.5996 (59.96%)
  Acc@10: 0.6236 (62.36%)


Test Results:
  Loss: 4.7221
  Acc@1: 0.3114 (31.14%)
  Acc@5: 0.5271 (52.71%)
  Acc@10: 0.5573 (55.73%)

Epoch 83 Summary:
  Train - Loss: 3.5596 | Acc@1: 0.3617
  Val   - Loss: 4.2828 | Acc@1: 0.3350
  Test  - Loss: 4.7221 | Acc@1: 0.3114
  Time: 4.36s | LR: 0.000012
  ✅ New best test accuracy! Saved to checkpoints/location_hrm_opt_best_test.pt

============================================================
Epoch 84/150
============================================================
Epoch 84 | Batch 10/29 | Loss: 3.2354 | Acc@1: 0.3672 | Acc@5: 0.7148 | Acc@10: 0.7578
Epoch 84 | Batch 20/29 | Loss: 3.7516 | Acc@1: 0.3398 | Acc@5: 0.6367 | Acc@10: 0.6719

Validation Results:
  Loss: 4.2828
  Acc@1: 0.3370 (33.70%)
  Acc@5: 0.5999 (59.99%)
  Acc@10: 0.6236 (62.36%)


Test Results:
  Loss: 4.7206
  Acc@1: 0.3037 (30.37%)
  Acc@5: 0.5277 (52.77%)
  Acc@10: 0.5579 (55.79%)

Epoch 84 Summary:
  Train - Loss: 3.5527 | Acc@1: 0.3627
  Val   - Loss: 4.2828 | Acc@1: 0.3370
  Test  - Loss: 4.7206 | Acc@1: 0.3037
  Time: 4.35s | LR: 0.000012

============================================================
Epoch 85/150
============================================================
Epoch 85 | Batch 10/29 | Loss: 3.6595 | Acc@1: 0.3359 | Acc@5: 0.6484 | Acc@10: 0.6914
Epoch 85 | Batch 20/29 | Loss: 3.5139 | Acc@1: 0.3594 | Acc@5: 0.6680 | Acc@10: 0.6953

Validation Results:
  Loss: 4.2771
  Acc@1: 0.3378 (33.78%)
  Acc@5: 0.5991 (59.91%)
  Acc@10: 0.6264 (62.64%)


Test Results:
  Loss: 4.7179
  Acc@1: 0.2969 (29.69%)
  Acc@5: 0.5284 (52.84%)
  Acc@10: 0.5582 (55.82%)

Epoch 85 Summary:
  Train - Loss: 3.5343 | Acc@1: 0.3623
  Val   - Loss: 4.2771 | Acc@1: 0.3378
  Test  - Loss: 4.7179 | Acc@1: 0.2969
  Time: 4.34s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch85.pt

============================================================
Epoch 86/150
============================================================
Epoch 86 | Batch 10/29 | Loss: 2.9908 | Acc@1: 0.4219 | Acc@5: 0.7500 | Acc@10: 0.7734
Epoch 86 | Batch 20/29 | Loss: 3.4771 | Acc@1: 0.3984 | Acc@5: 0.6641 | Acc@10: 0.7188

Validation Results:
  Loss: 4.2740
  Acc@1: 0.3372 (33.72%)
  Acc@5: 0.6004 (60.04%)
  Acc@10: 0.6267 (62.67%)


Test Results:
  Loss: 4.7201
  Acc@1: 0.2999 (29.99%)
  Acc@5: 0.5290 (52.90%)
  Acc@10: 0.5584 (55.84%)

Epoch 86 Summary:
  Train - Loss: 3.5318 | Acc@1: 0.3644
  Val   - Loss: 4.2740 | Acc@1: 0.3372
  Test  - Loss: 4.7201 | Acc@1: 0.2999
  Time: 4.36s | LR: 0.000012

============================================================
Epoch 87/150
============================================================
Epoch 87 | Batch 10/29 | Loss: 3.3605 | Acc@1: 0.4062 | Acc@5: 0.6797 | Acc@10: 0.7305
Epoch 87 | Batch 20/29 | Loss: 3.6455 | Acc@1: 0.3555 | Acc@5: 0.6406 | Acc@10: 0.6758

Validation Results:
  Loss: 4.2716
  Acc@1: 0.3333 (33.33%)
  Acc@5: 0.5999 (59.99%)
  Acc@10: 0.6258 (62.58%)


Test Results:
  Loss: 4.7104
  Acc@1: 0.3075 (30.75%)
  Acc@5: 0.5290 (52.90%)
  Acc@10: 0.5590 (55.90%)

Epoch 87 Summary:
  Train - Loss: 3.5164 | Acc@1: 0.3668
  Val   - Loss: 4.2716 | Acc@1: 0.3333
  Test  - Loss: 4.7104 | Acc@1: 0.3075
  Time: 4.32s | LR: 0.000012

============================================================
Epoch 88/150
============================================================
Epoch 88 | Batch 10/29 | Loss: 3.6920 | Acc@1: 0.3750 | Acc@5: 0.6445 | Acc@10: 0.6797
Epoch 88 | Batch 20/29 | Loss: 3.6229 | Acc@1: 0.3281 | Acc@5: 0.6406 | Acc@10: 0.7070

Validation Results:
  Loss: 4.2710
  Acc@1: 0.3372 (33.72%)
  Acc@5: 0.5999 (59.99%)
  Acc@10: 0.6270 (62.70%)


Test Results:
  Loss: 4.7158
  Acc@1: 0.3064 (30.64%)
  Acc@5: 0.5287 (52.87%)
  Acc@10: 0.5579 (55.79%)

Epoch 88 Summary:
  Train - Loss: 3.5220 | Acc@1: 0.3618
  Val   - Loss: 4.2710 | Acc@1: 0.3372
  Test  - Loss: 4.7158 | Acc@1: 0.3064
  Time: 4.30s | LR: 0.000012

============================================================
Epoch 89/150
============================================================
Epoch 89 | Batch 10/29 | Loss: 3.3776 | Acc@1: 0.3828 | Acc@5: 0.6875 | Acc@10: 0.7305
Epoch 89 | Batch 20/29 | Loss: 3.4635 | Acc@1: 0.3555 | Acc@5: 0.6602 | Acc@10: 0.6992

Validation Results:
  Loss: 4.2648
  Acc@1: 0.3381 (33.81%)
  Acc@5: 0.6007 (60.07%)
  Acc@10: 0.6264 (62.64%)


Test Results:
  Loss: 4.7032
  Acc@1: 0.3068 (30.68%)
  Acc@5: 0.5298 (52.98%)
  Acc@10: 0.5583 (55.83%)

Epoch 89 Summary:
  Train - Loss: 3.5073 | Acc@1: 0.3610
  Val   - Loss: 4.2648 | Acc@1: 0.3381
  Test  - Loss: 4.7032 | Acc@1: 0.3068
  Time: 4.49s | LR: 0.000012

============================================================
Epoch 90/150
============================================================
Epoch 90 | Batch 10/29 | Loss: 3.4120 | Acc@1: 0.3555 | Acc@5: 0.6914 | Acc@10: 0.7266
Epoch 90 | Batch 20/29 | Loss: 3.5415 | Acc@1: 0.3281 | Acc@5: 0.6562 | Acc@10: 0.6992

Validation Results:
  Loss: 4.2668
  Acc@1: 0.3364 (33.64%)
  Acc@5: 0.6010 (60.10%)
  Acc@10: 0.6261 (62.61%)


Test Results:
  Loss: 4.7091
  Acc@1: 0.3028 (30.28%)
  Acc@5: 0.5303 (53.03%)
  Acc@10: 0.5585 (55.85%)

Epoch 90 Summary:
  Train - Loss: 3.4937 | Acc@1: 0.3704
  Val   - Loss: 4.2668 | Acc@1: 0.3364
  Test  - Loss: 4.7091 | Acc@1: 0.3028
  Time: 4.34s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch90.pt

============================================================
Epoch 91/150
============================================================
Epoch 91 | Batch 10/29 | Loss: 3.5729 | Acc@1: 0.3359 | Acc@5: 0.6836 | Acc@10: 0.7227
Epoch 91 | Batch 20/29 | Loss: 3.5109 | Acc@1: 0.3711 | Acc@5: 0.6836 | Acc@10: 0.7148

Validation Results:
  Loss: 4.2590
  Acc@1: 0.3384 (33.84%)
  Acc@5: 0.6016 (60.16%)
  Acc@10: 0.6267 (62.67%)


Test Results:
  Loss: 4.7048
  Acc@1: 0.2997 (29.97%)
  Acc@5: 0.5312 (53.12%)
  Acc@10: 0.5604 (56.04%)

Epoch 91 Summary:
  Train - Loss: 3.4973 | Acc@1: 0.3634
  Val   - Loss: 4.2590 | Acc@1: 0.3384
  Test  - Loss: 4.7048 | Acc@1: 0.2997
  Time: 4.33s | LR: 0.000012

============================================================
Epoch 92/150
============================================================
Epoch 92 | Batch 10/29 | Loss: 3.5284 | Acc@1: 0.3906 | Acc@5: 0.6445 | Acc@10: 0.6758
Epoch 92 | Batch 20/29 | Loss: 3.5118 | Acc@1: 0.3398 | Acc@5: 0.6680 | Acc@10: 0.7109

Validation Results:
  Loss: 4.2570
  Acc@1: 0.3361 (33.61%)
  Acc@5: 0.6013 (60.13%)
  Acc@10: 0.6275 (62.75%)


Test Results:
  Loss: 4.6946
  Acc@1: 0.3100 (31.00%)
  Acc@5: 0.5331 (53.31%)
  Acc@10: 0.5610 (56.10%)

Epoch 92 Summary:
  Train - Loss: 3.4866 | Acc@1: 0.3583
  Val   - Loss: 4.2570 | Acc@1: 0.3361
  Test  - Loss: 4.6946 | Acc@1: 0.3100
  Time: 4.40s | LR: 0.000012

============================================================
Epoch 93/150
============================================================
Epoch 93 | Batch 10/29 | Loss: 3.4229 | Acc@1: 0.3984 | Acc@5: 0.6523 | Acc@10: 0.7070
Epoch 93 | Batch 20/29 | Loss: 3.1895 | Acc@1: 0.3633 | Acc@5: 0.7188 | Acc@10: 0.7656

Validation Results:
  Loss: 4.2461
  Acc@1: 0.3386 (33.86%)
  Acc@5: 0.6018 (60.18%)
  Acc@10: 0.6278 (62.78%)


Test Results:
  Loss: 4.6782
  Acc@1: 0.3081 (30.81%)
  Acc@5: 0.5337 (53.37%)
  Acc@10: 0.5624 (56.24%)

Epoch 93 Summary:
  Train - Loss: 3.4790 | Acc@1: 0.3640
  Val   - Loss: 4.2461 | Acc@1: 0.3386
  Test  - Loss: 4.6782 | Acc@1: 0.3081
  Time: 4.38s | LR: 0.000012

============================================================
Epoch 94/150
============================================================
Epoch 94 | Batch 10/29 | Loss: 3.6217 | Acc@1: 0.3164 | Acc@5: 0.6484 | Acc@10: 0.6875
Epoch 94 | Batch 20/29 | Loss: 3.4476 | Acc@1: 0.3828 | Acc@5: 0.6875 | Acc@10: 0.7031

Validation Results:
  Loss: 4.2528
  Acc@1: 0.3336 (33.36%)
  Acc@5: 0.6027 (60.27%)
  Acc@10: 0.6275 (62.75%)


Test Results:
  Loss: 4.6883
  Acc@1: 0.3064 (30.64%)
  Acc@5: 0.5356 (53.56%)
  Acc@10: 0.5607 (56.07%)

Epoch 94 Summary:
  Train - Loss: 3.4688 | Acc@1: 0.3691
  Val   - Loss: 4.2528 | Acc@1: 0.3336
  Test  - Loss: 4.6883 | Acc@1: 0.3064
  Time: 4.37s | LR: 0.000012

============================================================
Epoch 95/150
============================================================
Epoch 95 | Batch 10/29 | Loss: 3.4850 | Acc@1: 0.3750 | Acc@5: 0.6680 | Acc@10: 0.7031
Epoch 95 | Batch 20/29 | Loss: 3.5414 | Acc@1: 0.3633 | Acc@5: 0.6602 | Acc@10: 0.7070

Validation Results:
  Loss: 4.2518
  Acc@1: 0.3367 (33.67%)
  Acc@5: 0.6052 (60.52%)
  Acc@10: 0.6278 (62.78%)


Test Results:
  Loss: 4.6845
  Acc@1: 0.3100 (31.00%)
  Acc@5: 0.5358 (53.58%)
  Acc@10: 0.5604 (56.04%)

Epoch 95 Summary:
  Train - Loss: 3.4671 | Acc@1: 0.3592
  Val   - Loss: 4.2518 | Acc@1: 0.3367
  Test  - Loss: 4.6845 | Acc@1: 0.3100
  Time: 4.48s | LR: 0.000012
  Saved checkpoint: checkpoints/location_hrm_opt_epoch95.pt

============================================================
Epoch 96/150
============================================================
Epoch 96 | Batch 10/29 | Loss: 3.7349 | Acc@1: 0.3320 | Acc@5: 0.6094 | Acc@10: 0.6680
Epoch 96 | Batch 20/29 | Loss: 3.3082 | Acc@1: 0.3906 | Acc@5: 0.7031 | Acc@10: 0.7383

Validation Results:
  Loss: 4.2480
  Acc@1: 0.3384 (33.84%)
  Acc@5: 0.6052 (60.52%)
  Acc@10: 0.6278 (62.78%)


Test Results:
  Loss: 4.6839
  Acc@1: 0.2982 (29.82%)
  Acc@5: 0.5361 (53.61%)
  Acc@10: 0.5613 (56.13%)

Epoch 96 Summary:
  Train - Loss: 3.4538 | Acc@1: 0.3644
  Val   - Loss: 4.2480 | Acc@1: 0.3384
  Test  - Loss: 4.6839 | Acc@1: 0.2982
  Time: 4.44s | LR: 0.000012

============================================================
Epoch 97/150
============================================================
Epoch 97 | Batch 10/29 | Loss: 3.3898 | Acc@1: 0.3594 | Acc@5: 0.6875 | Acc@10: 0.7109
Epoch 97 | Batch 20/29 | Loss: 3.4558 | Acc@1: 0.3945 | Acc@5: 0.6680 | Acc@10: 0.7070

Validation Results:
  Loss: 4.2446
  Acc@1: 0.3381 (33.81%)
  Acc@5: 0.6063 (60.63%)
  Acc@10: 0.6281 (62.81%)


Test Results:
  Loss: 4.6765
  Acc@1: 0.3106 (31.06%)
  Acc@5: 0.5365 (53.65%)
  Acc@10: 0.5604 (56.04%)

Epoch 97 Summary:
  Train - Loss: 3.4413 | Acc@1: 0.3684
  Val   - Loss: 4.2446 | Acc@1: 0.3381
  Test  - Loss: 4.6765 | Acc@1: 0.3106
  Time: 4.36s | LR: 0.000012

============================================================
Epoch 98/150
============================================================
Epoch 98 | Batch 10/29 | Loss: 3.5444 | Acc@1: 0.3516 | Acc@5: 0.6562 | Acc@10: 0.7031
Epoch 98 | Batch 20/29 | Loss: 3.3014 | Acc@1: 0.3828 | Acc@5: 0.7031 | Acc@10: 0.7500

Validation Results:
  Loss: 4.2435
  Acc@1: 0.3381 (33.81%)
  Acc@5: 0.6055 (60.55%)
  Acc@10: 0.6281 (62.81%)


Test Results:
  Loss: 4.6766
  Acc@1: 0.3069 (30.69%)
  Acc@5: 0.5361 (53.61%)
  Acc@10: 0.5624 (56.24%)

Epoch 98 Summary:
  Train - Loss: 3.4456 | Acc@1: 0.3660
  Val   - Loss: 4.2435 | Acc@1: 0.3381
  Test  - Loss: 4.6766 | Acc@1: 0.3069
  Time: 4.48s | LR: 0.000012

============================================================
Early stopping: No improvement for 20 epochs
============================================================


============================================================
Training completed!
============================================================
Best validation Acc@1: 0.3395 (33.95%)
Best test Acc@1: 0.3114 (31.14%)
